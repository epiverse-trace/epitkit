<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epitkit/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/epitkit/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/epitkit/favicon-16x16.png">
<link rel="manifest" href="favicons/epitkit/site.webmanifest">
<link rel="mask-icon" href="favicons/epitkit/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav epitkit"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epitkit-logo" alt="epitkit" src="assets/images/epitkit-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epitkit" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epitkit" src="assets/images/epitkit-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress epitkit">
    <div class="progress-bar epitkit" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="Statistics.html">1. Statistics and Probability Unit</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="Deterministic_model.html">2. Building a simple deterministic model</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Error_bank.html">3. Bank of frequently asked questions and errors</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-Statistics"><p>Content from <a href="Statistics.html">Statistics and Probability Unit</a></p>
<hr>
<p>Last updated on 2025-06-19 |

        <a href="https://github.com/joskerus/EpiTKit-EN/edit/main/episodes/Statistics.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can statistics and probability be used to solve questions in
infectious disease epidemiology?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p><strong>At the end of this workshop you will be able to:</strong></p>
<ul>
<li><p>Understand the role of statistics in the study of infectious
diseases.</p></li>
<li><p>Understand and use statistical measures to summarize and analyze
information.</p></li>
<li><p>Become familiar with the concept of a random variable and
recognize common probability distributions.</p></li>
<li><p>Learn how to approach a statistical problem as an inference
problem from a sample.</p></li>
<li><p>Understand the concept of confidence intervals for estimating
epidemiological parameters.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<p>This unit is a supplement to the <strong><em>Introduction to
Infectious Disease Modelling for Public Health Course</em></strong></p>
</div>
</div>
</div>
<div id="table-of-contents" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="table-of-contents" class="callout-inner">
<h3 class="callout-title"><strong>Table of contents</strong></h3>
<div class="callout-content">
<table style="width:88%;" class="table">
<colgroup><col width="87%"></colgroup>
<tbody><tr class="odd">
<td>
<p>Topic 1: Introduction to Statistical Thinking (See in course
platform)</p>
<p>Topic 2: Descriptive Statistics (See complement on the course
platform)</p>
<p>Topic 3: Probability (See course platform add-on)</p>
<p>Topic 4: Principal Probability Distributions (See supplement on the
course platform)</p>
<p>Topic 5: Introduction to Statistical Inference (See complement on the
course platform)</p>
</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<section><h2 class="section-heading" id="before-you-start">Before you start<a class="anchor" aria-label="anchor" href="#before-you-start"></a>
</h2>
<hr class="half-width">
<p>Please check that you have installed the following libraries
<code>tidyverse, pak, epiparameter e infer</code> in case they are not
installed, run the code below according to your need:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To install the tidyverse package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To install the epiparameter package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"epiparameter"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"epiparameter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To install the epitools package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="va">epitools</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"epitools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To install the infer package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"infer"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"infer"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># To install the cfr package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"cfr"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"cfr"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Before start and eveytime that you start a session in R charge this libraries </span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epitools</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">infer</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'infer'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:epiparameter':

    generate</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span></span></code></pre>
</div>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-2-descriptive-statistics">
<strong>Topic 2: Descriptive Statistics</strong><a class="anchor" aria-label="anchor" href="#topic-2-descriptive-statistics"></a>
</h2>
<hr class="half-width">
<p><strong>Exercise: Visualising and Analysing Data in R</strong></p>
<p>There are many graphs according to the type of scale of the variable
you want to analyse. Here are some examples to help you understand these
concepts.</p>
<ul>
<li><p>Please take into account that you have previously completed the
introductory unit on R and the data visualisation unit. The data table
for this exercise can be found in: <a href="https://raw.githubusercontent.com/epiverse-trace/translation-epitkit/refs/heads/main/data/sample_data.RDS" class="external-link uri">https://raw.githubusercontent.com/epiverse-trace/translation-epitkit/refs/heads/main/data/sample_data.RDS</a></p></li>
<li><p>Once you have the data downloaded to your computer and in the
data folder of your project you can execute the following
command:</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu">readRDS</span><span class="op">(</span><span class="st">"data/sample_data.RDS"</span><span class="op">)</span></span></code></pre>
</div>
<p><strong>Histogram and Boxplot</strong></p>
<p>The two most common types of graphs for visualising the distribution
of quantitative variables are histograms and boxplots.</p>
<p>The <strong>histograms</strong> allow you to visually describe the
distribution of data by grouping the data into intervals on the x-axis,
which are generally of equal size, and then for each interval describe
the absolute frequency, relative frequency or density on the y-axis. A
density histogram adjusts the relative frequency of each interval
according to the width of the interval. In R it can be constructed as
follows:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histogram with absolute frequency</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sample_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>color<span class="op">=</span><span class="st">"darkblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Absolute Frequency"</span>, x <span class="op">=</span> <span class="st">"Age in years"</span>,</span>
<span>     title <span class="op">=</span> <span class="st">"Age Distribution"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histogram with density</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sample_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 color <span class="op">=</span> <span class="st">"darkblue"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Density"</span>, x <span class="op">=</span> <span class="st">"Age in years"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Age Distribution"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <strong>Boxplot</strong> are constructed by displaying the
following statistics horizontally or vertically:</p>
<ul>
<li><p>First quartile Q1 (25th percentile): Value below the 25th
percentile of the data. “First Line”.</p></li>
<li><p>Second quartile Q2 (50th percentile or median): Value that leaves
by below 50% of the data. “middle line”.</p></li>
<li>
<p>Third quartile Q3 (50th percentile or median): Value that leaves
by below 75% of the data. “Third Line”.</p>
<figure><img src="fig/boxplot.png" class="figure mx-auto d-block"></figure>
</li>
</ul>
<p>Additionally, these graphs are useful for detecting outliers by
setting a lower bound (Q1-1.5×RIQ) and an upper bound (Q3+1.5×RIQ) based
on RIQ=Q3-Q1. Data outside these limits are categorised as unusual and
should be reviewed. In the presence of outliers, the lines or whiskers
go to the lower or upper bounds, otherwise they go to the minimum and
maximum value, respectively.</p>
<p>Another usefulness of the <strong>boxplot</strong> and
<strong>histograms</strong> is that they help to know the shape of the
distribution in order to decide on the best indicator of central
tendency. In this way, a distribution can be symmetric or asymmetric
positive/negative. When symmetry exists, it is recommended to use the
mean accompanied by the standard deviation and otherwise the median and
the interquartile range because the mean can be influenced by the
extreme data of the distribution. Remember that an indicator of central
tendency must always be accompanied by a judge, i.e. its respective
indicator of variability.</p>
<figure><img src="fig/distribucion.png" class="figure mx-auto d-block"></figure><ul>
<li><p><strong>Explanatory legend A:</strong> In a symmetric
distribution, the mean, the mean, mode and median take the same value
and the data are found to be evenly distributed around the central
value. For this type of distributions, it is recommended to describe the
data series with mean and standard deviation.</p></li>
<li><p><strong>Explanatory legend B:</strong> Positive asymmetric
distribution or skewed to the right. This type of distribution is
characterised by a higher concentration of data towards the right.
minimum of the distribution, but some values are concentrated towards
the right. the maximum value of the distribution. The expected behaviour
is that the mean&gt;median&gt;moda, since the mean is influenced by the
positive extreme values of the distribution. It is recommended that to
describe the data by means of median and range. interquartile
range.</p></li>
<li><p><strong>Explanatory legend C:</strong> Negative skewed
distribution or skewed to the left. This type of distribution is
characterised by a higher concentration of data towards the left.
maximum of the distribution, but some values are concentrated towards
the minimum value of the distribution (values towards the left). The
expected behaviour is that the mode&gt;mean&gt;median&gt;median given
that this latter is influenced by the extreme values of the side
left-hand side. It is recommended to describe the data by median and
interquartile range.</p></li>
</ul>
<p>Next, we will visualise the age of the COVID-19 cases using a
boxplot.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Boxplot</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sample_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="st">" "</span>, y <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Age (in years)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">" "</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>According to the boxplot of the age of the sample of COVID-19 cases
it is possible to conclude that the distribution of the data is
positively skewed, since there is a greater closeness between the values
of Q1 and the median, so it is advisable to describe the behaviour of
the data by means of the median and interquartile range, this in R can
be found as follows using the functions highlighted in blue:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Descriptive Statistics Quantitative Variables   </span></span>
<span></span>
<span><span class="va">sample_data</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">summarise</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu">n</span> <span class="op">(</span><span class="op">)</span>, <span class="co"># Number of observations</span></span>
<span>  Mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="co"># Mean</span></span>
<span>  SD <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="co"># Standard deviation</span></span>
<span>  median <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># median-50th percentile</span></span>
<span>  P25 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="co"># 25th percentile</span></span>
<span>  P75 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> <span class="co"># 75th percentile</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       n     Mean       SD median P25 P75
1 100000 41.99912 19.51872     39  28  55</code></pre>
</div>
<p>Finally, for the variable age it can be concluded that half of the
patients with covid-19 are aged between 27 and 52 years (“RIQ”) with a
median of 38 years, indicating that half of the cases have an age below
this value. It is important to note that, due to the skewness of the
distribution, the mean and median do not coincide, which is expected in
skewed distributions.</p>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<p><strong>Bar Graphs and Frequency Tables</strong></p>
<p>Qualitative variables are recommended to be represented by bar
charts. Generally, these are constructed by indicating on the X axis the
categories of the variables and on the Y axis the value of the absolute,
relative or percentage frequencies according to the needs, i.e. it is
always necessary to first evaluate the frequency table of the variable.
Let us suppose that we want to know the type of infection of COVID-19.
This can be done in R using the following command:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Frequency Tables</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op">%&gt;%</span> <span class="co"># Frequency Table Created</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">type_of_contagion</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Frequency count for the state variable</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">prop.table</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="co"># Proportion</span></span>
<span>                perc <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">prop.table</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Percentage</span></span>
<span></span>
<span><span class="va">table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  type_of_contagion     n    prop   perc
1         Community 69985 0.69985 69.985
2          Imported    63 0.00063  0.063
3           Unknown 29952 0.29952 29.952</code></pre>
</div>
<p>With this information it can be concluded that 70% of the covid-19
cases were from the community and only 0.06% were imported from
elsewhere. This can be visualised by means of a bar chart:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bar Graphs</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">table</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">type_of_contagion</span>, y <span class="op">=</span> <span class="va">perc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, color<span class="op">=</span><span class="st">"darkblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"%"</span>, x <span class="op">=</span> <span class="st">" "</span>, title <span class="op">=</span> <span class="st">"Type of Contagion"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-3-probability">
<strong>Topic 3: Probability</strong><a class="anchor" aria-label="anchor" href="#topic-3-probability"></a>
</h2>
<hr class="half-width">
<p>In a study published in the NEJM in 2014 entitled “Ebola Virus
Disease in West Africa- The First 9 Months of the Epidemic and Forward
Projections” (<a href="https://www.nejm.org/doi/full/10.1056/NEJMoa1411100" class="external-link"><strong>DOI:
10.1056/NEJMoa1411100</strong></a>), described the clinical and
epidemiological characteristics of Ebola cases reported during the
epidemic that affected the countries of Guinea, Liberia, Nigeria and
Sierra Leone since December 2013. The study found that those over 44
years of age were more likely to die from the disease. Similar to the
referenced article, a comparable conclusion is reached if we perform an
equivalent calculation using measures of association seen in the General
Epidemiology Unit applied to infectious diseases, such as Relative Risks
(RR) of the Risk Ratio or Relative Risk (RR). For this, a 2x2 table can
be reconstructed, where the RR can be measured by the ratio between the
CFR of a group A (e.g., cases aged 45 years or older) and a group B
(e.g., cases aged 44 years or younger), where the CFR is the case
fatality risk (CFR).</p>
<p>Thus, we obtain that the risk of death in cases aged 45 years or
older is 1.20 times the risk of death in cases aged 44 years or younger,
with a 95% confidence interval of 1.13 to 1.27, and a p-value of less
than 0.01. To reproduce this calculation you can use
the<strong>epitools</strong> library as shown below.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the epitools package</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epitools</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Create a 2x2 contingency table with the given values</span></span>
<span><span class="va">table2x2</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">311</span>, <span class="fl">51</span>, <span class="fl">768</span>, <span class="fl">299</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Calculate the risk ratio using the contingency table</span></span>
<span><span class="fu">epitools</span><span class="fu">::</span><span class="fu">riskratio</span><span class="op">(</span><span class="va">table2x2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$data
          Outcome
Predictor  Disease1 Disease2 Total
  Exposed1      311      768  1079
  Exposed2       51      299   350
  Total         362     1067  1429

$measure
          risk ratio with 95% C.I.
Predictor  estimate    lower    upper
  Exposed1 1.000000       NA       NA
  Exposed2 1.200227 1.133086 1.271346

$p.value
          two-sided
Predictor    midp.exact fisher.exact   chi.square
  Exposed1           NA           NA           NA
  Exposed2 3.179312e-08 4.200177e-08 9.982161e-08

$correction
[1] FALSE

attr(,"method")
[1] "Unconditional MLE &amp; normal approximation (Wald) CI"</code></pre>
</div>
<p>An introduction to statistical inference and confidence intervals can
be found in Topic 5 of this Unit.</p>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-4-principal-probability-distributions">
<strong>Topic 4: Principal probability distributions</strong><a class="anchor" aria-label="anchor" href="#topic-4-principal-probability-distributions"></a>
</h2>
<hr class="half-width">
<p>As described in Topic 3, probability studies the behaviour of random
phenomena “events”. In this process, the following are observed
<strong>random variables (v.a),</strong> usually denoted as
<strong>X</strong> which aim to assign a real number to each event that
can happen in the sample space.</p>
<p>For the explanation and examples of the main distributions, it is
important that you install and load the packages
<strong>epiparameter</strong> packages from Epiverse.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If you haven't loaded it yet, load the epiparameter library</span></span>
<span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span></code></pre>
</div>
<p><strong>Discrete Models</strong></p>
<p>The binomial distribution allows describing the probability of
occurrence of an event with two possible outcomes, success (p) or
failure (1-p), in a given number of independent trials n with constant
probability of success p. The random variable under study corresponds
to:</p>
<p>X: Number of successes in n trials</p>
<p>The binomial model can be useful to know the probability of observing
a given number of events (e.g. cases, deaths, re-infections) in a
population of size n under the assumption that the probability of the
event is constant. The binomial distribution depends on two parameters:
the probability of success p and the number of independent trials n.</p>
<p>If X has a binomial distribution then it is represented as follows:
X~Bin(n,p)</p>
<p>And its density function, mean, expectation and variance correspond
to:</p>
<p><span class="math inline">\(f(x)=P(X=x)=(n x )\)</span></p>
<p><span class="math inline">\(p^x (1-p)^{(n-x)}\)</span></p>
<p><span class="math inline">\(E(x)=np\)</span></p>
<p><span class="math inline">\(Var(x)=np(1-p)\)</span></p>
<p>Example: If a virus with an attack rate of 60% is introduced into a
community of 20 individuals, what is the probability that 10 or fewer
individuals are infected in this community?</p>
<p>Be <span class="math inline">\(X~Bin(n=20,p=0.60)\)</span> then the
following expression needs to be calculated:</p>
<p><span class="math inline">\(P(X≤10)=∑_(x=0)^10 (20 x ) 〖0.60〗^x
(1-0.60)^(20-x)\)</span></p>
<p>In R this can be calculated as follows:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the probability of success</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.60</span>  </span>
<span></span>
<span><span class="co"># Define the number of trials</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span>  </span>
<span></span>
<span><span class="co"># Define the number of successes we are analyzing</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span>  </span>
<span></span>
<span><span class="co"># Compute the cumulative probability of getting at most 'x' successes</span></span>
<span><span class="fu">pbinom</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">p</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.2446628</code></pre>
</div>
<p>Therefore, the probability of a maximum of 10 individuals becoming
infected is 24.5%.</p>
<p>On <a href="https://ben18785.shinyapps.io/distribution-zoo/" class="external-link">distribution-zoo</a>
you can view the complete distribution of the variable</p>
<p><span class="math inline">\(X~Bin(n=20,p=0.60)\)</span>. Thus, it can
be concluded that on average one would expect to find 12 infected in a
community of 20 individuals based on an attack rate of 60%.</p>
<figure><img src="fig/distribution-zoo.png" class="figure mx-auto d-block"></figure><p><strong>Poisson distribution</strong></p>
<p>The distribution of <em>Poisson distribution</em> distribution models
the behaviour of random variables describing the number of events,
“counts”, occurring in a fixed observation interval, e.g. time (number
of infections occurring in an hour, day, week, year, etc.), or area
(number of infections occurring in a municipality, hospital, etc.).</p>
<p>This distribution has a parameter called lambda (<span class="math inline">\(λ\)</span>), <span class="math inline">\(λ&gt;0\)</span> which describes the average number
of events occurring in the fixed observation interval. If <span class="math inline">\(X\)</span> has a Poisson distribution, then it is
represented as follows:</p>
<p><span class="math inline">\(X\)</span>~<span class="math inline">\(Poisson(λ)\)</span></p>
<p>Its density, expectation, mean and variance function corresponds
to:</p>
<p><span class="math inline">\(fx=P(X=x)=\frac{e^{-λ}λ^x}{x!},
x=0,1,2,..,\)</span></p>
<p><span class="math inline">\(E(x)=λ Var(x)=λ\)</span></p>
<p>In infectious diseases, the Poisson distribution can be used to model
the number of secondary cases generated by a primary case. In this
context, the parameter is a function of the effective number of
replication <strong>R</strong> which represents the average number of
secondary infections caused by each primary case over time in a
population composed of susceptible and non-susceptible individuals.</p>
<p>:::: challenge <span class="math display">\[**Example**\]</span>{.underline}</p>
<p>Suppose one wishes to study the propagation of an outbreak based on a
Poisson model as days (t) elapse. The random variable of interest
is:</p>
<p><span class="math inline">\(X_{(t )}\)</span> Number of secondary
cases caused by each primary case on day t</p>
<p>This is a Poisson model since there is a fixed observation interval
“each primary case” and one wishes to study the number of observed
secondary cases “events”. Thus, the following model could be
constructed:</p>
<p><span class="math inline">\(X_{(t )}∼Poisson (λ= R
X_{(t-1)})\)</span></p>
<p>The above expresses that the average number of secondary cases on day
t depends on the number of reproduction <span class="math inline">\(R\)</span> and the number of observed cases <span class="math inline">\(X\)</span> on the previous day <span class="math inline">\((t-1)\)</span>. However, R is difficult to know in
real life and it may be of interest to approximate its value based on
data observed during the outbreak in order to generate control
strategies.</p>
<p>Let us assume that on day 1 of the outbreak <span class="math inline">\((t=1)\)</span> a total of 5 new cases occurred on
day 1 of the outbreak and that on the following day <span class="math inline">\((t=2)\)</span> 10 new cases occurred on the
following day. With the above information we are interested in studying
the number of secondary cases on day 2, which is equivalent to:</p>
<p><span class="math inline">\(X_{(2 )}\)</span> Number of secondary
cases caused by each primary case on Day 2</p>
<p>Which has the following distribution:</p>
<p><span class="math inline">\(X_{(2 )}∼Poisson (λ= R *5)\)</span></p>
<p>From this, we could estimate the value of <span class="math inline">\(R\)</span> by finding out which value maximises
the probability of observing this specific number of secondary cases on
day 2, i.e:</p>
<p><span class="math inline">\(P(X_{(2 )}=10)=\frac{e^{-(R *5)} (R
*5)^{10}}{10!}\)</span></p>
<p><strong>In R we could find this out by varying different values of
the number of reproduction number (R) as follows:</strong></p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Poisson probability calculation function</span></span>
<span><span class="va">poisson_probability</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">r</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">dpois</span><span class="op">(</span><span class="va">x2</span>, <span class="va">r</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># Input values</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">reproduction_numbers</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Calculate probabilities</span></span>
<span><span class="va">poisson_results</span> <span class="op">&lt;-</span> <span class="fu">poisson_probability</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">reproduction_numbers</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create dataframe for ggplot</span></span>
<span><span class="va">results_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">reproduction_numbers</span>, <span class="va">poisson_results</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Find the most probable reproduction number</span></span>
<span><span class="va">most_probable_number</span> <span class="op">&lt;-</span> <span class="va">results_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">poisson_results</span> <span class="op">==</span> <span class="fu">max</span><span class="op">(</span><span class="va">poisson_results</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">reproduction_numbers</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create the plot with ggplot2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">results_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">reproduction_numbers</span>, y <span class="op">=</span> <span class="va">poisson_results</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">most_probable_number</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability"</span>, x <span class="op">=</span> <span class="st">"Reproduction Number (R)"</span>, title <span class="op">=</span> <span class="st">"Poisson Model"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Therefore, if the number of secondary cases behaves according to a
Poisson distribution, there is a high probability that the number of new
cases observed on day 2 were generated with a reproduction number of
R=2. This implies that the average number of secondary cases per primary
case is 2. However, this simple model assumes that the number of
secondary cases generated by each primary case have equal mean and
variance, implying that all primary cases generate on average a similar
number of secondary cases. This assumption may be difficult to make for
some infectious diseases especially when they follow a pattern of
overdispersion (20% of cases cause 80% of transmission) so the Poisson
model has limitations in its application. :::</p>
<p><strong>Negative Binomial Distribution</strong></p>
<p>Like the Poisson distribution, the negative binomial distribution
allows one to model the number of events that occur “counts”. If <span class="math inline">\(X\)</span> has a Negative Binomial distribution,
then it is represented as follows.</p>
<p>$X <span class="math inline">\(~\)</span> BN(μ,k)$</p>
<p>where, <span class="math inline">\(μ\)</span> represents the mean of
the distribution and <span class="math inline">\(k\)</span> is the
dispersion parameter that allows the mean and variance of the events not
to be equal. This parameter <span class="math inline">\(k\)</span>
allows the degree of dispersion in how events are generated to be
introduced to the model. Thus, <span class="math inline">\(k\)</span>
inversely measures the degree of variation of the events that occur
given that the mean and variance of the distribution correspond to:</p>
<p><span class="math inline">\(E(x)=μ\)</span></p>
<p><span class="math inline">\(Var(x)=μ(1+\frac{μ}{k})\)</span></p>
<p>With density function:</p>
<p><span class="math inline">\(f(x)=\frac{Γ(x+k)}{Γ(k)Γ(x+1)}
(\frac{μ}{μ+k})^x (\frac{k}{μ+k})^k,x=0,1,2...\)</span></p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><span class="math display">\[**Example**\]</span>{.underline}</p>
<p>In the study of infectious diseases, the negative binomial
distribution plays a relevant role since it allows modelling the
distribution of the number of secondary cases generated by a primary
case, i.e. it allows knowing the distribution of the basic reproduction
number R_0. In this context, the mean of the distribution corresponds to
<span class="math inline">\(R_0\)</span>(Number of secondary cases in a
fully susceptible population) and the parameter <span class="math inline">\(k\)</span> controls for the variation among
primary cases. Thus, small values of k suggest that secondary cases are
generated by a small group of primary cases, while large values suggest
that the spread of the virus is high. Thus, being <span class="math inline">\(X\)</span> the number of secondary cases, then</p>
<p><span class="math inline">\(X \sim Bn(R_0,k)\)</span></p>
<p><span class="math inline">\(E(x)=R_0\)</span></p>
<p><span class="math inline">\(Var(x)=R_0 (\frac{1+R_0}{k})\)</span></p>
<p>The paper by Lloyd-Smith et al. shows how the negative binomial
distribution allows modelling the distribution of secondary cases of
various pathogens. Based on the cases reported during the SARS outbreak
in Singapore in 2023, they estimated the parameters of the negative
binomial distribution and found a <span class="math inline">\(R_0=1.630\)</span> y <span class="math inline">\(k=0.160\)</span>. These estimates are available in
the <code>epiparameter</code> which is a package available at
<code>R</code> which compiles the main estimates for several
epidemiological parameters of interest in the study of infectious
diseases.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for SARS</span></span>
<span><span class="va">SARS_R</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>    disease <span class="op">=</span> <span class="st">"SARS"</span>,  <span class="co"># Specify the disease as SARS</span></span>
<span>    epi_name <span class="op">=</span> <span class="st">"offspring distribution"</span>,  <span class="co"># Select the epidemiological parameter: offspring distribution</span></span>
<span>    single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Lloyd-Smith J, Schreiber S, Kopp P, Getz W (2005). "Superspreading and
the effect of individual variation on disease emergence." _Nature_.
doi:10.1038/nature04153 &lt;https://doi.org/10.1038/nature04153&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved data</span></span>
<span><span class="va">SARS_R</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: SARS
Pathogen: SARS-Cov-1
Epi Parameter: offspring distribution
Study: Lloyd-Smith J, Schreiber S, Kopp P, Getz W (2005). "Superspreading and
the effect of individual variation on disease emergence." _Nature_.
doi:10.1038/nature04153 &lt;https://doi.org/10.1038/nature04153&gt;.
Distribution: nbinom (No units)
Parameters:
  mean: 1.630
  dispersion: 0.160</code></pre>
</div>
<p>With these results it would be possible to plot the distribution of
the number of secondary SARS cases in order to suggest control measures.
This is also available in the <code>epiparameter</code> with the
function <code>plot</code>.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved epidemiological parameter for SARS</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">SARS_R</span><span class="op">)</span>  </span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Finally, it is possible to conclude that most cases infected with
SARS do not spread the disease since the mode of the distribution is
<span class="math inline">\(0\)</span>. This result is expected given
that <span class="math inline">\(k&lt;1\)</span> indicating that the
secondary cases are generated by a small group of infected people and
that the estimated value of <span class="math inline">\(R_0\)</span>
varies for the cases.</p>
</div>
</div>
</div>
<p><strong>Geometric distribution</strong></p>
<p>Another discrete distribution of interest that can be used to model
counts or number of events is the geometric distribution. In infectious
diseases its main use arises when the dispersion parameter of the
negative distribution is equal to 1. This distribution depends on the
probability of occurrence of the event of interest and is represented as
follows.</p>
<p><span class="math inline">\(X \sim Geom(p)\)</span></p>
<p>where p represents the probability of success or the probability of
occurrence of the event of interest with mean equal to:</p>
<p><span class="math inline">\(E(x)=\frac{1}{p}\)</span></p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>If in the case of the SARS outbreak in Singapore in the year 2023,
the estimated value of <span class="math inline">\(k\)</span> would have
been <span class="math inline">\(1\)</span> then the distribution of
secondary cases could be modelled with a geometric distribution such
that its mean is equal to the <span class="math inline">\(R_0\)</span>
estimate, i.e. it must be satisfied that:</p>
<p><span class="math inline">\(E(x)=\frac{1}{p}=1.630\)</span> and
therefore, <span class="math inline">\(p=\frac{1}{1.630}\)</span></p>
<p>So the distribution of the number of secondary contacts could be
written as:</p>
<p><span class="math inline">\(X \sim Geom(p=0.613)\)</span></p>
<p>In R we could simulate the behaviour of the number of secondary cases
with the following code:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geometric Distribution</span></span>
<span></span>
<span><span class="co"># Create a sequence of values from 0 to 20 representing different R values</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Define the probability parameter for the geometric distribution</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">1.630</span>  </span>
<span></span>
<span><span class="co"># Create a data frame with the values of x and their corresponding geometric probabilities</span></span>
<span><span class="va">data_geom</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">x</span>, probg <span class="op">=</span> <span class="fu">dgeom</span><span class="op">(</span><span class="va">x</span>, <span class="va">prob</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Plot the geometric distribution using ggplot2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_geom</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">probg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Use a bar plot to visualize the probability distribution</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability"</span>, x <span class="op">=</span> <span class="st">"Secondary cases"</span>, title <span class="op">=</span> <span class="st">"Geometric Distribution"</span><span class="op">)</span>  <span class="co"># Add labels and title</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Under the geometric distribution, then there is a higher probability
that a primary case can transmit the virus since the probability of a
primary case generating 1,2, or more secondary cases is higher with this
model than estimated with the negative binomial model.</p>
</div>
</div>
</div>
<p><strong>Continuous Models</strong></p>
<p><strong>Uniform Distribution</strong></p>
<p>The uniform distribution models a continuous variable that takes
values within an interval. $ [a,b] $ with equal probability. This
distribution is often used in the simulation of random numbers. If <span class="math inline">\(X\)</span> follows a uniform distribution, this
can be represented by:</p>
<p><span class="math inline">\(X ∼U(a,b)\)</span></p>
<p>Its parameters a and b, represent the minimum and maximum value that
the variable can take, respectively. Its density function is determined
by:</p>
<p><span class="math inline">\(f(x)=\frac{1}{b-a}\)</span>,with <span class="math inline">\(a&lt;x&lt;b\)</span></p>
<p>The mean and variance is determined by:</p>
<p><span class="math inline">\(E(x)=\frac{a+b}{2}\)</span> y <span class="math inline">\(V(x)=\frac{(b-a)^2}{12}\)</span></p>
<div id="discussion3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>A researcher wants to simulate the behaviour of COVID-19 and needs to
randomly generate the value that the basic reproduction number can take.
<span class="math inline">\(R_0\)</span> and then use it within his
propagation model. For this, he assumes that the <span class="math inline">\(R_0\)</span> of COVID-19 follows a uniform
distribution between 2 and 5:</p>
<p>$R0∼U [2,5] $</p>
<p>For your simulation you need to generate five possible values of
<span class="math inline">\(R_0\)</span> with equal probability, this in
<code>R</code> is solved using the following code:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generation of random numbers with a uniform distribution</span></span>
<span></span>
<span><span class="co"># Define the number of random values to generate</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>  </span>
<span></span>
<span><span class="co"># Set the lower and upper bounds of the uniform distribution</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">2</span>  </span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">5</span>  </span>
<span></span>
<span><span class="co"># Generate 'n' random numbers uniformly distributed between 'a' and 'b'</span></span>
<span><span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.565338 3.205583 2.640504 2.592324 3.410636</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Normal Distribution</strong></p>
<p>The normal distribution is undoubtedly the most important
probabilistic model in statistical theory because of its ability to
model many real-life problems and its relevant role in the field of
inference. This distribution attempts to model random variables that can
be influenced by multiple factors, whose effects when added together
make the values of the distribution tend towards the centre (mean). For
example, body temperature may follow a normal distribution because it is
influenced by multiple biological and environmental factors, which when
added together cause most individuals to lie around a central value.</p>
<p>To express mathematically that a continuous variable has a normal
distribution, we write:</p>
<p><span class="math inline">\(X ∼N(μ,σ)\)</span></p>
<p>Which will have the following probability density function associated
with it:</p>
<p>$f(x)=exp [-frac{1}{2 σ<sup>2}(x-u)</sup>2] $</p>
<p>Where <span class="math inline">\(μ\)</span> y <span class="math inline">\(σ\)</span> are the parameters of the distribution
and represent respectively the mean and the standard deviation of the
random variable, i.e. the central value and the dispersion of the data
with respect to it. These parameters correspond to the values that would
be obtained if the entire population rather than a sample of the
population could be studied.</p>
<p>When <span class="math inline">\(μ=0\)</span> y <span class="math inline">\(σ=1\)</span> is called <strong>normal distribution
standard</strong>. However, there are many normal distributions
according to the values taken by their parameters, but regardless of the
value of the parameters, the shape of the distribution is always
<strong>symmetric</strong> and can always be transformed to a standard
normal distribution by means of a standardisation procedure applying the
following formula:</p>
<p><span class="math inline">\(Z=\frac{X-μ}{σ}∼N(0,1)\)</span></p>
<div id="discussion4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Example</strong>,</p>
<p>If it is known that in a community the age of the cases that died
from COVID-19 has a normal distribution with mean 67.8 and standard
deviation 15.4 years. What is the probability that a deceased is younger
than 40 years old?</p>
<p>First, we define the variable to be studied, which has a normal
distribution.</p>
<p><span class="math inline">\(X∼N(67.8,15.4)\)</span></p>
<p><span class="math inline">\(X\)</span> Age of deceased COVID-19
cases</p>
<p>In R, we can use the function <code>pnorm()</code> function as
follows to find:</p>
<p><span class="math inline">\(P(X&lt;40)=?\)</span></p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the mean of the normal distribution</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">67.8</span></span>
<span><span class="co"># Define the standard deviation of the normal distribution</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">15.4</span></span>
<span><span class="co"># Define the value for which we want to compute the cumulative probability</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="co"># Compute the cumulative probability </span></span>
<span><span class="fu">pnorm</span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.0355221</code></pre>
</div>
<p>Therefore, the probability of a COVID-19 fatality being under the age
of 40 is 3.5%.</p>
</div>
</div>
</div>
<p><strong>Log-normal distribution</strong></p>
<p>The log-normal distribution arises when considering continuous random
variables that do not take the value of zero or negative numbers whose
distribution has an asymmetric shape and whose variation is generated by
multiple factors whose effects are not symmetric. If an a.v. follows a
lognormal distribution, its transformation by applying the logarithm
function will generate a normal variable and hence its name. In the
field of infectious diseases, the log-normal distribution is very useful
for modelling incubation periods (time from infection to onset of
symptoms).</p>
<p>If <span class="math inline">\(X ∼LogN(μ,σ)\)</span> then it holds
that <span class="math inline">\(Y=log (X) ∼N(μ,σ)\)</span> and the
density function of <span class="math inline">\(X\)</span> is given
by:</p>
<p><span class="math inline">\(f(x)=\frac{1}{
xσ\sqrt{2\pi}}e^{-\frac{1}{2}(\frac{ln(x)-u}{σ})^2}\)</span></p>
<p>Unlike the normal distribution, in the log-normal distribution the
parameter μ plays the role of a scaling parameter since it increases the
dispersion of the data by increasing its degree of amplitude and the
parameter σ controls the shape, i.e. the degree of skewness.</p>
<div id="discussion5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>In the 2009 paper by Lessler et al. the incubation periods of several
pathogens were modelled based on a lognormal distribution. The main
interest was to estimate the parameters of <span class="math inline">\((μ,σ)\)</span>. For example, in the case of SARS,
an estimate was found of <span class="math inline">\(μ=0.660\)</span>, y
<span class="math inline">\(σ=1.205\)</span> which implies that on
average an infected case develops symptoms in 0.7 days. This information
can be obtained in the epiparameter package with the following
command:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for the incubation period of SARS</span></span>
<span><span class="va">SARS_incubation</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>  disease <span class="op">=</span> <span class="st">"SARS"</span>,  <span class="co"># Specify the disease as SARS</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"incubation period"</span>,  <span class="co"># Select the epidemiological parameter: incubation period</span></span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Lessler J, Reich N, Brookmeyer R, Perl T, Nelson K, Cummings D (2009).
"Incubation periods of acute respiratory viral infections: a systematic
review." _The Lancet Infectious Diseases_.
doi:10.1016/S1473-3099(09)70069-8
&lt;https://doi.org/10.1016/S1473-3099%2809%2970069-8&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved incubation period data</span></span>
<span><span class="va">SARS_incubation</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: SARS
Pathogen: SARS-Cov-1
Epi Parameter: incubation period
Study: Lessler J, Reich N, Brookmeyer R, Perl T, Nelson K, Cummings D (2009).
"Incubation periods of acute respiratory viral infections: a systematic
review." _The Lancet Infectious Diseases_.
doi:10.1016/S1473-3099(09)70069-8
&lt;https://doi.org/10.1016/S1473-3099%2809%2970069-8&gt;.
Distribution: lnorm (days)
Parameters:
  meanlog: 1.386
  sdlog: 0.593</code></pre>
</div>
<p>The complete incubation period distribution for SARS can be plotted
by means of:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved epidemiological parameter for SARS</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">SARS_incubation</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The above is useful for answering questions such as: What is the
probability that a SARS case will develop symptoms two days after
infection?</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the complementary cumulative probability (P(X &gt; 2)) for a lognormal distribution</span></span>
<span></span>
<span><span class="fu">stats</span><span class="fu">::</span><span class="fu">plnorm</span><span class="op">(</span><span class="fl">2</span>, meanlog <span class="op">=</span> <span class="fl">0.660</span>, sdlog <span class="op">=</span> <span class="fl">1.205</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4890273</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Gamma distribution</strong></p>
<p>When we are studying Poisson random variables, we are usually
interested in studying the number of events that occur with mean <span class="math inline">\(λ\)</span> for a defined time interval. The Gamma
distribution focuses on studying the v.a <span class="math inline">\(X\)</span>: the time it takes for a given number
of events to occur. <span class="math inline">\(α^th\)</span>. For
example, if we are evaluating the number of infections per hour and we
want to study how much time can elapse until we find α infections,
graphically <span class="math inline">\(X\)</span> corresponds to:</p>
<figure><img src="fig/gamma.png" class="figure mx-auto d-block"></figure><p>The Gamma distribution is widely used in survival analysis due to its
flexibility given by its shape parameters. <span class="math inline">\(α\)</span> and scale <span class="math inline">\(θ\)</span> which determine its density function,
which has an asymmetric behaviour. Here, <span class="math inline">\(θ\)</span> represent the average waiting time
until the first event occurs, and <span class="math inline">\(α\)</span>
is the number of events expected to occur. This distribution is denoted
as follows:</p>
<p><span class="math inline">\(X ∼Gamma(α,θ)\)</span></p>
<p><span class="math inline">\(f(x)=\frac{1}{(α-1)!θ^α}e^{\frac{-x}{θ}}
x^{α-1}\)</span></p>
<p><span class="math inline">\(E(x)=αθ\)</span></p>
<p><span class="math inline">\(Var(x)=αθ^2\)</span></p>
<p>When <span class="math inline">\(θ\)</span> value increases, the
concentration of the probability shifts to the right, the same is true
when expecting a higher number of events. <span class="math inline">\(α\)</span> given that the waiting time <span class="math inline">\(X\)</span> can be longer.</p>
<p>:::: challenge <strong>Example</strong></p>
<p>One possible application of the Gamma distribution is in modelling
the serial interval of infectious diseases. The serial interval (s) is
defined as the time between the onset of symptoms of the primary case
and the onset of symptoms of the secondary case. In the study by Ghani
et al. the serial interval distribution of influenza was described as
follows <em>Influenza-A-H1N1Pdm</em> by means of the gamma distribution
and found the following parameters:</p>
<p><span class="math inline">\(s ∼Gamma( α=2.622,θ=0.957)\)</span></p>
<p>This information can also be obtained from the package
<code>epiparameter</code> with the following command:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for the serial interval of Influenza</span></span>
<span><span class="va">influenza_s</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>  disease <span class="op">=</span> <span class="st">"Influenza"</span>,  <span class="co"># Specify the disease as Influenza</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial_interval"</span>,  <span class="co"># Select the epidemiological parameter: serial interval</span></span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Ghani A, Baguelin M, Griffin J, Flasche S, van Hoek A, Cauchemez S,
Donnelly C, Robertson C, White M, Truscott J, Fraser C, Garske T, White
P, Leach S, Hall I, Jenkins H, Ferguson N, Cooper B (2009). "The Early
Transmission Dynamics of H1N1pdm Influenza in the United Kingdom."
_PLoS Currents_. doi:10.1371/currents.RRN1130
&lt;https://doi.org/10.1371/currents.RRN1130&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved serial interval data</span></span>
<span><span class="va">influenza_s</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H1N1Pdm
Epi Parameter: serial interval
Study: Ghani A, Baguelin M, Griffin J, Flasche S, van Hoek A, Cauchemez S,
Donnelly C, Robertson C, White M, Truscott J, Fraser C, Garske T, White
P, Leach S, Hall I, Jenkins H, Ferguson N, Cooper B (2009). "The Early
Transmission Dynamics of H1N1pdm Influenza in the United Kingdom."
_PLoS Currents_. doi:10.1371/currents.RRN1130
&lt;https://doi.org/10.1371/currents.RRN1130&gt;.
Distribution: gamma (days)
Parameters:
  shape: 2.622
  scale: 0.957</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved epidemiological parameter for influenza</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">influenza_s</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-23-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>With this information the mean and standard deviation of the
distribution could be found based on the application of the gamma
distribution:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the shape and scale parameters</span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">2.622</span>  </span>
<span><span class="va">scale</span> <span class="op">&lt;-</span> <span class="fl">0.957</span>  </span>
<span></span>
<span><span class="co"># Calculate the mean of the distribution</span></span>
<span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="va">shape</span> <span class="op">*</span> <span class="va">scale</span>  </span>
<span></span>
<span><span class="co"># Calculate the standard deviation of the distribution</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">shape</span> <span class="op">*</span> <span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Print the computed mean and standard deviation</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.509254 1.549631</code></pre>
</div>
<p>Therefore, the mean of the influenza serial interval is 5.51 days
with a standard deviation of 1.55 days. :::</p>
<p><strong>Weibull distribution</strong></p>
<p>Like the Gamma distribution, the Weibull distribution is useful in
the analysis of v.a.s representing waiting times until a particular
event is observed. The Weibull distribution has two parameters and its
density function is defined by:</p>
<p><span class="math inline">\(f(x)=
\frac{β}{η}(\frac{x}{η})^{β-1}{e^{-(x/η)}}^β\)</span></p>
<p>Here, <span class="math inline">\(η\)</span> is the scale parameter
and <span class="math inline">\(β\)</span> the shape parameter. The
shape parameter <span class="math inline">\(β\)</span> is also known as
slope and attempts to model the relationship between probability and
lead times. Thus when <span class="math inline">\(β&gt;1\)</span> the
rate of occurrence of events increases over time, while if <span class="math inline">\(β&lt;1\)</span> describes that the risk of the
event decreases over time. The scale parameter handles the degree of
variability of the distribution and is found in the same units of <span class="math inline">\(X\)</span>.</p>
<p>:::: challenge <strong>Example</strong></p>
<p>The study by Virlogeux et al. described the distribution of the
incubation time of influenza using the Weibull distribution and found
the following parameters:</p>
<p><span class="math inline">\(x∼Gamma( β=2.101,η=3.839)\)</span></p>
<p>This information can also be obtained in the epiparameter package
with the following command:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for the incubation period of Influenza</span></span>
<span><span class="va">influenza_incubation</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>  disease <span class="op">=</span> <span class="st">"Influenza"</span>,  <span class="co"># Specify the disease as Influenza</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"incubation period"</span>,  <span class="co"># Select the epidemiological parameter: incubation period</span></span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Virlogeux V, Li M, Tsang T, Feng L, Fang V, Jiang H, Wu P, Zheng J, Lau
E, Cao Y, Qin Y, Liao Q, Yu H, Cowling B (2015). "Estimating the
Distribution of the Incubation Periods of Human Avian Influenza A(H7N9)
Virus Infections." _American Journal of Epidemiology_.
doi:10.1093/aje/kwv115 &lt;https://doi.org/10.1093/aje/kwv115&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved incubation period data</span></span>
<span><span class="va">influenza_incubation</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H7N9
Epi Parameter: incubation period
Study: Virlogeux V, Li M, Tsang T, Feng L, Fang V, Jiang H, Wu P, Zheng J, Lau
E, Cao Y, Qin Y, Liao Q, Yu H, Cowling B (2015). "Estimating the
Distribution of the Incubation Periods of Human Avian Influenza A(H7N9)
Virus Infections." _American Journal of Epidemiology_.
doi:10.1093/aje/kwv115 &lt;https://doi.org/10.1093/aje/kwv115&gt;.
Distribution: weibull (days)
Parameters:
  shape: 2.101
  scale: 3.839</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved incubation period data</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">influenza_incubation</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-26-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>:::</p>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-5-introduction-to-statistical-inference">
<strong>Topic 5: Introduction to Statistical Inference</strong><a class="anchor" aria-label="anchor" href="#topic-5-introduction-to-statistical-inference"></a>
</h2>
<hr class="half-width">
<p>Statistics can be divided into two main branches: descriptive and
inferential. As we saw in previous units, the former commonly seeks to
summarise and explore data that have been collected from a selected
sample of a population. In contrast, the second aims to make
generalisations and conclusions about the whole population based on the
information or data from a sample.</p>
<p>By the nature of the inferential process, which is based on taking
random samples from the population, an estimator can take multiple
values since it depends on the units that were selected in the sample.
This variation due to chance, called<strong>variation sampling
variation</strong> must be involved in the inference process as we will
see below.</p>
<p>It is important to stress that sampling variation will depend on the
sample size. For example, if we take samples of size 10 and calculate
the CFR in each of them, these estimates will be more similar to each
other compared to those obtained when only 5 individuals per sample are
selected. This can be tested by running a simulation in R and selecting
1000 samples of size 5 and 10, respectively. As can be seen in the
figure below, the estimated CFRs when increasing the sample size from 5
to 10 were more similar with a lower RIQ.</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the random seed for reproducibility</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Create the population data frame with death indicators (1 = dead, 0 = alive)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>dead <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">160</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Sample with size 5: Draw 100 random samples of size 5 (without replacement)</span></span>
<span><span class="va">samples_n5</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">rep_sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, reps <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Compute the Case Fatality Ratio (CFR) for each replicate in the sample size 5</span></span>
<span><span class="va">cfr_n5</span> <span class="op">&lt;-</span> <span class="va">samples_n5</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>cfr <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">dead</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Sample with size 10: Draw 100 random samples of size 10 (without replacement)</span></span>
<span><span class="va">samples_n10</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">rep_sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, reps <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Compute the Case Fatality Ratio (CFR) for each replicate in the sample size 10</span></span>
<span><span class="va">cfr_n10</span> <span class="op">&lt;-</span> <span class="va">samples_n10</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>cfr <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">dead</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Combine the results from both sample sizes (5 and 10)</span></span>
<span><span class="va">cfr</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cfr_n5</span>, <span class="va">cfr_n10</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Plot the sampling distribution of CFR estimates using a boxplot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cfr</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">size</span>, y <span class="op">=</span> <span class="va">cfr</span>, fill <span class="op">=</span> <span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Create a boxplot without legend</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample size"</span>, y <span class="op">=</span> <span class="st">"CFR estimate"</span>,  </span>
<span>       title <span class="op">=</span> <span class="st">"Sampling Distribution of CFR Estimates"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add labels and title</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Blues"</span><span class="op">)</span>  <span class="co"># Use a blue color palette for visualization</span></span></code></pre>
</div>
<figure><img src="fig/Statistics-rendered-unnamed-chunk-27-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If we calculate the mean and standard deviation of the estimated
values of the CFR with the samples of size 5 and size 10, we see that
indeed the standard deviation of the estimates is smaller with
increasing sample size, but in both cases on average the samples were
closer to the true parameter value of 0.20.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize CFR estimates by sample size</span></span>
<span></span>
<span><span class="va">cfr</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># Group data by sample size  </span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>  </span>
<span>    media <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span>,  <span class="co"># mean CFR  </span></span>
<span>    sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span>,  <span class="co"># standard deviation of CFR  </span></span>
<span>    mediana <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span>,  <span class="co"># median CFR  </span></span>
<span>    P25 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">cfr</span>, <span class="fl">0.25</span><span class="op">)</span>,  <span class="co"># 25th percentile (lower quartile)  </span></span>
<span>    P75 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">cfr</span>, <span class="fl">0.75</span><span class="op">)</span>  <span class="co"># 75th percentile (upper quartile)  </span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 6
  size  media    sd mediana   P25   P75
  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 5     0.208 0.180     0.2   0     0.4
2 10    0.197 0.116     0.2   0.1   0.3</code></pre>
</div>
<p>But, if in real life we can only take a random sample, this means
that we will only have a single chance to calculate a statistic which
will be the <strong>point estimator</strong>of the parameter. However,
this single value will not be able to provide information on the
variability embedded in the random selection of the sample. In addition,
as we saw in the previous example, there is a high probability that many
of the possible sample configurations will give estimates that are far
from the true value of the parameter. Therefore, we must try to involve
sampling variability in the estimation process.</p>
<p><strong>Confidence interval estimation</strong></p>
<p>The objective of confidence interval estimation is to provide a range
of values, a lower and upper bound (a; b), which with a high probability
“…” (a; b), is the most likely to be used in the estimation of a
confidence interval.<strong>confidence</strong>”contains the true value
of the parameter to be estimated. Although each random sample that may
be selected would yield different bounds, this procedure ensures that a
<span class="math inline">\((1-α) %\)</span> of the intervals
constructed will contain the true value of the parameter. This also
implies that a <span class="math inline">\(α%\)</span> of the intervals
will not contain the true value. The symbol α is known as the
significance level.</p>
<p>In general, a confidence interval is constructed with the following
ingredients:</p>
<p><span class="math inline">\(\text{Estimator} ±(\text{reliability
coefficient})*(\text{standard error})\)</span></p>
<div id="discussion6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>In the CFR package of the Epiverse-TRACE initiative, information is
available on an Ebola outbreak that occurred in 1976 in Zaire, now
called the Republic of Congo, documenting the number of cases and deaths
over 73 days. Ultimately, 245 cases of Ebola were reported and 234 of
these were fatal cases. If the interest is to perform a 95% CFR interval
estimate. What should the procedure be?</p>
<p>● <span class="math display">\[**Step
1-Estimator**\]</span>{.underline}: one should start by finding the
estimate in the observed sample:</p>
<p><span class="math inline">\(\hat{p} = \widehat{\text{CFR}} =
\frac{234}{245}= 0.955\)</span></p>
<p>So the estimated CFR was 95.5%.</p>
<p>● <span class="math display">\[**Step 2-Reliability
coefficient**\]</span>{.underline} based on the normal distribution for
95% confidence would correspond to 1.96</p>
<p>● <span class="math display">\[**Step 3-Standard
error:**\]</span>{.underline}</p>
<p><span class="math inline">\(\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}=\sqrt{\frac{0.955
(1-0.955)}{245}}\)</span></p>
<p>● <span class="math display">\[**Step 4-Gather the
ingredients**\]</span>{.underline}</p>
<p>As you have noticed so far this step-by-step can become cumbersome
because of the calculations, but in R we can get everything in a faster
and more efficient way as follows:</p>
<p>$ = $</p>
<p>As you have noticed so far, this step-by-step can become cumbersome
because of the calculations, but in R we can obtain everything in a
faster and more efficient way in the following way:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the Ebola data from 1976</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="va">ebola1976</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Calculate key statistics related to the Case Fatality Ratio (CFR)</span></span>
<span><span class="va">cfr_summary</span> <span class="op">&lt;-</span> <span class="va">ebola1976</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>  </span>
<span>    n <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span>,  <span class="co"># Total number of cases  </span></span>
<span>    deaths <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span>,  <span class="co"># Total number of deaths  </span></span>
<span>    cfr_est <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">n</span>,  <span class="co"># Estimate of the Case Fatality Ratio (CFR)  </span></span>
<span>    error <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="va">cfr_est</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">cfr_est</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span>,  <span class="co"># Standard error calculation  </span></span>
<span>    lim_inf <span class="op">=</span> <span class="va">cfr_est</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">error</span>,  <span class="co"># Lower bound of the 95% confidence interval  </span></span>
<span>    lim_sup <span class="op">=</span> <span class="va">cfr_est</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">error</span>  <span class="co"># Upper bound of the 95% confidence interval  </span></span>
<span>  <span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Print the result</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cfr_summary</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    n deaths  cfr_est      error   lim_inf   lim_sup
1 245    234 0.955102 0.01322986 0.9291715 0.9810326</code></pre>
</div>
</div>
</div>
</div>
<p>Finally, we can conclude that with 95% confidence, the CFR of Ebola
in the 1976 epidemic in the Democratic Republic of Congo is contained in
the interval between 92.9% and 98.1%.</p>
<p>The CFR package also has a built-in function to automatically
estimate with its respective 95% interval the CFR during an epidemic by
means of the function:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute a static Case Fatality Ratio (CFR) using the cfr package</span></span>
<span><span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ebola1976</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  severity_estimate severity_low severity_high
1          0.955102    0.9210866     0.9773771</code></pre>
</div>
<p>As you can see there are slight differences between the CI
constructed step by step and the one reported by the function.
<code>cfr_static</code>. This is because the CFR package performs the
construction of the CI by the method based on maximum likelihood and
different statistical distributions according to the total number of
cases, but the interpretation does not change.</p>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<p><strong>At the end of the session, check if you achieved the
objectives:</strong></p>
<ul>
<li><p>Understand the role of statistics in the study of infectious
diseases.</p></li>
<li><p>Understand and use statistical measures to summarize and analyze
information.</p></li>
<li><p>Become familiar with the concept of a random variable and
recognize common probability distributions.</p></li>
<li><p>Learn how to approach a statistical problem as an inference
problem from a sample.</p></li>
<li><p>Understand the concept of confidence intervals for estimating
epidemiological parameters.</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h3>
<ul>
<li>Erika Cantor: Initial version</li>
<li>Zulma M. Cucunuba: Editing</li>
<li>Laura Gómez-Bermeo: Editing</li>
<li>Andree Valle-Campo: Minor edits</li>
<li>José M. Velasco-Spain: Minor Editions</li>
<li>Hugo Gruson: Translation to english</li>
</ul>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-Deterministic_model"><p>Content from <a href="Deterministic_model.html">Building a simple deterministic model</a></p>
<hr>
<p>Last updated on 2025-06-19 |

        <a href="https://github.com/joskerus/EpiTKit-EN/edit/main/episodes/Deterministic_model.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to build a simplified model of Zika?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>At the end of this workshop you will be able to:</p>
<ul>
<li><p>Recognize how a simple deterministic model is built using
ordinary differential equations.</p></li>
<li><p>Identify relevant parameters for modeling vector-borne disease
(VBD) epidemics.</p></li>
<li><p>Learn how to create a diagram for a compartmental model</p></li>
<li><p>Translate mathematical equations for a deterministic model into R
code.</p></li>
<li><p>Use model simulations to explore transmission scenarios and the
potential impact of interventions.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<p>This unit has the following prerequisites:</p>
<ul>
<li>Introduction to epidemic theory</li>
</ul>
</div>
</div>
</div>
<div id="table-of-contents" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="table-of-contents" class="callout-inner">
<h3 class="callout-title"><strong>Table of Contents</strong></h3>
<div class="callout-content">
<table style="width:97%;" class="table">
<colgroup><col width="97%"></colgroup>
<tbody><tr class="odd">
<td>
<p>Topic 1: Vector-borne diseases - Biology of the vector-borne
disease - Vector biology, Zika virus, diagnostics, and intervention</p>
<p>Topic 2: Review - What is a simple deterministic model?</p>
<p>Topic 3: Simple SIR Model for Zika</p>
<p>Topic 4: Developing diagrams and equations of the Zika model</p>
<p>Topic 5: Elaborating the parameter table of the simple Zika model</p>
<p>Topic 6: The Zika model in R</p>
<p>Topic 7: Parameterization of control interventions for Zika</p>
</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>In this unit we will address the construction of a simple
deterministic model, specifically for the Zika virus, a disease that
triggered a major epidemic in Latin America and the Caribbean, and which
was declared a public health emergency of international concern. Using
previous knowledge of epidemic theory, we will build a deterministic
SIR-type model that incorporates demographic aspects.</p>
<p>To build this model, we will learn about the dynamics of interaction
between humans and vectors, as well as the fundamental parameters that
govern these biological processes. By constructing a diagram, we will
examine these relationships and formulate equations that describe the
behaviour of the system. These equations will be the basis for
simulating the model in the R programming language. In turn, we will
propose and model intervention strategies.</p>
<p>Through the analysis of the model, we will evaluate the potential
impact of this epidemic on society, contextualising some of these
interventions in Latin America. In addition, we will reinforce and apply
key themes such as: SIR model, Herd immunity, Parameters and control
interventions (spraying, bed nets and vaccination) for a Vector Borne
Disease (VBD).</p>
</section><section><h2 class="section-heading" id="topic-6-zika-model-in-r">
<strong>Topic 6: Zika model in R</strong><a class="anchor" aria-label="anchor" href="#topic-6-zika-model-in-r"></a>
</h2>
<hr class="half-width">
<p>In this section we will put to use the knowledge acquired about Zika,
the mechanisms involved in transmission and the model equations. The aim
is to build it in R.</p>
<p>The only package required for the modelling is deSolve, which allows
us to solve the differential equations. Additionally for data handling
and plotting the results we recommend using tidyverse and cowplot.</p>
</section><section><h2 class="section-heading" id="practical-start-in-r">6.1 Practical start in R<a class="anchor" aria-label="anchor" href="#practical-start-in-r"></a>
</h2>
<hr class="half-width">
<p>To start our practice in <strong>R</strong> please open a
<strong>project of R</strong>project and create a new document. In this
document we must load the functions we have just explained. If you have
difficulties with this process, please review the <strong>unit
Introduction to R</strong>.</p>
<p>install.packages(deSolve) # deSolve package for solving differential
equations</p>
<p>Once you have installed the deSolve package please load the packages
with the following lines of code, copy them into your R script and run
them.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the deSolve package for solving differential equations</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">deSolve</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Load the tidyverse package for data manipulation and visualization</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Load the cowplot package for enhanced plot layout and customization</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cowplot</span><span class="op">)</span></span></code></pre>
</div>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<p>Recall that to create a model we need compartments, initial
conditions, parameters and equations.</p>
<p>For this model in R we will start by defining the parameters,
i.e. all those values that have been collected through research and are
part of the behaviour of the disease. In the previous section we talked
about them and completed them in a table. Now it is time to enter them
into R.</p>
<p><strong>Instruction</strong> Please take the table you worked on
earlier and enter the value of each of these parameters.</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">NOTE:</h3>
<div class="callout-content">
<p>It is important to remember that in R, you can use previously created
objects to perform calculations. For example, the parameter muv is the
inverse of the parameter Lv, i.e. muv = 1/Lv. Therefore, in R you can
assign this value directly with muv &lt;- 1/Lv. It is not necessary to
perform the division and assign the result manually.</p>
</div>
</div>
</div>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Instruction: Please take the table you worked on earlier and enter
the value of each of these parameters.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameter List </span></span>
<span></span>
<span><span class="va">Lv</span> <span class="op">&lt;-</span><span class="co"># Life expectancy of mosquitoes (in days)</span></span>
<span><span class="va">Lh</span> <span class="op">&lt;-</span> <span class="co"># Life expectancy of humans (in days)</span></span>
<span><span class="va">IPh</span> <span class="op">&lt;-</span> <span class="co"># Infectious period in humans (in days)</span></span>
<span><span class="va">IPv</span> <span class="op">&lt;-</span> <span class="co"># Infectious period in mosquitoes (in days)</span></span>
<span><span class="va">EIP</span> <span class="op">&lt;-</span> <span class="co"># Extrinsic incubation period in adult mosquitoes (in days)</span></span>
<span><span class="va">muv</span> <span class="op">&lt;-</span> <span class="co"># Per capita mortality rate of mosquito population (1/Lv)</span></span>
<span><span class="va">muh</span> <span class="op">&lt;-</span> <span class="co"># Per capita mortality rate of the human population (1/Lh)</span></span>
<span><span class="va">alphav</span> <span class="op">&lt;-</span> <span class="co"># Per capita birth rate of the mosquito population. For now, we will assume that it is the same as the mortality rate.</span></span>
<span><span class="va">alphah</span> <span class="op">&lt;-</span> <span class="co"># Per capita birth rate of the human population.  For now, we will assume that it is the same as the mortality rate</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span><span class="co"># Recovery rate in humans (1/IPh)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span><span class="co"># Extrinsic incubation rate (1/EIP)</span></span>
<span><span class="va">Nh</span> <span class="op">&lt;-</span> <span class="co"># Number of humans. For this exercise, we suggest 100,000 humans. You can change this if you want according to the city you chose to model.</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="co"># Density of female mosquitoes per human</span></span>
<span><span class="va">Nv</span> <span class="op">&lt;-</span> <span class="co"># Number of mosquitoes (m * Nh)</span></span>
<span><span class="va">R0</span> <span class="op">&lt;-</span><span class="co"># Basic Reproduction Number</span></span>
<span><span class="va">pH</span> <span class="op">&lt;-</span> <span class="co"># Probability of transmission from an infectious mosquito to a susceptible human after a bite.</span></span>
<span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="co"># Probability of transmission from an infectious human to a susceptible mosquito after a bite.</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="va">R0</span> <span class="op">*</span> <span class="va">muv</span><span class="op">*</span><span class="op">(</span><span class="va">muv</span><span class="op">+</span><span class="va">delta</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">muh</span><span class="op">+</span><span class="va">gamma</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span>                   <span class="op">(</span><span class="va">m</span> <span class="op">*</span> <span class="va">pH</span> <span class="op">*</span> <span class="va">pv</span> <span class="op">*</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span> <span class="co"># Biting rate</span></span>
<span><span class="va">betah</span> <span class="op">&lt;-</span> <span class="co"># Coefficient of transmission from an infectious mosquito to a susceptible human after a bite (pH*B)</span></span>
<span><span class="va">betav</span> <span class="op">&lt;-</span> <span class="co"># Coefficient of transmission from an infectious human to a susceptible mosquito after a bite (pv*b)</span></span>
<span><span class="va">TIME</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="co"># Number of years to be simulated. For this exercise, we will start with the first year of the epidemic.</span></span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="model-equations">6.2 Model equations<a class="anchor" aria-label="anchor" href="#model-equations"></a>
</h2>
<hr class="half-width">
<p>Now that we have entered the parameters into the script, it is time
to use the equations that were written earlier, which allow us to know
the number of individuals in each of the six compartments as a function
of time. Three compartments for the humans and three compartments for
the mosquitoes, which are identified by a <strong>h</strong> (for
humans) and a <strong>v</strong>(for mosquitoes). For humans we have the
compartments; susceptible, infected, and recovered (hence the word
<strong>SIR</strong>) and for mosquitoes the compartments are:
susceptible, exposed and infectious (<strong>SEI</strong>).</p>
<div id="compartments" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="compartments" class="callout-inner">
<h3 class="callout-title">Compartments</h3>
<div class="callout-content">
<ul>
<li><p><span class="math inline">\(S_h\)</span> Human
susceptible</p></li>
<li><p><span class="math inline">\(I_h\)</span> Infectious
humans</p></li>
<li><p><span class="math inline">\(R_h\)</span> Infectious humans :
Humans recovered from infection (immunised against new
infection)</p></li>
<li><p><span class="math inline">\(S_v\)</span> Susceptible
vectors</p></li>
<li><p><span class="math inline">\(E_v\)</span> Vectors at risk :
Exposed vectors</p></li>
<li><p><span class="math inline">\(I_v\)</span> Infectious
vectors</p></li>
</ul>
</div>
</div>
</div>
<p>For this model we will use the following differential equations:</p>
<div class="section level3">
<h3 id="human">6.2.1 Human<a class="anchor" aria-label="anchor" href="#human"></a>
</h3>
<p><span class="math display">\[\ \frac{dSh}{dt}  = \alpha_h N_h -
\beta_h \frac {I_v}{N_h}S_h - \mu_h  S_h \]</span></p>
<p><span class="math display">\[\ \frac{dIh}{dt}  = \beta_h \frac
{I_v}{N_h}S_h - (\gamma + \mu_h) I_h \]</span><br></p>
<p><span class="math display">\[\ \frac{dRh}{dt}  = \gamma I_h  - \mu_h
R_h\]</span></p>
</div>
<div class="section level3">
<h3 id="vectors">6.2.2 Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a>
</h3>
<p><span class="math display">\[\ \frac{dSv}{dt}  = \alpha_v N_v  -
\beta_v \frac{ I_h} {N_h}S_v  - \mu_v Sv\]</span></p>
<p><span class="math display">\[\ \frac{dE_v}{dt}  = \beta_v \frac{I_h}
{N_h}S_v- (\delta + \mu_v) Ev\]</span><br></p>
<p><span class="math display">\[\ \frac{dI_v}{dt}  = \delta Ev - \mu_v
I_v\]</span></p>
</div>
</section><section><h2 class="section-heading" id="formula-for-calculating-r_0-basic-reproductive-number">6.3 Formula for calculating <span class="math inline">\(R_0\)</span>
(Basic reproductive number)<a class="anchor" aria-label="anchor" href="#formula-for-calculating-r_0-basic-reproductive-number"></a>
</h2>
<hr class="half-width">
<p>Formula needed to estimate <span class="math inline">\(R_0\)</span>:</p>
<p><span class="math display">\[ R_0 = \frac{mb^2 p_h p_v \delta}{\mu_v
(\mu_v+\delta)(\mu_h+\gamma)} \]</span></p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Instruction</strong>: Translate the equations into R</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Humans</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>         dSh   <span class="ot">&lt;-</span>  alphah <span class="sc">*</span> Nh <span class="sc">-</span> betah <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> muh <span class="sc">*</span> Sh</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>         dIh   <span class="ot">&lt;-</span>______ <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> (____ <span class="sc">+</span> _____) <span class="sc">*</span> Ih</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>         dRh   <span class="ot">&lt;-</span>  ______ <span class="sc">*</span> Ih  <span class="sc">-</span> ______ <span class="sc">*</span> Rh</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a> <span class="co"># Mosquitoes</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>         dSv  <span class="ot">&lt;-</span>  alphav <span class="sc">*</span> Nv <span class="sc">-</span> _____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> _____ <span class="sc">*</span> Sv</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>         dEv  <span class="ot">&lt;-</span>  _____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> (____ <span class="sc">+</span> _____)<span class="sc">*</span> Ev</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>         dIv  <span class="ot">&lt;-</span>  _____ <span class="sc">*</span> Ev <span class="sc">-</span> _____ <span class="sc">*</span> Iv</span></code></pre>
</div>
</div>
</div>
</div>
<p>Once we know how to translate the equations into code, we will
proceed to run the model. For this, the ode function of the deSolve
package will be used.</p>
<p>You start by creating the function (which will then be used in the
argument <strong>fun</strong>). This requires translating the equations
of the Zika model to <strong>R</strong>. Below you will find the
function already built <code>modelo_zika</code> for you to replace the
equations you have already filled in above.</p>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p><strong>Instruction</strong>: Replace the incomplete equations in the
following code with the complete equations of the Zika model you worked
on in the previous instruction.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Simple Deterministic Model (FUN)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>zika_model <span class="ot">&lt;-</span> <span class="cf">function</span>(time, state_variable, parameters) {</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state_variable, parameters)), <span class="co"># local environment to evaluate derivatives</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>       {</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>         <span class="co"># Humans</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>         dSh <span class="ot">&lt;-</span> ____ <span class="sc">*</span> Nh <span class="sc">-</span> ____ <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> ____ <span class="sc">*</span> Sh   </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>         dIh <span class="ot">&lt;-</span> ____ <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> (____ <span class="sc">+</span> ____) <span class="sc">*</span> Ih</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>         dRh <span class="ot">&lt;-</span> ____ <span class="sc">*</span> Ih <span class="sc">-</span> ____ <span class="sc">*</span> Rh</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>         </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>         <span class="co"># Mosquitoes</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>         dSv <span class="ot">&lt;-</span> alphav <span class="sc">*</span> Nv <span class="sc">-</span> ____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> ____ <span class="sc">*</span> Sv </span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>         dEv <span class="ot">&lt;-</span> ____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> (____ <span class="sc">+</span> ____)<span class="sc">*</span> Ev</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>         dIv <span class="ot">&lt;-</span> ____ <span class="sc">*</span> Ev <span class="sc">-</span> ____ <span class="sc">*</span> Iv</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>         </span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>         <span class="fu">list</span>(<span class="fu">c</span>(dSh, dIh, dRh, dSv, dEv, dIv))</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>       }</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  )</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>}</span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="solving-the-system">6.4 Solving the System<a class="anchor" aria-label="anchor" href="#solving-the-system"></a>
</h2>
<hr class="half-width">
<p>To solve the system it is necessary to create the three missing
arguments (<strong>times</strong>, <strong>parms</strong> y
<strong>y</strong>) to use the function <code>ode</code>.</p>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p><strong>Instruction:</strong> For <code>times</code> y
<code>parms</code> copy the code below and execute it.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sequence of times (times)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">365</span> <span class="op">*</span> <span class="va">TIME</span> , by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Parameters (parms)</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  muv      <span class="op">=</span> <span class="va">muv</span>,</span>
<span>  muh      <span class="op">=</span> <span class="va">muh</span>,</span>
<span>  alphav   <span class="op">=</span> <span class="va">alphav</span>,</span>
<span>  alphah   <span class="op">=</span> <span class="va">alphah</span>,</span>
<span>  gamma    <span class="op">=</span> <span class="va">gamma</span>,</span>
<span>  delta    <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  betav    <span class="op">=</span> <span class="va">betav</span>,</span>
<span>  betah    <span class="op">=</span> <span class="va">betah</span>,</span>
<span>  Nh       <span class="op">=</span> <span class="va">Nh</span>,</span>
<span>  Nv       <span class="op">=</span> <span class="va">Nv</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>In the code that ran, time was created (<strong>times)</strong> and
parameters (<strong>params)</strong>. We still need to create the
argument <strong>y</strong> argument, which we will develop in the next
section.</p>
<div class="section level3">
<h3 id="initial-conditions-of-the-system-y">6.4.1. <strong>Initial conditions of the system (y)</strong>
<a class="anchor" aria-label="anchor" href="#initial-conditions-of-the-system-y"></a>
</h3>
<p>In order to define the initial conditions, recall that the scenario
to be modelled in this exercise is for a date <strong>before the report
of the first case</strong>. Therefore these values should reflect that
context.</p>
<div id="discussion5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p><strong>Reflection:</strong> What would be the initial conditions of
each of the compartments?</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p><strong>Instruction:</strong> Fill in the blanks as learned in the
tutorial.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Initial conditions of the system (y)</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Sh =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>            <span class="at">Ih =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>            <span class="at">Rh =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>            <span class="at">Sv =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>            <span class="at">Ev =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>            <span class="at">Iv =</span> _______ )        <span class="co"># COMPLETE AND COMMENT</span></span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</div>
<div class="section level3">
<h3 id="function-ode">6.4.2 Function ode<a class="anchor" aria-label="anchor" href="#function-ode"></a>
</h3>
<p>Once all the necessary arguments have been created, it is time to
enter them into ode. Let’s remember the four arguments of ode and a
which correspond to:</p>
<ul>
<li><p><strong>y</strong>:<strong>home</strong>. Vector created with the
initial conditions of the six compartments.</p></li>
<li><p><strong>times</strong>:<strong>time</strong>. Vector with time
sequence</p></li>
<li><p><strong>fun:zika_model</strong>. Function containing the
necessary equations to simulate the model.</p></li>
<li><p><strong>parms:parameters.</strong> Vector in which the parameters
needed to simulate the model were collected.</p></li>
</ul>
<div id="challenge-6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6</h3>
<div class="callout-content">
<p><strong>Instruction</strong> Fill in the blanks according to what you
have worked on so far.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Solve the equations</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> _______ , <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>              <span class="at">times =</span> _______ ,   <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>              <span class="at">fun =</span> _______ ,   <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>              <span class="at">parms =</span> _______  <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="co"># Convert to data frame</span></span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</div>
<div class="section level3">
<h3 id="introducing-the-first-case">6.4.3 <strong>Introducing the first case</strong>
<a class="anchor" aria-label="anchor" href="#introducing-the-first-case"></a>
</h3>
<p>Now that we have all the compartments defined, it is time to enter an
infectious individual into the model to start the epidemic.</p>
<div id="discussion8" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p><strong>Reflection:</strong> Which do you think is more likely, an
infectious human or an infectious mosquito entering a population (in
another country)?</p>
</div>
</div>
</div>
<p>For our hypothetical case, let’s assume that a person became infected
in Brazil while on tourism and subsequently returned to the city
______________ (the city you defined at the beginning of the exercise)
and was the first infectious subject in this population. In this
context, the compartment of infectious humans will then have one
individual, <strong>Ih</strong> = 1 and the susceptible human
compartment will have one less individual, <strong>Sh</strong> =
<strong>Nh</strong> - 1.</p>
<div id="discussion9" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Track:</strong> Change in R the initial (start) conditions so
that Ih = 1 and Sh = Nh - 1.</p>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</div>
</section><section><h2 class="section-heading" id="now-lets-run-the-model">6.5 <strong>Now let’s run the model!</strong>
<a class="anchor" aria-label="anchor" href="#now-lets-run-the-model"></a>
</h2>
<hr class="half-width">
<p><strong>At this point, you have filled in all the missing information
in the script in order to be able to run the model.</strong></p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p><strong>Instruction:</strong> Run each set of the script lines seen
above, i.e. run the sections: Parameter list, the section Simple
deterministic model (where you built the model), the sections Time
sequence (time (times)), The parameters (parameters (parms)), the
section Initial conditions of the system (start (y)) and the final
section Solve the equations.</p>
<p><strong>Instruction:</strong> Check that no errors are displayed. In
case of error, please check the spelling of the code and that there are
no other characters left in the code that do not correspond, for example
“_____”, the hyphens in the spaces to be filled in.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="viewing-the-results">6.6 <strong>Viewing the results</strong>
<a class="anchor" aria-label="anchor" href="#viewing-the-results"></a>
</h2>
<hr class="half-width">
<p><strong>In our course we will use ggplot for data visualisation. It
is important that you review Unit 4. Data visualisation in
ggplot</strong></p>
<p>It should be recalled that the time unit of the Zika model is already
defined from the parameters as <strong>days</strong>.</p>
<p>However, if you would like to visualise the results in weeks, months
or years, you can do so from the model results
(<code>salida$time</code>). To do so, you can use the following
code.</p>
<div id="challenge-7" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-7" class="callout-inner">
<h3 class="callout-title">Challenge 7</h3>
<div class="callout-content">
<p>For a more meaningful visualisation of the results, convert the units
of time from <em>days</em> a <em>years</em> and a <em>weeks</em>.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert the times from days to years and weeks, respectively</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">/</span><span class="fl">365</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">weeks</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">/</span><span class="fl">7</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="visualise-and-analyse-the-first-epidemic">6.7 <strong>Visualise and analyse the first epidemic</strong>
<a class="anchor" aria-label="anchor" href="#visualise-and-analyse-the-first-epidemic"></a>
</h2>
<hr class="half-width">
<p>Let’s start with a visualisation of the first epidemic. Since it is a
period of one year, let’s visualise the graphs in weeks.</p>
<p>Instruction: Run the code below and analyse the resulting graphs.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Review the first epidemic</span></span>
<span><span class="va">p1e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Infectious Human Population"</span>, x <span class="op">=</span> <span class="st">"Weeks"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p2e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recovered Human Population'</span>, x<span class="op">=</span> <span class="st">"Weeks"</span>, y<span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1e</span>, <span class="va">p2e</span><span class="op">)</span> <span class="co"># comparison graph of the infectious human population and recovered human population graph</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-p1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="discussion11" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p><strong>Reflection:</strong> What can you see in the graph? Look
closely at the Y-axis. What proportion of humans are infectious at the
same time?</p>
</div>
</div>
</div>
<p>To make this clearer we can create graphs of the proportions:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Review the first epidemic with proportions</span></span>
<span><span class="va">p1e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Infectious Human Population"</span>, x <span class="op">=</span> <span class="st">"Weeks"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># graph of infectious human population</span></span>
<span></span>
<span><span class="va">p2e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recovered Human Population'</span>, x<span class="op">=</span> <span class="st">"Weeks"</span>, y<span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># graph of recovered human population}</span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1e</span>, <span class="va">p2e</span><span class="op">)</span> <span class="co"># comparison graph of the infectious human population and recovered human population graph</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-p3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>General behaviour (Human population)</strong></p>
<p>Having observed the first epidemic, it is now time to project the
epidemic to a longer time frame.</p>
<p><strong>Instruction:</strong> Go back to the parameters and change
the TIME parameter to 100 years. Run the following code block and
observe how many outbreaks occur in the human population and the size of
each outbreak.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Examine the behavior of the model for 100 years</span></span>
<span><span class="va">p1h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Rh</span> <span class="op">+</span> <span class="va">Ih</span> <span class="op">+</span> <span class="va">Sh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'grey68'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Total Human Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'royalblue'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Susceptible Human Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Infectious Human Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p4h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recovered Human Population'</span> , x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1h</span>, <span class="va">p2h</span>, <span class="va">p3h</span>, <span class="va">p4h</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-p4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>General Behaviour (Mosquito Population)</strong></p>
<p><strong>Instruction:</strong> Run the following code block and
observe how many outbreaks occur in the mosquito population and the size
of each outbreak. Compare the graphs with the human population
graphs.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine the behavior of the model</span></span>
<span><span class="va">p1v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Sv</span> <span class="op">+</span> <span class="va">Ev</span> <span class="op">+</span> <span class="va">Iv</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'grey68'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Total mosquito population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'royalblue'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Susceptible Mosquito Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ev</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'orchid'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Exposed Mosquito Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p4v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Iv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Infectious Mosquito Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1v</span>, <span class="va">p2v</span>, <span class="va">p3v</span>, <span class="va">p4v</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Proportion</strong></p>
<p><strong>Instruction:</strong> Run the following code block and
compare it to the graphs generated for the human population.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Proportions</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'royalblue'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Susceptible human population'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Susceptible Human Population"</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Infectious Human Population"</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Recovered Human Population"</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<p>Check if you have acquired these competences by the end of this
lesson:</p>
<ul>
<li><p>Recognize how a simple deterministic model is built using
ordinary differential equations.</p></li>
<li><p>Identify relevant parameters for modeling vector-borne disease
(VBD) epidemics.</p></li>
<li><p>Learn how to create a diagram for a compartmental model</p></li>
<li><p>Translate mathematical equations for a deterministic model into R
code.</p></li>
<li><p>Use model simulations to explore transmission scenarios and the
potential impact of interventions.</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h3>
<ul>
<li>Zulma Cucunuba &amp; Pierre Nouvellet: Initial version</li>
<li>Kelly Charinga &amp; Zhian N. Kamvar: Editing</li>
<li>José M. Velasco-Spain: Translation from English to Spanish and
Editing</li>
<li>Andree Valle-Campos: Minor Editions</li>
</ul>
</div>
<div class="section level3">
<h3 id="legal-affairs">Legal affairs<a class="anchor" aria-label="anchor" href="#legal-affairs"></a>
</h3>
<p><strong>Copyright</strong>: Zulma Cucunuba &amp; Pierre Nouvellet,
2017</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>de Carvalho, S. S., Rodovalho, C. M., Gaviraghi, A., Mota, M. B. S.,
Jablonka, W., Rocha-Santos, C., Nunes, R. D., Sá-Guimarães, T. da E.,
Oliveira, D. S., Melo, A. C. A., Moreira, M. F., Fampa, P., Oliveira, M.
F., da Silva-Neto, M. A. C., Mesquita, R. D., &amp; Atella, G. C.
(2021). Aedes aegypti post-emergence transcriptome: Unveiling the
molecular basis for the hematophagic and gonotrophic capacitation. PLoS
Neglected Tropical Diseases, 15(1), 1–32. <a href="https://doi.org/10.1371/journal.pntd.0008915" class="external-link uri">https://doi.org/10.1371/journal.pntd.0008915</a></p>
<p>Chang, C., Ortiz, K., Ansari, A., &amp; Gershwin, M. E. (2016). The
Zika outbreak of the 21st century. Journal of Autoimmunity, 68, 1–13. <a href="https://doi.org/10.1016/j.jaut.2016.02.006" class="external-link uri">https://doi.org/10.1016/j.jaut.2016.02.006</a></p>
<p>Cori, A., Ferguson, N. M., Fraser, C., &amp; Cauchemez, S. (2013). A
new framework and software to estimate time-varying reproduction
numbers. during epidemics. American Journal of Epidemiology, 178(9),
1505–1512. <a href="https://doi.org/10.1093/aje/kwt133" class="external-link uri">https://doi.org/10.1093/aje/kwt133</a></p>
<p>Duffy, M. R., Chen, T.-H., Hancock, W. T., Powers, A. M., Kool, J.
L., Lanciotti, R. S., Pretrick, M., Marfel, M., Holzbauer, S., Dubray,
C., Guillaumot, L., Griggs, A., Bel, M., Lambert, A. J., Laven, J.,
Kosoy, O., Panella, A., Biggerstaff, B. J., Fischer, M., &amp; Hayes, E.
B. (2009). Zika Virus Outbreak on Yap Island, Federated States of
Micronesia. New New England Journal of Medicine, 360(24), 2536–2543. <a href="https://doi.org/10.1056/nejmoa0805715" class="external-link uri">https://doi.org/10.1056/nejmoa0805715</a></p>
<p>Ferguson, N. M., Cucunubá, Z. M., Dorigatti, I., Nedjati-Gilani, G.
L., Donnelly, C. A., Basáñez, M. G., Nouvellet, P., &amp; Lessler, J.
(2016). Countering the Zika epidemic in Latin America. Science,
353(6297). <a href="https://doi.org/10.1126/science.aag0219" class="external-link uri">https://doi.org/10.1126/science.aag0219</a></p>
<p>Heesterbeek, J. A. P. (2002). A brief history of R0 and a recipe for
its calculation. Acta Biotheoretica, 50(3). <a href="https://doi.org/10.1023/A:1016599411804" class="external-link uri">https://doi.org/10.1023/A:1016599411804</a></p>
<p>Lee, E. K., Liu, Y., &amp; Pietz, F. H. (2016). A Compartmental Model
for Zika Virus with Dynamic Human and Vector Populations. AMIA … Annual
Symposium Proceedings. AMIA Symposium, 2016, 743–752.</p>
<p>Pettersson, J. H. O., Eldholm, V., Seligman, S. J., Lundkvist, Å.,
Falconar, A. K., Gaunt, M. W., Musso, D., Nougairède, A., Charrel, R.,
Gould, E. A., &amp; de Lamballerie, X. (2016). How did zika virus emerge
in the Pacific Islands and Latin America? MBio, 7(5). <a href="https://doi.org/10.1128/mBio.01239-16" class="external-link uri">https://doi.org/10.1128/mBio.01239-16</a></p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-Error_bank"><p>Content from <a href="Error_bank.html">Bank of frequently asked questions and errors</a></p>
<hr>
<p>Last updated on 2025-06-19 |

        <a href="https://github.com/joskerus/EpiTKit-EN/edit/main/episodes/Error_bank.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Do you have some difficulties with R code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>In this document you will find some of the frequently asked
questions and errors in R code execution.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="question-bank">Question Bank<a class="anchor" aria-label="anchor" href="#question-bank"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="is-rtools-necessary">Is RTools necessary?<a class="anchor" aria-label="anchor" href="#is-rtools-necessary"></a>
</h3>
<p>There are several common problems in R that may require the
installation of Rtools.</p>
<ol style="list-style-type: decimal">
<li><p>Installing packages that require compilation: Some R packages
need to be compiled from source code, which requires compilation tools
that Rtools provides.</p></li>
<li><p>C, C++ or Fortran dependencies: If you want to install packages
that depend on code written in C, C++ or Fortran, you will need Rtools
to compile these components.</p></li>
<li><p>Compilation errors: If you encounter errors during the
installation of packages that mention compilation problems, Rtools can
resolve these problems by providing the necessary tools.</p></li>
<li><p>Custom package development: If you are developing your own R
package and need to compile source code, Rtools is essential for this
process.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="how-to-install-rtools">How to install RTools?<a class="anchor" aria-label="anchor" href="#how-to-install-rtools"></a>
</h3>
<p><em>Before you start please check that you have administrator
permissions on the computer or laptop.</em></p>
<p>Installing Rtools</p>
<p>The installation of Rtools depends on the operating system you are
using.</p>
</div>
<div class="section level3">
<h3 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Check which version of R you have:</li>
</ol>
<p>In the R console type and run this command:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessionInfo</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>R version 4.5.0 (2025-04-11)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.5.0 tools_4.5.0    yaml_2.3.10    knitr_1.49     xfun_0.51
[6] renv_1.1.4     evaluate_1.0.3</code></pre>
</div>
<p><strong>You will get information similar to this. In this case the
version is 4.5</strong></p>
<ol start="2" style="list-style-type: decimal">
<li>Visit the RTools page on CRAN in the browser of your choice: <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a>and select
the version of Rtools that matches the current version of R you have on
your machine and your computer architecture. Or click on one of the
following links to download the installer:</li>
</ol>
<p>\</p>
<table class="table">
<colgroup>
<col width="73%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>For versions of R…</th>
<th>Install:</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>From 4.5.0</td>
<td><a href="https://cran.r-project.org/bin/windows/Rtools/rtools45/rtools.html" class="external-link">RTools
4.5</a></td>
</tr>
<tr class="even">
<td>From 4.4.0</td>
<td><a href="https://cran.r-project.org/bin/windows/Rtools/rtools44/rtools.html" class="external-link">RTools
4.4</a></td>
</tr>
<tr class="odd">
<td>Since 4.3.0</td>
<td><a href="https://cran.r-project.org/bin/windows/Rtools/rtools43/rtools.html" class="external-link">RTools
4.3</a></td>
</tr>
<tr class="even">
<td>Starting with 4.2.</td>
<td><a href="https://cran.r-project.org/bin/windows/Rtools/rtools42/rtools.html" class="external-link">RTools
4.2</a></td>
</tr>
<tr class="odd">
<td>Between 4.0.0 to 4.1.3</td>
<td><a href="https://cran.r-project.org/bin/windows/Rtools/rtools40.html" class="external-link">RTools
4.0</a></td>
</tr>
<tr class="even">
<td>Prior to 4.0.0</td>
<td><a href="https://cran.r-project.org/bin/windows/Rtools/history.html" class="external-link">older
versions of RTools</a></td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li>On the download page, look for the phrase: “<strong><em>may be
installed from the</em></strong>”and click on <strong><a href="https://cran.r-project.org/bin/windows/Rtools/rtools44/files/rtools44-6335-6327.exe" class="external-link"><em>Rtools44
installer</em></a></strong> or in the version you have selected
<strong>above <em>RtoolsXX installer</em></strong>.</li>
</ol>
<figure><img src="fig/rtools.png" class="figure mx-auto d-block"></figure><ol start="4" style="list-style-type: decimal">
<li><p>Wait for the download to finish and run the file.</p></li>
<li><p>Click on “<em>Next</em>” o “<em>Next</em>”for all the options
displayed on the screen.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="mac">Mac<a class="anchor" aria-label="anchor" href="#mac"></a>
</h3>
<p>On Mac, you only need to install Xcode Command Line Tools.</p>
<ol style="list-style-type: decimal">
<li><p>Click Spotlight Search at the top right of the screen, then
search for “Terminal”.</p></li>
<li><p>Open a terminal or command line on your machine.</p></li>
<li><p>In the terminal, copy and paste the following command:
<code>xcode-select –install</code></p></li>
<li><p>You will probably need to provide your password to install the
software.</p></li>
<li><p>Follow the instructions on the terminal and wait for the
installation to complete.</p></li>
</ol>
<p>You can also do it directly from R as explained in this video: <a href="https://www.youtube.com/watch?v=_fckF0fefXQ&amp;t=5s" class="external-link">Installation
using R</a></p>
</div>
<div class="section level3">
<h3 id="how-to-install-a-package-or-library-in-r">
<span id="instr">How to install a package or “library” in
R?</span><a class="anchor" aria-label="anchor" href="#how-to-install-a-package-or-library-in-r"></a>
</h3>
<p>To install a package in R, you can do so via:</p>
<ul>
<li>We recommend that you do this through the function:</li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"package"</span><span class="op">)</span></span></code></pre>
</div>
<p>Some packages that are in their development phase can be installed
from the latest version on github or other locations using remotes or
pak packages.</p>
<ul>
<li>Another option is to use the require function:</li>
</ul>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"package"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">install.packages</span><span class="op">(</span><span class="st">"package"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>This option is useful because it installs the package if it is not
previously installed. It can be combined with remotes or pak</p>
<ul>
<li>
<p>Use the RStudio interface:</p>
<ol style="list-style-type: decimal">
<li><p>Click on the <code>Packages</code></p></li>
<li><p>Click on the button <code>Install</code></p></li>
<li><p>Enter the name of the package(s) to install.</p></li>
<li><p>Press button <code>Install</code>.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="how-to-use-a-function">
<span id="funcr">How to use a function?</span><a class="anchor" aria-label="anchor" href="#how-to-use-a-function"></a>
</h3>
<p>If the function belongs to an R package, this can be done in two
ways:</p>
<ul>
<li>Call the name of the R package and put a colon twice.
<code>(::)</code> and then call the function name. Now you must fill in
the arguments</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">package</span><span class="fu">::</span><span class="fu">function_name</span><span class="op">(</span><span class="va">arguments</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>Load the R package with <code>library</code>:</li>
</ul>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"package"</span><span class="op">)</span></span></code></pre>
</div>
<p>and once loaded. Call the name of the function and fill in the
arguments</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">function_name</span><span class="op">(</span><span class="va">arguments</span><span class="op">)</span></span></code></pre>
</div>
<p>It is important to have the package previously installed. If in
doubt, go to <a href="instr">How to install a package in R?</a></p>
<ul>
<li><div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>      <span class="ex">If</span> the function was created by you and is in the global environment:</span></code></pre>
</div></li>
</ul>
<p>Simply call the function by name and provide the necessary
arguments:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">function_name</span><span class="op">(</span><span class="va">arguments</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="how-to-load-a-package-or-library">How to load a package or “library”?<a class="anchor" aria-label="anchor" href="#how-to-load-a-package-or-library"></a>
</h3>
<p>Some options for uploading a package are:</p>
<ul>
<li>The recommended one is to use the library function:</li>
</ul>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"package"</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>
<p>Using the RStudio interface:</p>
<ol style="list-style-type: decimal">
<li><p>Go to the bottom right section to the
<code>Packages</code></p></li>
<li><p>Click on the box in front of each function, this will activate
the function. <code>library</code>.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="if-i-load-the-libraries-do-i-have-to-load-them-every-time-i-use-the-function">If I load the libraries, do I have to load them every time I use the
function?<a class="anchor" aria-label="anchor" href="#if-i-load-the-libraries-do-i-have-to-load-them-every-time-i-use-the-function"></a>
</h3>
<p>No, you only need to load them once per R session. However, if you
close your RStudio or open a new project, it counts as a new session and
therefore you must load them again in order to work.</p>
</div>
<div class="section level3">
<h3 id="can-i-deactivate-a-library-that-i-already-loaded-without-restarting-r">Can I deactivate a library that I already loaded without restarting
R?<a class="anchor" aria-label="anchor" href="#can-i-deactivate-a-library-that-i-already-loaded-without-restarting-r"></a>
</h3>
<p>Yes, it is possible through two options:</p>
<ul>
<li>Use the function <code>detach</code>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">detach</span><span class="op">(</span><span class="st">"package_name"</span>, unload <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>
<p>Using the RStudio interface:</p>
<ol style="list-style-type: decimal">
<li><p>Go to the bottom right section to the
<code>Packages</code></p></li>
<li><p>Click on the box in front of each function (if the box has a
tick, the package is loaded; if the box is empty, the package is not
loaded), this will activate the function. <code>detach</code>.
<strong><em>Warning</em>: Pressing the x symbol next to the package will
uninstall it.</strong></p></li>
</ol>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-object-or-function-was-not-created">The object or function was not created<a class="anchor" aria-label="anchor" href="#the-object-or-function-was-not-created"></a>
</h3>
<p>This can happen for several reasons:</p>
<ul>
<li>
<strong>Incomplete execution of the code</strong> The most common
reason is that the code has not been executed partially or completely.
Make sure you run the entire script so that all the lines of code are
executed in the correct order. To create the object, make sure you have
done one of these two actions:</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>type the code into the console and run (by pressing
<code>Enter</code>)</p></li>
<li><p>or in the RMarkdown script or Chunck press <code>Control</code> +
<code>Enter</code> on Windows or <code>Command</code> +
<code>Enter</code> on Mac.</p></li>
</ol>
<p>If the object or function was created correctly, it will appear in
the global environment (<em>Environment</em>) located in the upper
right-hand side area.</p>
<ul>
<li><p>Missing required packages: Check that all required packages or
libraries are loaded at the start of the script.</p></li>
<li><p>Errors in the code: Check that there are no errors that prevent
the code from executing correctly. When executing the code in the
console, some error alerts will appear.</p></li>
</ul>
<div id="recommendation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="recommendation" class="callout-inner">
<h3 class="callout-title">Recommendation</h3>
<div class="callout-content">
<p>Always look at the console to check whether:</p>
<ol style="list-style-type: decimal">
<li>The code was executed successfully. In case it did not run, you can
run it again.</li>
<li>If a command is still executing and you see the red
<strong>stop</strong>. In this case, wait for R to finish the process
before executing other commands.</li>
<li>If an error has occurred. Review the errors or warnings, as this may
give you clues on how to fix the problem.</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="i-dont-see-the-result-of-my-code">I don’t see the result of my code<a class="anchor" aria-label="anchor" href="#i-dont-see-the-result-of-my-code"></a>
</h3>
<p>This can happen for several reasons:</p>
<ul>
<li>
<p>If I save the result using the allocation symbol
(i.e. <code>nombre &lt;- "Laura"</code>). This will appear in the global
environment (top right side area) and will not be executed on the
console unless the object is called, i.e,</p>
<ol style="list-style-type: decimal">
<li><p>the name of the object is put in the console and executed (by
pressing the <code>Enter</code>)</p></li>
<li><p>or that in the RMarkdown script or Chunck you press
<code>Control + Enter</code> in Windows or <code>Command + Enter</code>
on Mac.</p></li>
</ol>
</li>
<li><p>A required library is missing. Check that all required libraries
are loaded at the start of the script.</p></li>
<li><p>There are errors in the code. Check that there are no errors that
prevent the code from executing correctly. When executing the code in
the console you will see some error alerts that the code may
have.</p></li>
<li><p>The script has not executed completely. Be sure to run the entire
script so that all lines of code are executed in the correct
order.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="common-errors-when-using-ggplot">Common errors when using <code>ggplot</code>
<a class="anchor" aria-label="anchor" href="#common-errors-when-using-ggplot"></a>
</h3>
<ul>
<li>
<p>Incorrect syntax:</p>
<ol style="list-style-type: decimal">
<li><p>Use <code>++</code> instead of <code>+</code> to concatenate
functions.</p></li>
<li><p>It may also happen that the <code>+</code> is on the line below,
it is important to note that to concatenate functions it must be at the
end of the line before the one you want to concatenate.</p></li>
</ol>
</li>
</ul>
<figure><img src="fig/bpggplot.png" class="figure mx-auto d-block"></figure><ul>
<li>
<p>Do not specify aesthetics:</p>
<ol style="list-style-type: decimal">
<li>Do not include <code>aes()</code>.</li>
<li>Do not define <code>aes()</code> correctly, e.g. not stating x or
y.</li>
<li>Although aes may in some cases be in the initial part, the geometry
or be divided into sections, it is essential that it is always
present.</li>
</ol>
</li>
<li><p>Data not present:</p></li>
</ul>
<p>The column referred to in aes() does not exist in the dataset. Use
the wrong name, remember that R is case sensitive
therefore<code>VariableX</code> is different from <code>variableX</code>
or <code>variablex</code>.</p>
<ul>
<li>Lack of bookshops:</li>
</ul>
<p>Before working with <code>ggplot</code> always remember to load the
library with <code>library</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>Errors in <code>geom</code>:</li>
</ul>
<p>Selecting the wrong geom for the type of data being represented.</p>
</div>
<div class="section level3">
<h3 id="filter-doesnt-work">
<code>filter</code> doesn’t work<a class="anchor" aria-label="anchor" href="#filter-doesnt-work"></a>
</h3>
<p>“This can happen for several reasons:”</p>
<ul>
<li><p>The package <code>dplyr</code> is not loaded. Be sure to include
<code><a href="https://dplyr.tidyverse.org" class="external-link">library(dplyr)</a></code> o <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code> in your
script, and run it every new session.</p></li>
<li><p>There are function name conflicts with other packages. Use
<code>dplyr::filter()</code> to specify which function you want to use
<code>filter</code> function from <code>dplyr</code>.</p></li>
<li><p>The data may not be in the expected format. Verify that the
column you are filtering exists and has the appropriate values.</p></li>
</ul>
<p><code>filter</code> Accept logical conditions for selecting rows.</p>
<p>For more information on filtering, see the <a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">documentation</a>.</p>
</div>
<div class="section level3">
<h3 id="where-is-the-object-you-create">Where is the object you create?<a class="anchor" aria-label="anchor" href="#where-is-the-object-you-create"></a>
</h3>
<p>When an object is created it is stored in the global environment. We
can see the global environment in the R interface located on the top
right side.</p>
</div>
<div class="section level3">
<h3 id="the-pipe-does-not-work">The pipe does not work <code>%&gt;%</code>
<a class="anchor" aria-label="anchor" href="#the-pipe-does-not-work"></a>
</h3>
<p>Remember the following points:</p>
<ul>
<li>It is important to pre-load a library containing the pipe. For
example: <code>magrittr</code>, <code>dplyr</code>, <code>tidyr</code> o
<code>purrr</code>.</li>
<li>The pipe must go at the end of the line to be connected. Not at the
beginning of the connected line.</li>
</ul>
</div>
<div class="section level3">
<h3 id="prevencion">How to avoid accidents?<a class="anchor" aria-label="anchor" href="#prevencion"></a>
</h3>
<p>When you are going to store changes in the object where the dataframe
is stored, it is advisable to take some precautions to avoid losing
information:</p>
<ul>
<li>Create a backup of the data in objects:</li>
</ul>
<p>o Make regular backups during the process. It is recommended to make
an initial copy to avoid reloading the database. After doing some
processes, especially time-consuming ones, it is recommended to create
backups. You can create as many as you consider convenient. It is
recommended to create notes to identify each process</p>
<ul>
<li>Create a backup of the data in files:</li>
</ul>
<p>o Like saving to objects, it is a good idea to save data that has
already gone through some processes on the computer’s disk. This
prevents processed data from being backed up if the session crashes or
the computer is shut down. How often it should be stored depends on who
is doing the processing.</p>
<ul>
<li>Testing before storage:</li>
</ul>
<p>o Conduct tests of desired changes before final storage.</p>
<p>o Example: If you want to transform a variable into a numeric
variable, before storing it, and end up having <code>NAs</code> unwanted
changes in the data, it is advisable to do a test before storing it, in
order to see if these changes will be originated. <code>NAs</code></p>
<ul>
<li>Create backup variables:</li>
</ul>
<p>o Sometimes when we are going to transform a variable it is best to
create a new one that stores the contents of the transformation. This
avoids the risk of losing information when transforming a variable.</p>
<ul>
<li>Be careful when storing:</li>
</ul>
<p>o Do not store accidentally transformed tables or objects.</p>
<p>o E.g. if we create a table to see if the variable changed as desired
and then reuse the code and add the assignment forward, we would store
the table and lose the information that the object had.</p>
</div>
<div class="section level3">
<h3 id="my-dataframe-changed-unexpectedly">My dataframe changed unexpectedly<a class="anchor" aria-label="anchor" href="#my-dataframe-changed-unexpectedly"></a>
</h3>
<p>When we have accidents with our data some options are:</p>
<ul>
<li><p>Check what the damage is and see if it is repairable. For
example, the wrong character was changed in a text string.</p></li>
<li><p>Load the data from a backup. If we have created backups of the
process we can avoid long processing times. Among these backups are the
backup variables or backup objects (see <a href="Banco_errores.html#prevencion">How to avoid
crashes?</a>).</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="use-of-the-function-rename">Use of the function <code>rename</code>
<a class="anchor" aria-label="anchor" href="#use-of-the-function-rename"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Call up the database</li>
</ol>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Use the pipe<code>%&gt;%</code> to link to the rename
function</p></li>
<li><p>Call the function<code>rename</code> and first type the new
column name and then the name of the pre-existing column you want to
rename</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">rename</span><span class="op">(</span>newname <span class="op">=</span> <span class="va">oldname</span><span class="op">)</span></span></code></pre>
</div>
<p>Select some rows of a data group</p>
<ol style="list-style-type: decimal">
<li>Call up the database</li>
</ol>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Use the pipe<code>%&gt;%</code> to link to the
<code>group_by</code>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">group_variable</span><span class="op">)</span></span></code></pre>
</div>
<p>The function <code>group_by</code> function will create groups of
data according to a given variable in which you can perform other
actions such as selecting the data in the header of each group.</p>
<ol start="4" style="list-style-type: decimal">
<li>Then use the function as in this example we could
use<code>head</code> only for the data in the header of each group.</li>
</ol>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="how-to-use-summarise">How to use <code>summarise</code>?<a class="anchor" aria-label="anchor" href="#how-to-use-summarise"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Call the database</li>
</ol>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Use the pipe<code>%&gt;%</code>to link to the
<code>summarise</code>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The summarise function cannot be used directly, so it must be used in
conjunction with an argument inside, for example:</p>
<ol style="list-style-type: lower-alpha">
<li>Get the average</li>
</ol>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Obtain the standard deviation</li>
</ol>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>This function can be used with pre-clustering (<code>group_by</code>)
to obtain these values for each group, for example,</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="group-related-errors-group_by-y-ungroup">Group-related errors (<code>group_by</code> y
<code>ungroup</code>)<a class="anchor" aria-label="anchor" href="#group-related-errors-group_by-y-ungroup"></a>
</h3>
<ul>
<li>A very frequent error is that the grouped object is stored
(<code>group_by</code>), since the ungrouping action was not performed
at the end. This can lead to errors such as incorrect calculations,
summaries per group instead of over the whole data, and problems when
performing subsequent operations on the dataset. Therefore, we recommend
always using (<code>ungroup</code>) before storing. To use
<code>ungroup()</code> just put it at the end.</li>
</ul>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">category</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">data_processing</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s look at an example of an error that can occur by not
ungrouping:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span>  </span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># For reproducibility  </span></span>
<span></span>
<span><span class="co"># Example dataframe  </span></span>
<span><span class="va">blood_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"O"</span>, <span class="st">"AB"</span><span class="op">)</span>  </span>
<span><span class="va">rh_factor</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span><span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>  </span>
<span><span class="va">heart_rate</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">60</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span><span class="va">resp_rate</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="fl">12</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">blood_type</span>, <span class="va">rh_factor</span>, <span class="va">day</span>, <span class="va">heart_rate</span>, <span class="va">resp_rate</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Summary by columns (without ungrouping)  </span></span>
<span><span class="va">by_day</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">blood_type</span>, <span class="va">rh_factor</span>, <span class="va">day</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>  </span>
<span>    hr_avg <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">heart_rate</span><span class="op">)</span>,  </span>
<span>    rr_avg <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">resp_rate</span><span class="op">)</span>  </span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>Let’s create a variable containing unique ids for each row.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">by_day</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 20 × 6
# Groups:   blood_type, rh_factor [8]
   blood_type rh_factor   day hr_avg rr_avg    id
   &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
 1 A          +             1   76.3   15.2     1
 2 A          +             3   81.5   16.6     2
 3 A          +             4   81.2   15.6     3
 4 A          +             5   81     15.9     4
 5 A          -             2   78.3   16.2     1
 6 AB         +             2   79.3   16       1
 7 AB         +             5   73.1   17.4     2
 8 AB         -             1   83     16.6     1
 9 AB         -             3   79.8   15       2
10 AB         -             4   84.8   17.4     3
11 B          +             2   77.8   16.4     1
12 B          +             5   83.8   14.6     2
13 B          -             1   74.5   14.9     1
14 B          -             3   85.1   16.2     2
15 B          -             4   83.3   16.6     3
16 O          +             1   80.3   15       1
17 O          +             3   78.9   14.8     2
18 O          +             4   81.2   14.9     3
19 O          +             5   84.9   15       4
20 O          -             2   80.7   16.1     1</code></pre>
</div>
<p>As you can see in the id column instead of unique identifiers we have
repeating ids. Why did this happen if each row is different?</p>
<p>The reason for this problem lies in the fact that the data is still
grouped together. Even if we do not directly apply
the<code>ungroup</code> as explained above, we can still solve it.</p>
<p>Let’s see how it would not be solved first. A common mistake when
trying to solve this problem is to apply the ungroup function without
storing the result.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># incorrect use of ungroup</span></span>
<span><span class="va">by_day</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 20 × 5
   blood_type rh_factor   day hr_avg rr_avg
   &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 A          +             1   76.3   15.2
 2 A          +             3   81.5   16.6
 3 A          +             4   81.2   15.6
 4 A          +             5   81     15.9
 5 A          -             2   78.3   16.2
 6 AB         +             2   79.3   16
 7 AB         +             5   73.1   17.4
 8 AB         -             1   83     16.6
 9 AB         -             3   79.8   15
10 AB         -             4   84.8   17.4
11 B          +             2   77.8   16.4
12 B          +             5   83.8   14.6
13 B          -             1   74.5   14.9
14 B          -             3   85.1   16.2
15 B          -             4   83.3   16.6
16 O          +             1   80.3   15
17 O          +             3   78.9   14.8
18 O          +             4   81.2   14.9
19 O          +             5   84.9   15
20 O          -             2   80.7   16.1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># although it ungroups the object for printing,</span></span>
<span><span class="co"># as long as the object is not stored, it will remain grouped</span></span>
<span></span>
<span><span class="va">by_day</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 20 × 6
# Groups:   blood_type, rh_factor [8]
   blood_type rh_factor   day hr_avg rr_avg    id
   &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
 1 A          +             1   76.3   15.2     1
 2 A          +             3   81.5   16.6     2
 3 A          +             4   81.2   15.6     3
 4 A          +             5   81     15.9     4
 5 A          -             2   78.3   16.2     1
 6 AB         +             2   79.3   16       1
 7 AB         +             5   73.1   17.4     2
 8 AB         -             1   83     16.6     1
 9 AB         -             3   79.8   15       2
10 AB         -             4   84.8   17.4     3
11 B          +             2   77.8   16.4     1
12 B          +             5   83.8   14.6     2
13 B          -             1   74.5   14.9     1
14 B          -             3   85.1   16.2     2
15 B          -             4   83.3   16.6     3
16 O          +             1   80.3   15       1
17 O          +             3   78.9   14.8     2
18 O          +             4   81.2   14.9     3
19 O          +             5   84.9   15       4
20 O          -             2   80.7   16.1     1</code></pre>
</div>
<p>As you can see the problem has not been corrected.</p>
<p>To correct it we can either include the <code>ungroup</code> from the
beginning when we create the object <code>por_dia</code> or apply the
change and save it to the object:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove grouping from by_day</span></span>
<span><span class="va">by_day_no_group</span> <span class="op">&lt;-</span> <span class="va">by_day</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Add an ID column with row numbers</span></span>
<span><span class="va">by_day_no_group</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 20 × 6
   blood_type rh_factor   day hr_avg rr_avg    id
   &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
 1 A          +             1   76.3   15.2     1
 2 A          +             3   81.5   16.6     2
 3 A          +             4   81.2   15.6     3
 4 A          +             5   81     15.9     4
 5 A          -             2   78.3   16.2     5
 6 AB         +             2   79.3   16       6
 7 AB         +             5   73.1   17.4     7
 8 AB         -             1   83     16.6     8
 9 AB         -             3   79.8   15       9
10 AB         -             4   84.8   17.4    10
11 B          +             2   77.8   16.4    11
12 B          +             5   83.8   14.6    12
13 B          -             1   74.5   14.9    13
14 B          -             3   85.1   16.2    14
15 B          -             4   83.3   16.6    15
16 O          +             1   80.3   15      16
17 O          +             3   78.9   14.8    17
18 O          +             4   81.2   14.9    18
19 O          +             5   84.9   15      19
20 O          -             2   80.7   16.1    20</code></pre>
</div>
<p>As you can see now if we have each row with its own id.</p>
<p>Note: It is important to clarify that the ungrouping in the previous
scenarios would go after the operation, however, in this case it would
go before the operation.</p>
</div>
<div class="section level3">
<h3 id="when-i-try-to-create-a-pdf-in-rmarkdown-i-get-the-error">When I try to create a pdf in RMarkdown I get the error<a class="anchor" aria-label="anchor" href="#when-i-try-to-create-a-pdf-in-rmarkdown-i-get-the-error"></a>
</h3>
<p>If the file comes out correctly in other formats except pdf. One of
the most frequent situations is that the LaTeX installation is missing:
RMarkdown needs LaTeX to generate PDFs. Make sure you have LaTeX
installed on your system.</p>
<p>To install LaTeX from RStudio, you can use the TinyTeX package:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"tinytex"</span><span class="op">)</span></span>
<span><span class="fu">tinytex</span><span class="fu">::</span><span class="fu">install_tinytex</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Configure RStudio:</p>
<p>Go to Tools &gt; Global Options &gt; Sweave.</p>
<p>Make sure that the “Typeset PDF” option is set to use TinyTeX.</p>
</div>
<div class="section level3">
<h3 id="additional-material-that-can-contribute-to-your-learning">Additional material that can contribute to your learning:<a class="anchor" aria-label="anchor" href="#additional-material-that-can-contribute-to-your-learning"></a>
</h3>
<p><strong>Data handling with Tidyverse and R:</strong></p>
<p><a href="https://www.youtube.com/watch?v=6STcQVX8Hk0" class="external-link uri">https://www.youtube.com/watch?v=6STcQVX8Hk0</a></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<p>In this document you will find some of the frequently asked questions
and errors in R code execution.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<hr class="half-width">
<ul>
<li><p>José M. Velasco-España: Initial version</p></li>
<li><p>Andree Valle-Campos: Minor editions</p></li>
<li><p>Laura Gómez-Bermeo: Minor Editions</p></li>
<li><p>Geraldine Gomez: Minor Editions</p></li>
<li><p>Hugo Gruson: Translation to english</p></li>
</ul>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/joskerus/EpiTKit-EN/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/joskerus/EpiTKit-EN/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/joskerus/EpiTKit-EN/" class="external-link">Source</a></p>
				<p><a href="https://github.com/joskerus/EpiTKit-EN/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:gomezblaura@javeriana.edu.co">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://joskerus.github.io/EpiTKit-EN/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://joskerus.github.io/EpiTKit-EN/aio.html",
  "identifier": "https://joskerus.github.io/EpiTKit-EN/aio.html",
  "dateCreated": "2024-06-04",
  "dateModified": "2025-06-19",
  "datePublished": "2025-06-19"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

