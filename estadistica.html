<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="es" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Curso en ciencia de datos en salud pública y modelamiento de enfermedades infecciosas: Statistics and Probability Unit</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epitkit/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/epitkit/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/epitkit/favicon-16x16.png"><link rel="manifest" href="favicons/epitkit/site.webmanifest"><link rel="mask-icon" href="favicons/epitkit/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epitkit"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Ir al contenido principal</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epitkit-logo" alt="epitkit" src="assets/images/epitkit-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="Esta lección se encuentra en la fase pre-alfa, lo que significa que está en las primeras etapas de desarrollo, pero aún no se ha enseñado.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alfa
            </a>
            <span class="visually-hidden">Esta lección se encuentra en la fase pre-alfa, lo que significa que está en las primeras etapas de desarrollo, pero aún no se ha enseñado.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vista de estudiante <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/estadistica.html';">Vista de la instructora</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epitkit" aria-label="Navegación principal"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Alternar navegación">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menú</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epitkit" src="assets/images/epitkit-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Curso en ciencia de datos en salud pública y modelamiento de enfermedades infecciosas
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Buscar en la página All In One" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Curso en ciencia de datos en salud pública y modelamiento de enfermedades infecciosas
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Puntos Clave</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glosario</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Perfiles de estudiante</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Más <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Glosario de términos</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Buscar en la página All In One"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Buscar en la página All In One">Buscar en la página All In One</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Curso en ciencia de datos en salud pública y modelamiento de enfermedades infecciosas
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 75%" class="percentage">
    75%
  </div>
  <div class="progress epitkit">
    <div class="progress-bar epitkit" role="progressbar" style="width: 75%" aria-valuenow="75" aria-label="Progreso de la lección" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="Cerrar menú" alt="Cerrar menú" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Cerrar " data-episodes="Episodios ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vista de estudiante
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/estadistica.html">Vista de la instructora</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODIOS
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Resumen y configuración</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="Taller-R-RStudio.html">1. Introducción a R y Rstudio</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="Visualizacion.html">2. Introduccion a la visualizacion de datos en R con ggplot2.</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Reporte.html">3. Reporte e informes tecnicos en R Markdown</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="limpieza.html">4. Limpieza de datos epidemiológicos</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="zika.html">5. Construyendo un modelo deterministico simple</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        6. Statistics and Probability Unit
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#before-you-start">Before you start</a></li>
<li><a href="#topic-2-descriptive-statistics"><strong>Topic 2: Descriptive Statistics</strong></a></li>
<li><a href="#topic-3-probability"><strong>Topic 3: Probability</strong></a></li>
<li><a href="#topic-4-principal-probability-distributions"><strong>Topic 4: Principal probability distributions</strong></a></li>
<li><a href="#topic-5-introduction-to-statistical-inference"><strong>Topic 5: Introduction to Statistical Inference</strong></a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="Banco_errores.html">7. Banco de preguntas y errores frecuentes</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RECURSOS
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Puntos Clave</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glosario</a>
                      </li>
                      <li>
                        <a href="profiles.html">Perfiles de estudiante</a>
                      </li>
                      <li><a href="reference.html">Glosario de términos</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">Todo en una sola página</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Capítulo previo y siguiente"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="zika.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previo</a>
        <a class="chapter-link float-end" href="Banco_errores.html">Siguiente<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="zika.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previo: Construyendo un
        </a>
        <a class="chapter-link float-end" href="Banco_errores.html" rel="next">
          Siguiente: Banco de preguntas y...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Statistics and Probability Unit</h1>
        <p>Última actualización: 2025-06-06 |

        <a href="https://github.com/epiverse-trace/epitkit/edit/main/episodes/estadistica.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul><li>How can statistics and probability be used to solve questions in
infectious disease epidemiology?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<p><strong>At the end of this workshop you will be able to:</strong></p>
<ul><li><p>Understand the role of statistics in the study of infectious
diseases.</p></li>
<li><p>Understand and use statistical measures to summarize and analyze
information.</p></li>
<li><p>Become familiar with the concept of a random variable and
recognize common probability distributions.</p></li>
<li><p>Learn how to approach a statistical problem as an inference
problem from a sample.</p></li>
<li><p>Understand the concept of confidence intervals for estimating
epidemiological parameters.</p></li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Pre requisito</h3>
<div class="callout-content">
<p>This unit is a supplement to the <strong><em>Introduction to
Infectious Disease Modelling for Public Health Course</em></strong></p>
</div>
</div>
</div>
<div id="table-of-contents" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="table-of-contents" class="callout-inner">
<h3 class="callout-title"><strong>Table of contents</strong></h3>
<div class="callout-content">
<table style="width:88%;" class="table"><colgroup><col width="87%"></colgroup><tbody><tr class="odd"><td>
<p>Topic 1: Introduction to Statistical Thinking (See in course
platform)</p>
<p>Topic 2: Descriptive Statistics (See complement on the course
platform)</p>
<p>Topic 3: Probability (See course platform add-on)</p>
<p>Topic 4: Principal Probability Distributions (See supplement on the
course platform)</p>
<p>Topic 5: Introduction to Statistical Inference (See complement on the
course platform)</p>
</td>
</tr></tbody></table></div>
</div>
</div>
<section><h2 class="section-heading" id="before-you-start">Before you start<a class="anchor" aria-label="anchor" href="#before-you-start"></a></h2>
<hr class="half-width"><p>Please check that you have installed the following libraries
<code>tidyverse, pak, epiparameter e infer</code> in case they are not
installed, run the code below according to your need:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To install the tidyverse package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To install the epiparameter package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"epiparameter"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"epiparameter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To install the epitools package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="va">epitools</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"epitools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To install the infer package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"infer"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"infer"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># To install the cfr package if you don't have it (or are unsure if you have it), run the following code</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw">require</span><span class="op">(</span><span class="st">"cfr"</span><span class="op">)</span><span class="op">)</span> <span class="fu">install.packages</span><span class="op">(</span><span class="st">"cfr"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">#Before start and eveytime that you start a session in R charge this libraries </span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epitools</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">infer</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span></span></code></pre>
</div>
<center>
<p><a href="https://epiverse-trace.github.io/epiverse-trace/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-2-descriptive-statistics"><strong>Topic 2: Descriptive Statistics</strong><a class="anchor" aria-label="anchor" href="#topic-2-descriptive-statistics"></a></h2>
<hr class="half-width"><p><strong>Exercise: Visualising and Analysing Data in R</strong></p>
<p>There are many graphs according to the type of scale of the variable
you want to analyse. Here are some examples to help you understand these
concepts.</p>
<ul><li><p>Please take into account that you have previously completed the
introductory unit on R and the data visualisation unit. The data table
for this exercise can be found in: <a href="https://raw.githubusercontent.com/epiverse-trace/translation-epitkit/refs/heads/main/data/sample_data.RDS" class="external-link uri">https://raw.githubusercontent.com/epiverse-trace/translation-epitkit/refs/heads/main/data/sample_data.RDS</a></p></li>
<li><p>Once you have the data downloaded to your computer and in the
data folder of your project you can execute the following
command:</p></li>
</ul><div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu">readRDS</span><span class="op">(</span><span class="st">"data/sample_data.RDS"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ADVERTENCIA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in gzfile(file, "rb"): cannot open compressed file
'data/sample_data.RDS', probable reason 'No such file or directory'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in gzfile(file, "rb"): cannot open the connection</code></pre>
</div>
<p><strong>Histogram and Boxplot</strong></p>
<p>The two most common types of graphs for visualising the distribution
of quantitative variables are histograms and boxplots.</p>
<p>The <strong>histograms</strong> allow you to visually describe the
distribution of data by grouping the data into intervals on the x-axis,
which are generally of equal size, and then for each interval describe
the absolute frequency, relative frequency or density on the y-axis. A
density histogram adjusts the relative frequency of each interval
according to the width of the interval. In R it can be constructed as
follows:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histogram with absolute frequency</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sample_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>color<span class="op">=</span><span class="st">"darkblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Absolute Frequency"</span>, x <span class="op">=</span> <span class="st">"Age in years"</span>,</span>
<span>     title <span class="op">=</span> <span class="st">"Age Distribution"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(sample_data, aes(x = age)): could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histogram with density</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sample_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 color <span class="op">=</span> <span class="st">"darkblue"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Density"</span>, x <span class="op">=</span> <span class="st">"Age in years"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Age Distribution"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(sample_data, aes(x = age)): could not find function "ggplot"</code></pre>
</div>
<p>The <strong>Boxplot</strong> are constructed by displaying the
following statistics horizontally or vertically:</p>
<ul><li><p>First quartile Q1 (25th percentile): Value below the 25th
percentile of the data. “First Line”.</p></li>
<li><p>Second quartile Q2 (50th percentile or median): Value that leaves
by below 50% of the data. “middle line”.</p></li>
<li>
<p>Third quartile Q3 (50th percentile or median): Value that leaves
by below 75% of the data. “Third Line”.</p>
<figure><img src="fig/boxplot.png" class="figure mx-auto d-block"></figure></li>
</ul><p>Additionally, these graphs are useful for detecting outliers by
setting a lower bound (Q1-1.5×RIQ) and an upper bound (Q3+1.5×RIQ) based
on RIQ=Q3-Q1. Data outside these limits are categorised as unusual and
should be reviewed. In the presence of outliers, the lines or whiskers
go to the lower or upper bounds, otherwise they go to the minimum and
maximum value, respectively.</p>
<p>Another usefulness of the <strong>boxplot</strong> and
<strong>histograms</strong> is that they help to know the shape of the
distribution in order to decide on the best indicator of central
tendency. In this way, a distribution can be symmetric or asymmetric
positive/negative. When symmetry exists, it is recommended to use the
mean accompanied by the standard deviation and otherwise the median and
the interquartile range because the mean can be influenced by the
extreme data of the distribution. Remember that an indicator of central
tendency must always be accompanied by a judge, i.e. its respective
indicator of variability.</p>
<figure><img src="fig/distribucion.png" class="figure mx-auto d-block"></figure><ul><li><p><strong>Explanatory legend A:</strong> In a symmetric
distribution, the mean, the mean, mode and median take the same value
and the data are found to be evenly distributed around the central
value. For this type of distributions, it is recommended to describe the
data series with mean and standard deviation.</p></li>
<li><p><strong>Explanatory legend B:</strong> Positive asymmetric
distribution or skewed to the right. This type of distribution is
characterised by a higher concentration of data towards the right.
minimum of the distribution, but some values are concentrated towards
the right. the maximum value of the distribution. The expected behaviour
is that the mean&gt;median&gt;moda, since the mean is influenced by the
positive extreme values of the distribution. It is recommended that to
describe the data by means of median and range. interquartile
range.</p></li>
<li><p><strong>Explanatory legend C:</strong> Negative skewed
distribution or skewed to the left. This type of distribution is
characterised by a higher concentration of data towards the left.
maximum of the distribution, but some values are concentrated towards
the minimum value of the distribution (values towards the left). The
expected behaviour is that the mode&gt;mean&gt;median&gt;median given
that this latter is influenced by the extreme values of the side
left-hand side. It is recommended to describe the data by median and
interquartile range.</p></li>
</ul><p>Next, we will visualise the age of the COVID-19 cases using a
boxplot.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Boxplot</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sample_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="st">" "</span>, y <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Age (in years)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">" "</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(sample_data, aes(x = " ", y = age)): could not find function "ggplot"</code></pre>
</div>
<p>According to the boxplot of the age of the sample of COVID-19 cases
it is possible to conclude that the distribution of the data is
positively skewed, since there is a greater closeness between the values
of Q1 and the median, so it is advisable to describe the behaviour of
the data by means of the median and interquartile range, this in R can
be found as follows using the functions highlighted in blue:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Descriptive Statistics Quantitative Variables   </span></span>
<span></span>
<span><span class="va">sample_data</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">summarise</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu">n</span> <span class="op">(</span><span class="op">)</span>, <span class="co"># Number of observations</span></span>
<span>  Mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="co"># Mean</span></span>
<span>  SD <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="co"># Standard deviation</span></span>
<span>  median <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.50</span><span class="op">)</span>, <span class="co"># median-50th percentile</span></span>
<span>  P25 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="co"># 25th percentile</span></span>
<span>  P75 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span> <span class="co"># 75th percentile</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in sample_data %&gt;% dplyr::summarise(n = n(), Mean = mean(age), SD = sd(age), : could not find function "%&gt;%"</code></pre>
</div>
<p>Finally, for the variable age it can be concluded that half of the
patients with covid-19 are aged between 27 and 52 years (“RIQ”) with a
median of 38 years, indicating that half of the cases have an age below
this value. It is important to note that, due to the skewness of the
distribution, the mean and median do not coincide, which is expected in
skewed distributions.</p>
<center>
<p><a href="https://epiverse-trace.github.io/epiverse-trace/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<p><strong>Bar Graphs and Frequency Tables</strong></p>
<p>Qualitative variables are recommended to be represented by bar
charts. Generally, these are constructed by indicating on the X axis the
categories of the variables and on the Y axis the value of the absolute,
relative or percentage frequencies according to the needs, i.e. it is
always necessary to first evaluate the frequency table of the variable.
Let us suppose that we want to know the type of infection of COVID-19.
This can be done in R using the following command:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Frequency Tables</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op">%&gt;%</span> <span class="co"># Frequency Table Created</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">type_of_contagion</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Frequency count for the state variable</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>prop <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">prop.table</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="co"># Proportion</span></span>
<span>                perc <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">prop.table</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Percentage</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in sample_data %&gt;% dplyr::count(type_of_contagion) %&gt;% dplyr::mutate(prop = base::prop.table(n), : could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function (..., exclude = if (useNA == "no") c(NA, NaN), useNA = c("no",
    "ifany", "always"), dnn = list.names(...), deparse.level = 1)
{
    list.names &lt;- function(...) {
        l &lt;- as.list(substitute(list(...)))[-1L]
        if (length(l) == 1L &amp;&amp; is.list(..1) &amp;&amp; !is.null(nm &lt;- names(..1)))
            return(nm)
        nm &lt;- names(l)
        fixup &lt;- if (is.null(nm))
            seq_along(l)
        else nm == ""
        dep &lt;- vapply(l[fixup], function(x) switch(deparse.level +
            1, "", if (is.symbol(x)) as.character(x) else "",
            deparse(x, nlines = 1)[1L]), "")
        if (is.null(nm))
            dep
        else {
            nm[fixup] &lt;- dep
            nm
        }
    }
    miss.use &lt;- missing(useNA)
    miss.exc &lt;- missing(exclude)
    useNA &lt;- if (miss.use &amp;&amp; !miss.exc &amp;&amp; !match(NA, exclude,
        nomatch = 0L))
        "ifany"
    else match.arg(useNA)
    doNA &lt;- useNA != "no"
    if (!miss.use &amp;&amp; !miss.exc &amp;&amp; doNA &amp;&amp; match(NA, exclude,
        nomatch = 0L))
        warning("'exclude' containing NA and 'useNA' != \"no\"' are a bit contradicting")
    args &lt;- list(...)
    if (length(args) == 1L &amp;&amp; is.list(args[[1L]])) {
        args &lt;- args[[1L]]
        if (length(dnn) != length(args))
            dnn &lt;- paste(dnn[1L], seq_along(args), sep = ".")
    }
    if (!length(args))
        stop("nothing to tabulate")
    bin &lt;- 0L
    lens &lt;- NULL
    dims &lt;- integer()
    pd &lt;- 1L
    dn &lt;- NULL
    for (a in args) {
        if (is.null(lens))
            lens &lt;- length(a)
        else if (length(a) != lens)
            stop("all arguments must have the same length")
        fact.a &lt;- is.factor(a)
        if (doNA)
            aNA &lt;- anyNA(a)
        if (!fact.a) {
            a0 &lt;- a
            op &lt;- options(warn = 2)
            on.exit(options(op))
            a &lt;- factor(a, exclude = exclude)
            options(op)
        }
        add.na &lt;- doNA
        if (add.na) {
            ifany &lt;- (useNA == "ifany")
            anNAc &lt;- anyNA(a)
            add.na &lt;- if (!ifany || anNAc) {
                ll &lt;- levels(a)
                if (add.ll &lt;- !anyNA(ll)) {
                  ll &lt;- c(ll, NA)
                  TRUE
                }
                else if (!ifany &amp;&amp; !anNAc)
                  FALSE
                else TRUE
            }
            else FALSE
        }
        if (add.na)
            a &lt;- factor(a, levels = ll, exclude = NULL)
        else ll &lt;- levels(a)
        a &lt;- as.integer(a)
        if (fact.a &amp;&amp; !miss.exc) {
            ll &lt;- ll[keep &lt;- which(match(ll, exclude, nomatch = 0L) ==
                0L)]
            a &lt;- match(a, keep)
        }
        else if (!fact.a &amp;&amp; add.na) {
            if (ifany &amp;&amp; !aNA &amp;&amp; add.ll) {
                ll &lt;- ll[!is.na(ll)]
                is.na(a) &lt;- match(a0, c(exclude, NA), nomatch = 0L) &gt;
                  0L
            }
            else {
                is.na(a) &lt;- match(a0, exclude, nomatch = 0L) &gt;
                  0L
            }
        }
        nl &lt;- length(ll)
        dims &lt;- c(dims, nl)
        if (prod(dims) &gt; .Machine$integer.max)
            stop("attempt to make a table with &gt;= 2^31 elements")
        dn &lt;- c(dn, list(ll))
        bin &lt;- bin + pd * (a - 1L)
        pd &lt;- pd * nl
    }
    names(dn) &lt;- dnn
    bin &lt;- bin[!is.na(bin)]
    if (length(bin))
        bin &lt;- bin + 1L
    y &lt;- array(tabulate(bin, pd), dims, dimnames = dn)
    class(y) &lt;- "table"
    y
}
&lt;bytecode: 0x5592f38ae3e0&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
<p>With this information it can be concluded that 70% of the covid-19
cases were from the community and only 0.06% were imported from
elsewhere. This can be visualised by means of a bar chart:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bar Graphs</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">table</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">type_of_contagion</span>, y <span class="op">=</span> <span class="va">perc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, color<span class="op">=</span><span class="st">"darkblue"</span>, fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"%"</span>, x <span class="op">=</span> <span class="st">" "</span>, title <span class="op">=</span> <span class="st">"Type of Contagion"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = table, aes(x = type_of_contagion, y = perc)): could not find function "ggplot"</code></pre>
</div>
<center>
<p><a href="https://epiverse-trace.github.io/epiverse-trace/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-3-probability"><strong>Topic 3: Probability</strong><a class="anchor" aria-label="anchor" href="#topic-3-probability"></a></h2>
<hr class="half-width"><p>In a study published in the NEJM in 2014 entitled “Ebola Virus
Disease in West Africa- The First 9 Months of the Epidemic and Forward
Projections” (<a href="https://www.nejm.org/doi/full/10.1056/NEJMoa1411100" class="external-link"><strong>DOI:
10.1056/NEJMoa1411100</strong></a>), described the clinical and
epidemiological characteristics of Ebola cases reported during the
epidemic that affected the countries of Guinea, Liberia, Nigeria and
Sierra Leone since December 2013. The study found that those over 44
years of age were more likely to die from the disease. Similar to the
referenced article, a comparable conclusion is reached if we perform an
equivalent calculation using measures of association seen in the General
Epidemiology Unit applied to infectious diseases, such as Relative Risks
(RR) of the Risk Ratio or Relative Risk (RR). For this, a 2x2 table can
be reconstructed, where the RR can be measured by the ratio between the
CFR of a group A (e.g., cases aged 45 years or older) and a group B
(e.g., cases aged 44 years or younger), where the CFR is the case
fatality risk (CFR).</p>
<p>Thus, we obtain that the risk of death in cases aged 45 years or
older is 1.20 times the risk of death in cases aged 44 years or younger,
with a 95% confidence interval of 1.13 to 1.27, and a p-value of less
than 0.01. To reproduce this calculation you can use
the<strong>epitools</strong> library as shown below.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the epitools package</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epitools</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Create a 2x2 contingency table with the given values</span></span>
<span><span class="va">table2x2</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">311</span>, <span class="fl">51</span>, <span class="fl">768</span>, <span class="fl">299</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Calculate the risk ratio using the contingency table</span></span>
<span><span class="fu">epitools</span><span class="fu">::</span><span class="fu">riskratio</span><span class="op">(</span><span class="va">table2x2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$data
          Outcome
Predictor  Disease1 Disease2 Total
  Exposed1      311      768  1079
  Exposed2       51      299   350
  Total         362     1067  1429

$measure
          risk ratio with 95% C.I.
Predictor  estimate    lower    upper
  Exposed1 1.000000       NA       NA
  Exposed2 1.200227 1.133086 1.271346

$p.value
          two-sided
Predictor    midp.exact fisher.exact   chi.square
  Exposed1           NA           NA           NA
  Exposed2 3.179312e-08 4.200177e-08 9.982161e-08

$correction
[1] FALSE

attr(,"method")
[1] "Unconditional MLE &amp; normal approximation (Wald) CI"</code></pre>
</div>
<p>An introduction to statistical inference and confidence intervals can
be found in Topic 5 of this Unit.</p>
<center>
<p><a href="https://epiverse-trace.github.io/epiverse-trace/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-4-principal-probability-distributions"><strong>Topic 4: Principal probability distributions</strong><a class="anchor" aria-label="anchor" href="#topic-4-principal-probability-distributions"></a></h2>
<hr class="half-width"><p>As described in Topic 3, probability studies the behaviour of random
phenomena “events”. In this process, the following are observed
<strong>random variables (v.a),</strong> usually denoted as
<strong>X</strong> which aim to assign a real number to each event that
can happen in the sample space.</p>
<p>For the explanation and examples of the main distributions, it is
important that you install and load the packages
<strong>epiparameter</strong> packages from Epiverse.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If you haven't loaded it yet, load the epiparameter library</span></span>
<span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span></code></pre>
</div>
<p><strong>Discrete Models</strong></p>
<p>The binomial distribution allows describing the probability of
occurrence of an event with two possible outcomes, success (p) or
failure (1-p), in a given number of independent trials n with constant
probability of success p. The random variable under study corresponds
to:</p>
<p>X: Number of successes in n trials</p>
<p>The binomial model can be useful to know the probability of observing
a given number of events (e.g. cases, deaths, re-infections) in a
population of size n under the assumption that the probability of the
event is constant. The binomial distribution depends on two parameters:
the probability of success p and the number of independent trials n.</p>
<p>If X has a binomial distribution then it is represented as follows:
X~Bin(n,p)</p>
<p>And its density function, mean, expectation and variance correspond
to:</p>
<p><span class="math inline">\(f(x)=P(X=x)=(n x )\)</span></p>
<p><span class="math inline">\(p^x (1-p)^{(n-x)}\)</span></p>
<p><span class="math inline">\(E(x)=np\)</span></p>
<p><span class="math inline">\(Var(x)=np(1-p)\)</span></p>
<p>Example: If a virus with an attack rate of 60% is introduced into a
community of 20 individuals, what is the probability that 10 or fewer
individuals are infected in this community?</p>
<p>Be <span class="math inline">\(X~Bin(n=20,p=0.60)\)</span> then the
following expression needs to be calculated:</p>
<p><span class="math inline">\(P(X≤10)=∑_(x=0)^10 (20 x ) 〖0.60〗^x
(1-0.60)^(20-x)\)</span></p>
<p>In R this can be calculated as follows:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the probability of success</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.60</span>  </span>
<span></span>
<span><span class="co"># Define the number of trials</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span>  </span>
<span></span>
<span><span class="co"># Define the number of successes we are analyzing</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span>  </span>
<span></span>
<span><span class="co"># Compute the cumulative probability of getting at most 'x' successes</span></span>
<span><span class="fu">pbinom</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">p</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.2446628</code></pre>
</div>
<p>Therefore, the probability of a maximum of 10 individuals becoming
infected is 24.5%.</p>
<p>On <a href="https://ben18785.shinyapps.io/distribution-zoo/" class="external-link">distribution-zoo</a>
you can view the complete distribution of the variable</p>
<p><span class="math inline">\(X~Bin(n=20,p=0.60)\)</span>. Thus, it can
be concluded that on average one would expect to find 12 infected in a
community of 20 individuals based on an attack rate of 60%.</p>
<figure><img src="fig/distribution-zoo.png" class="figure mx-auto d-block"></figure><p><strong>Poisson distribution</strong></p>
<p>The distribution of <em>Poisson distribution</em> distribution models
the behaviour of random variables describing the number of events,
“counts”, occurring in a fixed observation interval, e.g. time (number
of infections occurring in an hour, day, week, year, etc.), or area
(number of infections occurring in a municipality, hospital, etc.).</p>
<p>This distribution has a parameter called lambda (<span class="math inline">\(λ\)</span>), <span class="math inline">\(λ&gt;0\)</span> which describes the average number
of events occurring in the fixed observation interval. If <span class="math inline">\(X\)</span> has a Poisson distribution, then it is
represented as follows:</p>
<p><span class="math inline">\(X\)</span>~<span class="math inline">\(Poisson(λ)\)</span></p>
<p>Its density, expectation, mean and variance function corresponds
to:</p>
<p><span class="math inline">\(fx=P(X=x)=\frac{e^{-λ}λ^x}{x!},
x=0,1,2,..,\)</span></p>
<p><span class="math inline">\(E(x)=λ Var(x)=λ\)</span></p>
<p>In infectious diseases, the Poisson distribution can be used to model
the number of secondary cases generated by a primary case. In this
context, the parameter is a function of the effective number of
replication <strong>R</strong> which represents the average number of
secondary infections caused by each primary case over time in a
population composed of susceptible and non-susceptible individuals.</p>
<p>:::: challenge <span class="math display">\[**Example**\]</span>{.underline}</p>
<p>Suppose one wishes to study the propagation of an outbreak based on a
Poisson model as days (t) elapse. The random variable of interest
is:</p>
<p><span class="math inline">\(X_{(t )}\)</span> Number of secondary
cases caused by each primary case on day t</p>
<p>This is a Poisson model since there is a fixed observation interval
“each primary case” and one wishes to study the number of observed
secondary cases “events”. Thus, the following model could be
constructed:</p>
<p><span class="math inline">\(X_{(t )}∼Poisson (λ= R
X_{(t-1)})\)</span></p>
<p>The above expresses that the average number of secondary cases on day
t depends on the number of reproduction <span class="math inline">\(R\)</span> and the number of observed cases <span class="math inline">\(X\)</span> on the previous day <span class="math inline">\((t-1)\)</span>. However, R is difficult to know in
real life and it may be of interest to approximate its value based on
data observed during the outbreak in order to generate control
strategies.</p>
<p>Let us assume that on day 1 of the outbreak <span class="math inline">\((t=1)\)</span> a total of 5 new cases occurred on
day 1 of the outbreak and that on the following day <span class="math inline">\((t=2)\)</span> 10 new cases occurred on the
following day. With the above information we are interested in studying
the number of secondary cases on day 2, which is equivalent to:</p>
<p><span class="math inline">\(X_{(2 )}\)</span> Number of secondary
cases caused by each primary case on Day 2</p>
<p>Which has the following distribution:</p>
<p><span class="math inline">\(X_{(2 )}∼Poisson (λ= R *5)\)</span></p>
<p>From this, we could estimate the value of <span class="math inline">\(R\)</span> by finding out which value maximises
the probability of observing this specific number of secondary cases on
day 2, i.e:</p>
<p><span class="math inline">\(P(X_{(2 )}=10)=\frac{e^{-(R *5)} (R
*5)^{10}}{10!}\)</span></p>
<p><strong>In R we could find this out by varying different values of
the number of reproduction number (R) as follows:</strong></p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Poisson probability calculation function</span></span>
<span><span class="va">poisson_probability</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">r</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">dpois</span><span class="op">(</span><span class="va">x2</span>, <span class="va">r</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># Input values</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">reproduction_numbers</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Calculate probabilities</span></span>
<span><span class="va">poisson_results</span> <span class="op">&lt;-</span> <span class="fu">poisson_probability</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">reproduction_numbers</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create dataframe for ggplot</span></span>
<span><span class="va">results_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">reproduction_numbers</span>, <span class="va">poisson_results</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Find the most probable reproduction number</span></span>
<span><span class="va">most_probable_number</span> <span class="op">&lt;-</span> <span class="va">results_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">poisson_results</span> <span class="op">==</span> <span class="fu">max</span><span class="op">(</span><span class="va">poisson_results</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">reproduction_numbers</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in results_data %&gt;% filter(poisson_results == max(poisson_results)) %&gt;% : could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the plot with ggplot2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">results_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">reproduction_numbers</span>, y <span class="op">=</span> <span class="va">poisson_results</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">most_probable_number</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability"</span>, x <span class="op">=</span> <span class="st">"Reproduction Number (R)"</span>, title <span class="op">=</span> <span class="st">"Poisson Model"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(results_data, aes(x = reproduction_numbers, y = poisson_results)): could not find function "ggplot"</code></pre>
</div>
<p>Therefore, if the number of secondary cases behaves according to a
Poisson distribution, there is a high probability that the number of new
cases observed on day 2 were generated with a reproduction number of
R=2. This implies that the average number of secondary cases per primary
case is 2. However, this simple model assumes that the number of
secondary cases generated by each primary case have equal mean and
variance, implying that all primary cases generate on average a similar
number of secondary cases. This assumption may be difficult to make for
some infectious diseases especially when they follow a pattern of
overdispersion (20% of cases cause 80% of transmission) so the Poisson
model has limitations in its application. :::</p>
<p><strong>Negative Binomial Distribution</strong></p>
<p>Like the Poisson distribution, the negative binomial distribution
allows one to model the number of events that occur “counts”. If <span class="math inline">\(X\)</span> has a Negative Binomial distribution,
then it is represented as follows.</p>
<p>$X <span class="math inline">\(~\)</span> BN(μ,k)$</p>
<p>where, <span class="math inline">\(μ\)</span> represents the mean of
the distribution and <span class="math inline">\(k\)</span> is the
dispersion parameter that allows the mean and variance of the events not
to be equal. This parameter <span class="math inline">\(k\)</span>
allows the degree of dispersion in how events are generated to be
introduced to the model. Thus, <span class="math inline">\(k\)</span>
inversely measures the degree of variation of the events that occur
given that the mean and variance of the distribution correspond to:</p>
<p><span class="math inline">\(E(x)=μ\)</span></p>
<p><span class="math inline">\(Var(x)=μ(1+\frac{μ}{k})\)</span></p>
<p>With density function:</p>
<p><span class="math inline">\(f(x)=\frac{Γ(x+k)}{Γ(k)Γ(x+1)}
(\frac{μ}{μ+k})^x (\frac{k}{μ+k})^k,x=0,1,2...\)</span></p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p><span class="math display">\[**Example**\]</span>{.underline}</p>
<p>In the study of infectious diseases, the negative binomial
distribution plays a relevant role since it allows modelling the
distribution of the number of secondary cases generated by a primary
case, i.e. it allows knowing the distribution of the basic reproduction
number R_0. In this context, the mean of the distribution corresponds to
<span class="math inline">\(R_0\)</span>(Number of secondary cases in a
fully susceptible population) and the parameter <span class="math inline">\(k\)</span> controls for the variation among
primary cases. Thus, small values of k suggest that secondary cases are
generated by a small group of primary cases, while large values suggest
that the spread of the virus is high. Thus, being <span class="math inline">\(X\)</span> the number of secondary cases, then</p>
<p><span class="math inline">\(X \sim Bn(R_0,k)\)</span></p>
<p><span class="math inline">\(E(x)=R_0\)</span></p>
<p><span class="math inline">\(Var(x)=R_0 (\frac{1+R_0}{k})\)</span></p>
<p>The paper by Lloyd-Smith et al. shows how the negative binomial
distribution allows modelling the distribution of secondary cases of
various pathogens. Based on the cases reported during the SARS outbreak
in Singapore in 2023, they estimated the parameters of the negative
binomial distribution and found a <span class="math inline">\(R_0=1.630\)</span> y <span class="math inline">\(k=0.160\)</span>. These estimates are available in
the <code>epiparameter</code> which is a package available at
<code>R</code> which compiles the main estimates for several
epidemiological parameters of interest in the study of infectious
diseases.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for SARS</span></span>
<span><span class="va">SARS_R</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>    disease <span class="op">=</span> <span class="st">"SARS"</span>,  <span class="co"># Specify the disease as SARS</span></span>
<span>    epi_name <span class="op">=</span> <span class="st">"offspring distribution"</span>,  <span class="co"># Select the epidemiological parameter: offspring distribution</span></span>
<span>    single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Lloyd-Smith J, Schreiber S, Kopp P, Getz W (2005). "Superspreading and
the effect of individual variation on disease emergence." _Nature_.
doi:10.1038/nature04153 &lt;https://doi.org/10.1038/nature04153&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved data</span></span>
<span><span class="va">SARS_R</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: SARS
Pathogen: SARS-Cov-1
Epi Parameter: offspring distribution
Study: Lloyd-Smith J, Schreiber S, Kopp P, Getz W (2005). "Superspreading and
the effect of individual variation on disease emergence." _Nature_.
doi:10.1038/nature04153 &lt;https://doi.org/10.1038/nature04153&gt;.
Distribution: nbinom (No units)
Parameters:
  mean: 1.630
  dispersion: 0.160</code></pre>
</div>
<p>With these results it would be possible to plot the distribution of
the number of secondary SARS cases in order to suggest control measures.
This is also available in the <code>epiparameter</code> with the
function <code>plot</code>.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved epidemiological parameter for SARS</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">SARS_R</span><span class="op">)</span>  </span></code></pre>
</div>
<figure><img src="fig/estadistica-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Finally, it is possible to conclude that most cases infected with
SARS do not spread the disease since the mode of the distribution is
<span class="math inline">\(0\)</span>. This result is expected given
that <span class="math inline">\(k&lt;1\)</span> indicating that the
secondary cases are generated by a small group of infected people and
that the estimated value of <span class="math inline">\(R_0\)</span>
varies for the cases.</p>
</div>
</div>
</div>
<p><strong>Geometric distribution</strong></p>
<p>Another discrete distribution of interest that can be used to model
counts or number of events is the geometric distribution. In infectious
diseases its main use arises when the dispersion parameter of the
negative distribution is equal to 1. This distribution depends on the
probability of occurrence of the event of interest and is represented as
follows.</p>
<p><span class="math inline">\(X \sim Geom(p)\)</span></p>
<p>where p represents the probability of success or the probability of
occurrence of the event of interest with mean equal to:</p>
<p><span class="math inline">\(E(x)=\frac{1}{p}\)</span></p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>If in the case of the SARS outbreak in Singapore in the year 2023,
the estimated value of <span class="math inline">\(k\)</span> would have
been <span class="math inline">\(1\)</span> then the distribution of
secondary cases could be modelled with a geometric distribution such
that its mean is equal to the <span class="math inline">\(R_0\)</span>
estimate, i.e. it must be satisfied that:</p>
<p><span class="math inline">\(E(x)=\frac{1}{p}=1.630\)</span> and
therefore, <span class="math inline">\(p=\frac{1}{1.630}\)</span></p>
<p>So the distribution of the number of secondary contacts could be
written as:</p>
<p><span class="math inline">\(X \sim Geom(p=0.613)\)</span></p>
<p>In R we could simulate the behaviour of the number of secondary cases
with the following code:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geometric Distribution</span></span>
<span></span>
<span><span class="co"># Create a sequence of values from 0 to 20 representing different R values</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Define the probability parameter for the geometric distribution</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">1.630</span>  </span>
<span></span>
<span><span class="co"># Create a data frame with the values of x and their corresponding geometric probabilities</span></span>
<span><span class="va">data_geom</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">x</span>, probg <span class="op">=</span> <span class="fu">dgeom</span><span class="op">(</span><span class="va">x</span>, <span class="va">prob</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Plot the geometric distribution using ggplot2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_geom</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">probg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Use a bar plot to visualize the probability distribution</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability"</span>, x <span class="op">=</span> <span class="st">"Secondary cases"</span>, title <span class="op">=</span> <span class="st">"Geometric Distribution"</span><span class="op">)</span>  <span class="co"># Add labels and title</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = data_geom, aes(x = x, y = probg)): could not find function "ggplot"</code></pre>
</div>
<p>Under the geometric distribution, then there is a higher probability
that a primary case can transmit the virus since the probability of a
primary case generating 1,2, or more secondary cases is higher with this
model than estimated with the negative binomial model.</p>
</div>
</div>
</div>
<p><strong>Continuous Models</strong></p>
<p><strong>Uniform Distribution</strong></p>
<p>The uniform distribution models a continuous variable that takes
values within an interval. $ [a,b] $ with equal probability. This
distribution is often used in the simulation of random numbers. If <span class="math inline">\(X\)</span> follows a uniform distribution, this
can be represented by:</p>
<p><span class="math inline">\(X ∼U(a,b)\)</span></p>
<p>Its parameters a and b, represent the minimum and maximum value that
the variable can take, respectively. Its density function is determined
by:</p>
<p><span class="math inline">\(f(x)=\frac{1}{b-a}\)</span>,with <span class="math inline">\(a&lt;x&lt;b\)</span></p>
<p>The mean and variance is determined by:</p>
<p><span class="math inline">\(E(x)=\frac{a+b}{2}\)</span> y <span class="math inline">\(V(x)=\frac{(b-a)^2}{12}\)</span></p>
<div id="discussion3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>A researcher wants to simulate the behaviour of COVID-19 and needs to
randomly generate the value that the basic reproduction number can take.
<span class="math inline">\(R_0\)</span> and then use it within his
propagation model. For this, he assumes that the <span class="math inline">\(R_0\)</span> of COVID-19 follows a uniform
distribution between 2 and 5:</p>
<p>$R0∼U [2,5] $</p>
<p>For your simulation you need to generate five possible values of
<span class="math inline">\(R_0\)</span> with equal probability, this in
<code>R</code> is solved using the following code:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generation of random numbers with a uniform distribution</span></span>
<span></span>
<span><span class="co"># Define the number of random values to generate</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>  </span>
<span></span>
<span><span class="co"># Set the lower and upper bounds of the uniform distribution</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">2</span>  </span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">5</span>  </span>
<span></span>
<span><span class="co"># Generate 'n' random numbers uniformly distributed between 'a' and 'b'</span></span>
<span><span class="fu">runif</span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.031104 2.735529 3.672220 2.138861 3.071192</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Normal Distribution</strong></p>
<p>The normal distribution is undoubtedly the most important
probabilistic model in statistical theory because of its ability to
model many real-life problems and its relevant role in the field of
inference. This distribution attempts to model random variables that can
be influenced by multiple factors, whose effects when added together
make the values of the distribution tend towards the centre (mean). For
example, body temperature may follow a normal distribution because it is
influenced by multiple biological and environmental factors, which when
added together cause most individuals to lie around a central value.</p>
<p>To express mathematically that a continuous variable has a normal
distribution, we write:</p>
<p><span class="math inline">\(X ∼N(μ,σ)\)</span></p>
<p>Which will have the following probability density function associated
with it:</p>
<p>$f(x)=exp [-frac{1}{2 σ<sup>2}(x-u)</sup>2] $</p>
<p>Where <span class="math inline">\(μ\)</span> y <span class="math inline">\(σ\)</span> are the parameters of the distribution
and represent respectively the mean and the standard deviation of the
random variable, i.e. the central value and the dispersion of the data
with respect to it. These parameters correspond to the values that would
be obtained if the entire population rather than a sample of the
population could be studied.</p>
<p>When <span class="math inline">\(μ=0\)</span> y <span class="math inline">\(σ=1\)</span> is called <strong>normal distribution
standard</strong>. However, there are many normal distributions
according to the values taken by their parameters, but regardless of the
value of the parameters, the shape of the distribution is always
<strong>symmetric</strong> and can always be transformed to a standard
normal distribution by means of a standardisation procedure applying the
following formula:</p>
<p><span class="math inline">\(Z=\frac{X-μ}{σ}∼N(0,1)\)</span></p>
<div id="discussion4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p><strong>Example</strong>,</p>
<p>If it is known that in a community the age of the cases that died
from COVID-19 has a normal distribution with mean 67.8 and standard
deviation 15.4 years. What is the probability that a deceased is younger
than 40 years old?</p>
<p>First, we define the variable to be studied, which has a normal
distribution.</p>
<p><span class="math inline">\(X∼N(67.8,15.4)\)</span></p>
<p><span class="math inline">\(X\)</span> Age of deceased COVID-19
cases</p>
<p>In R, we can use the function <code>pnorm()</code> function as
follows to find:</p>
<p><span class="math inline">\(P(X&lt;40)=?\)</span></p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the mean of the normal distribution</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">67.8</span></span>
<span><span class="co"># Define the standard deviation of the normal distribution</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">15.4</span></span>
<span><span class="co"># Define the value for which we want to compute the cumulative probability</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="co"># Compute the cumulative probability </span></span>
<span><span class="fu">pnorm</span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.0355221</code></pre>
</div>
<p>Therefore, the probability of a COVID-19 fatality being under the age
of 40 is 3.5%.</p>
</div>
</div>
</div>
<p><strong>Log-normal distribution</strong></p>
<p>The log-normal distribution arises when considering continuous random
variables that do not take the value of zero or negative numbers whose
distribution has an asymmetric shape and whose variation is generated by
multiple factors whose effects are not symmetric. If an a.v. follows a
lognormal distribution, its transformation by applying the logarithm
function will generate a normal variable and hence its name. In the
field of infectious diseases, the log-normal distribution is very useful
for modelling incubation periods (time from infection to onset of
symptoms).</p>
<p>If <span class="math inline">\(X ∼LogN(μ,σ)\)</span> then it holds
that <span class="math inline">\(Y=log (X) ∼N(μ,σ)\)</span> and the
density function of <span class="math inline">\(X\)</span> is given
by:</p>
<p><span class="math inline">\(f(x)=\frac{1}{
xσ\sqrt{2\pi}}e^{-\frac{1}{2}(\frac{ln(x)-u}{σ})^2}\)</span></p>
<p>Unlike the normal distribution, in the log-normal distribution the
parameter μ plays the role of a scaling parameter since it increases the
dispersion of the data by increasing its degree of amplitude and the
parameter σ controls the shape, i.e. the degree of skewness.</p>
<div id="discussion5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>In the 2009 paper by Lessler et al. the incubation periods of several
pathogens were modelled based on a lognormal distribution. The main
interest was to estimate the parameters of <span class="math inline">\((μ,σ)\)</span>. For example, in the case of SARS,
an estimate was found of <span class="math inline">\(μ=0.660\)</span>, y
<span class="math inline">\(σ=1.205\)</span> which implies that on
average an infected case develops symptoms in 0.7 days. This information
can be obtained in the epiparameter package with the following
command:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for the incubation period of SARS</span></span>
<span><span class="va">SARS_incubation</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>  disease <span class="op">=</span> <span class="st">"SARS"</span>,  <span class="co"># Specify the disease as SARS</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"incubation period"</span>,  <span class="co"># Select the epidemiological parameter: incubation period</span></span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Lessler J, Reich N, Brookmeyer R, Perl T, Nelson K, Cummings D (2009).
"Incubation periods of acute respiratory viral infections: a systematic
review." _The Lancet Infectious Diseases_.
doi:10.1016/S1473-3099(09)70069-8
&lt;https://doi.org/10.1016/S1473-3099%2809%2970069-8&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved incubation period data</span></span>
<span><span class="va">SARS_incubation</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: SARS
Pathogen: SARS-Cov-1
Epi Parameter: incubation period
Study: Lessler J, Reich N, Brookmeyer R, Perl T, Nelson K, Cummings D (2009).
"Incubation periods of acute respiratory viral infections: a systematic
review." _The Lancet Infectious Diseases_.
doi:10.1016/S1473-3099(09)70069-8
&lt;https://doi.org/10.1016/S1473-3099%2809%2970069-8&gt;.
Distribution: lnorm (days)
Parameters:
  meanlog: 1.386
  sdlog: 0.593</code></pre>
</div>
<p>The complete incubation period distribution for SARS can be plotted
by means of:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved epidemiological parameter for SARS</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">SARS_incubation</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/estadistica-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The above is useful for answering questions such as: What is the
probability that a SARS case will develop symptoms two days after
infection?</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the complementary cumulative probability (P(X &gt; 2)) for a lognormal distribution</span></span>
<span></span>
<span><span class="fu">stats</span><span class="fu">::</span><span class="fu">plnorm</span><span class="op">(</span><span class="fl">2</span>, meanlog <span class="op">=</span> <span class="fl">0.660</span>, sdlog <span class="op">=</span> <span class="fl">1.205</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4890273</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Gamma distribution</strong></p>
<p>When we are studying Poisson random variables, we are usually
interested in studying the number of events that occur with mean <span class="math inline">\(λ\)</span> for a defined time interval. The Gamma
distribution focuses on studying the v.a <span class="math inline">\(X\)</span>: the time it takes for a given number
of events to occur. <span class="math inline">\(α^th\)</span>. For
example, if we are evaluating the number of infections per hour and we
want to study how much time can elapse until we find α infections,
graphically <span class="math inline">\(X\)</span> corresponds to:</p>
<figure><img src="fig/gamma.png" class="figure mx-auto d-block"></figure><p>The Gamma distribution is widely used in survival analysis due to its
flexibility given by its shape parameters. <span class="math inline">\(α\)</span> and scale <span class="math inline">\(θ\)</span> which determine its density function,
which has an asymmetric behaviour. Here, <span class="math inline">\(θ\)</span> represent the average waiting time
until the first event occurs, and <span class="math inline">\(α\)</span>
is the number of events expected to occur. This distribution is denoted
as follows:</p>
<p><span class="math inline">\(X ∼Gamma(α,θ)\)</span></p>
<p><span class="math inline">\(f(x)=\frac{1}{(α-1)!θ^α}e^{\frac{-x}{θ}}
x^{α-1}\)</span></p>
<p><span class="math inline">\(E(x)=αθ\)</span></p>
<p><span class="math inline">\(Var(x)=αθ^2\)</span></p>
<p>When <span class="math inline">\(θ\)</span> value increases, the
concentration of the probability shifts to the right, the same is true
when expecting a higher number of events. <span class="math inline">\(α\)</span> given that the waiting time <span class="math inline">\(X\)</span> can be longer.</p>
<p>:::: challenge <strong>Example</strong></p>
<p>One possible application of the Gamma distribution is in modelling
the serial interval of infectious diseases. The serial interval (s) is
defined as the time between the onset of symptoms of the primary case
and the onset of symptoms of the secondary case. In the study by Ghani
et al. the serial interval distribution of influenza was described as
follows <em>Influenza-A-H1N1Pdm</em> by means of the gamma distribution
and found the following parameters:</p>
<p><span class="math inline">\(s ∼Gamma( α=2.622,θ=0.957)\)</span></p>
<p>This information can also be obtained from the package
<code>epiparameter</code> with the following command:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for the serial interval of Influenza</span></span>
<span><span class="va">influenza_s</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>  disease <span class="op">=</span> <span class="st">"Influenza"</span>,  <span class="co"># Specify the disease as Influenza</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial_interval"</span>,  <span class="co"># Select the epidemiological parameter: serial interval</span></span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Ghani A, Baguelin M, Griffin J, Flasche S, van Hoek A, Cauchemez S,
Donnelly C, Robertson C, White M, Truscott J, Fraser C, Garske T, White
P, Leach S, Hall I, Jenkins H, Ferguson N, Cooper B (2009). "The Early
Transmission Dynamics of H1N1pdm Influenza in the United Kingdom."
_PLoS Currents_. doi:10.1371/currents.RRN1130
&lt;https://doi.org/10.1371/currents.RRN1130&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved serial interval data</span></span>
<span><span class="va">influenza_s</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H1N1Pdm
Epi Parameter: serial interval
Study: Ghani A, Baguelin M, Griffin J, Flasche S, van Hoek A, Cauchemez S,
Donnelly C, Robertson C, White M, Truscott J, Fraser C, Garske T, White
P, Leach S, Hall I, Jenkins H, Ferguson N, Cooper B (2009). "The Early
Transmission Dynamics of H1N1pdm Influenza in the United Kingdom."
_PLoS Currents_. doi:10.1371/currents.RRN1130
&lt;https://doi.org/10.1371/currents.RRN1130&gt;.
Distribution: gamma (days)
Parameters:
  shape: 2.622
  scale: 0.957</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved epidemiological parameter for influenza</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">influenza_s</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/estadistica-rendered-unnamed-chunk-22-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>With this information the mean and standard deviation of the
distribution could be found based on the application of the gamma
distribution:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the shape and scale parameters</span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">2.622</span>  </span>
<span><span class="va">scale</span> <span class="op">&lt;-</span> <span class="fl">0.957</span>  </span>
<span></span>
<span><span class="co"># Calculate the mean of the distribution</span></span>
<span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="va">shape</span> <span class="op">*</span> <span class="va">scale</span>  </span>
<span></span>
<span><span class="co"># Calculate the standard deviation of the distribution</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">shape</span> <span class="op">*</span> <span class="va">scale</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Print the computed mean and standard deviation</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.509254 1.549631</code></pre>
</div>
<p>Therefore, the mean of the influenza serial interval is 5.51 days
with a standard deviation of 1.55 days. :::</p>
<p><strong>Weibull distribution</strong></p>
<p>Like the Gamma distribution, the Weibull distribution is useful in
the analysis of v.a.s representing waiting times until a particular
event is observed. The Weibull distribution has two parameters and its
density function is defined by:</p>
<p><span class="math inline">\(f(x)=
\frac{β}{η}(\frac{x}{η})^{β-1}{e^{-(x/η)}}^β\)</span></p>
<p>Here, <span class="math inline">\(η\)</span> is the scale parameter
and <span class="math inline">\(β\)</span> the shape parameter. The
shape parameter <span class="math inline">\(β\)</span> is also known as
slope and attempts to model the relationship between probability and
lead times. Thus when <span class="math inline">\(β&gt;1\)</span> the
rate of occurrence of events increases over time, while if <span class="math inline">\(β&lt;1\)</span> describes that the risk of the
event decreases over time. The scale parameter handles the degree of
variability of the distribution and is found in the same units of <span class="math inline">\(X\)</span>.</p>
<p>:::: challenge <strong>Example</strong></p>
<p>The study by Virlogeux et al. described the distribution of the
incubation time of influenza using the Weibull distribution and found
the following parameters:</p>
<p><span class="math inline">\(x∼Gamma( β=2.101,η=3.839)\)</span></p>
<p>This information can also be obtained in the epiparameter package
with the following command:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve epidemiological parameter data for the incubation period of Influenza</span></span>
<span><span class="va">influenza_incubation</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>  </span>
<span>  disease <span class="op">=</span> <span class="st">"Influenza"</span>,  <span class="co"># Specify the disease as Influenza</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"incubation period"</span>,  <span class="co"># Select the epidemiological parameter: incubation period</span></span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Request a single epidemiological parameter</span></span>
<span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Virlogeux V, Li M, Tsang T, Feng L, Fang V, Jiang H, Wu P, Zheng J, Lau
E, Cao Y, Qin Y, Liao Q, Yu H, Cowling B (2015). "Estimating the
Distribution of the Incubation Periods of Human Avian Influenza A(H7N9)
Virus Infections." _American Journal of Epidemiology_.
doi:10.1093/aje/kwv115 &lt;https://doi.org/10.1093/aje/kwv115&gt;..
To retrieve the citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the retrieved incubation period data</span></span>
<span><span class="va">influenza_incubation</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H7N9
Epi Parameter: incubation period
Study: Virlogeux V, Li M, Tsang T, Feng L, Fang V, Jiang H, Wu P, Zheng J, Lau
E, Cao Y, Qin Y, Liao Q, Yu H, Cowling B (2015). "Estimating the
Distribution of the Incubation Periods of Human Avian Influenza A(H7N9)
Virus Infections." _American Journal of Epidemiology_.
doi:10.1093/aje/kwv115 &lt;https://doi.org/10.1093/aje/kwv115&gt;.
Distribution: weibull (days)
Parameters:
  shape: 2.101
  scale: 3.839</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the retrieved incubation period data</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">influenza_incubacion</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'influenza_incubacion' not found</code></pre>
</div>
<p>:::</p>
<center>
<p><a href="https://epiverse-trace.github.io/epiverse-trace/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="topic-5-introduction-to-statistical-inference"><strong>Topic 5: Introduction to Statistical Inference</strong><a class="anchor" aria-label="anchor" href="#topic-5-introduction-to-statistical-inference"></a></h2>
<hr class="half-width"><p>Statistics can be divided into two main branches: descriptive and
inferential. As we saw in previous units, the former commonly seeks to
summarise and explore data that have been collected from a selected
sample of a population. In contrast, the second aims to make
generalisations and conclusions about the whole population based on the
information or data from a sample.</p>
<p>By the nature of the inferential process, which is based on taking
random samples from the population, an estimator can take multiple
values since it depends on the units that were selected in the sample.
This variation due to chance, called<strong>variation sampling
variation</strong> must be involved in the inference process as we will
see below.</p>
<p>It is important to stress that sampling variation will depend on the
sample size. For example, if we take samples of size 10 and calculate
the CFR in each of them, these estimates will be more similar to each
other compared to those obtained when only 5 individuals per sample are
selected. This can be tested by running a simulation in R and selecting
1000 samples of size 5 and 10, respectively. As can be seen in the
figure below, the estimated CFRs when increasing the sample size from 5
to 10 were more similar with a lower RIQ.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the random seed for reproducibility</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Create the population data frame with death indicators (1 = dead, 0 = alive)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>dead <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">160</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Sample with size 5: Draw 100 random samples of size 5 (without replacement)</span></span>
<span><span class="va">samples_n5</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">rep_sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, reps <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in population %&gt;% rep_sample_n(size = 5, reps = 100, replace = FALSE): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the Case Fatality Ratio (CFR) for each replicate in the sample size 5</span></span>
<span><span class="va">cfr_n5</span> <span class="op">&lt;-</span> <span class="va">samples_n5</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>cfr <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">dead</span><span class="op">)</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in samples_n5 %&gt;% group_by(replicate) %&gt;% summarise(cfr = mean(dead)): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample with size 10: Draw 100 random samples of size 10 (without replacement)</span></span>
<span><span class="va">samples_n10</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">rep_sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, reps <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in population %&gt;% rep_sample_n(size = 10, reps = 100, replace = FALSE): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the Case Fatality Ratio (CFR) for each replicate in the sample size 10</span></span>
<span><span class="va">cfr_n10</span> <span class="op">&lt;-</span> <span class="va">samples_n10</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>cfr <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">dead</span><span class="op">)</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in samples_n10 %&gt;% group_by(replicate) %&gt;% summarise(cfr = mean(dead)): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the results from both sample sizes (5 and 10)</span></span>
<span><span class="va">cfr</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cfr_n5</span>, <span class="va">cfr_n10</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>size <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in bind_rows(cfr_n5, cfr_n10) %&gt;% mutate(size = factor(c(rep(5, : could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the sampling distribution of CFR estimates using a boxplot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cfr</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">size</span>, y <span class="op">=</span> <span class="va">cfr</span>, fill <span class="op">=</span> <span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Create a boxplot without legend</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample size"</span>, y <span class="op">=</span> <span class="st">"CFR estimate"</span>,  </span>
<span>       title <span class="op">=</span> <span class="st">"Sampling Distribution of CFR Estimates"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add labels and title</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Blues"</span><span class="op">)</span>  <span class="co"># Use a blue color palette for visualization</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(cfr, aes(x = size, y = cfr, fill = size)): could not find function "ggplot"</code></pre>
</div>
<p>If we calculate the mean and standard deviation of the estimated
values of the CFR with the samples of size 5 and size 10, we see that
indeed the standard deviation of the estimates is smaller with
increasing sample size, but in both cases on average the samples were
closer to the true parameter value of 0.20.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize CFR estimates by sample size</span></span>
<span></span>
<span><span class="va">cfr</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># Group data by sample size  </span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>  </span>
<span>    media <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span>,  <span class="co"># mean CFR  </span></span>
<span>    sd <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span>,  <span class="co"># standard deviation of CFR  </span></span>
<span>    mediana <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span>,  <span class="co"># median CFR  </span></span>
<span>    P25 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">cfr</span>, <span class="fl">0.25</span><span class="op">)</span>,  <span class="co"># 25th percentile (lower quartile)  </span></span>
<span>    P75 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">cfr</span>, <span class="fl">0.75</span><span class="op">)</span>  <span class="co"># 75th percentile (upper quartile)  </span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in cfr %&gt;% group_by(size) %&gt;% summarise(media = mean(cfr), sd = sd(cfr), : could not find function "%&gt;%"</code></pre>
</div>
<p>But, if in real life we can only take a random sample, this means
that we will only have a single chance to calculate a statistic which
will be the <strong>point estimator</strong>of the parameter. However,
this single value will not be able to provide information on the
variability embedded in the random selection of the sample. In addition,
as we saw in the previous example, there is a high probability that many
of the possible sample configurations will give estimates that are far
from the true value of the parameter. Therefore, we must try to involve
sampling variability in the estimation process.</p>
<p><strong>Confidence interval estimation</strong></p>
<p>The objective of confidence interval estimation is to provide a range
of values, a lower and upper bound (a; b), which with a high probability
“…” (a; b), is the most likely to be used in the estimation of a
confidence interval.<strong>confidence</strong>”contains the true value
of the parameter to be estimated. Although each random sample that may
be selected would yield different bounds, this procedure ensures that a
<span class="math inline">\((1-α) %\)</span> of the intervals
constructed will contain the true value of the parameter. This also
implies that a <span class="math inline">\(α%\)</span> of the intervals
will not contain the true value. The symbol α is known as the
significance level.</p>
<p>In general, a confidence interval is constructed with the following
ingredients:</p>
<p><span class="math inline">\(\text{Estimador} ±(\text{coeficiente de
confiabilidad})*(\text{error estándar})\)</span></p>
<div id="discussion6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p><strong>Example</strong></p>
<p>In the CFR package of the Epiverse-TRACE initiative, information is
available on an Ebola outbreak that occurred in 1976 in Zaire, now
called the Republic of Congo, documenting the number of cases and deaths
over 73 days. Ultimately, 245 cases of Ebola were reported and 234 of
these were fatal cases. If the interest is to perform a 95% CFR interval
estimate. What should the procedure be?</p>
<p>● <span class="math display">\[**Step
1-Estimator**\]</span>{.underline}: one should start by finding the
estimate in the observed sample:</p>
<p><span class="math inline">\(\hat{p} = \widehat{\text{CFR}} =
\frac{234}{245}= 0.955\)</span></p>
<p>So the estimated CFR was 95.5%.</p>
<p>● <span class="math display">\[**Step 2-Reliability
coefficient**\]</span>{.underline} based on the normal distribution for
95% confidence would correspond to 1.96</p>
<p>● <span class="math display">\[**Step 3-Standard
error:**\]</span>{.underline}</p>
<p><span class="math inline">\(\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}=\sqrt{\frac{0.955
(1-0.955)}{245}}\)</span></p>
<p>● <span class="math display">\[**Step 4-Gather the
ingredients**\]</span>{.underline}</p>
<p>As you have noticed so far this step-by-step can become cumbersome
because of the calculations, but in R we can get everything in a faster
and more efficient way as follows:</p>
<p>$ = $</p>
<p>As you have noticed so far, this step-by-step can become cumbersome
because of the calculations, but in R we can obtain everything in a
faster and more efficient way in the following way:</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the Ebola data from 1976</span></span>
<span><span class="fu">data</span><span class="op">(</span><span class="va">ebola1976</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ADVERTENCIA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in data(ebola1976): data set 'ebola1976' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate key statistics related to the Case Fatality Ratio (CFR)</span></span>
<span><span class="va">cfr_summary</span> <span class="op">&lt;-</span> <span class="va">ebola1976</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>  </span>
<span>    n <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span>,  <span class="co"># Total number of cases  </span></span>
<span>    deaths <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span>,  <span class="co"># Total number of deaths  </span></span>
<span>    cfr_est <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">n</span>,  <span class="co"># Estimate of the Case Fatality Ratio (CFR)  </span></span>
<span>    error <span class="op">=</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="va">cfr_est</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">cfr_est</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span>,  <span class="co"># Standard error calculation  </span></span>
<span>    lim_inf <span class="op">=</span> <span class="va">cfr_est</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">error</span>,  <span class="co"># Lower bound of the 95% confidence interval  </span></span>
<span>    lim_sup <span class="op">=</span> <span class="va">cfr_est</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">error</span>  <span class="co"># Upper bound of the 95% confidence interval  </span></span>
<span>  <span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ebola1976 %&gt;% summarise(n = sum(cases), deaths = sum(deaths), : could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print the result</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cfr_summary</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'cfr_summary' not found</code></pre>
</div>
</div>
</div>
</div>
<p>Finally, we can conclude that with 95% confidence, the CFR of Ebola
in the 1976 epidemic in the Democratic Republic of Congo is contained in
the interval between 92.9% and 98.1%.</p>
<p>The CFR package also has a built-in function to automatically
estimate with its respective 95% interval the CFR during an epidemic by
means of the function:</p>
<div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute a static Case Fatality Ratio (CFR) using the cfr package</span></span>
<span><span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ebola1976</span><span class="op">)</span>  </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'ebola1976' not found</code></pre>
</div>
<p>As you can see there are slight differences between the CI
constructed step by step and the one reported by the function.
<code>cfr_static</code>. This is because the CFR package performs the
construction of the CI by the method based on maximum likelihood and
different statistical distributions according to the total number of
cases, but the interpretation does not change.</p>
<center>
<p><a href="https://epiverse-trace.github.io/epiverse-trace/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<p><strong>At the end of the session, check if you achieved the
objectives:</strong></p>
<ul><li><p>Understand the role of statistics in the study of infectious
diseases.</p></li>
<li><p>Understand and use statistical measures to summarize and analyze
information.</p></li>
<li><p>Become familiar with the concept of a random variable and
recognize common probability distributions.</p></li>
<li><p>Learn how to approach a statistical problem as an inference
problem from a sample.</p></li>
<li><p>Understand the concept of confidence intervals for estimating
epidemiological parameters.</p></li>
</ul></div>
</div>
</div>
<div class="section level3">
<h3 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a></h3>
<ul><li>Erika Cantor: Initial version</li>
<li>Zulma M. Cucunuba: Editing</li>
<li>Laura Gómez-Bermeo: Editing</li>
<li>Andree Valle-Campo: Minor edits</li>
<li>José M. Velasco-Spain: Minor Editions</li>
<li>Hugo Gruson: Translation to english</li>
</ul><!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Capítulo previo y siguiente"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="zika.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previo</a>
        <a class="chapter-link float-end" href="Banco_errores.html">Siguiente<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="zika.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previo: Construyendo un
        </a>
        <a class="chapter-link float-end" href="Banco_errores.html" rel="next">
          Siguiente: Banco de preguntas y...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>Esta lección está sujeta al <a href="CODE_OF_CONDUCT.html">Código de Conducta</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/epitkit/edit/main/episodes/estadistica.Rmd" class="external-link">Editar en GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/epitkit/blob/main/CONTRIBUTING.md" class="external-link">Contribuir</a>
        | <a href="https://github.com/epiverse-trace/epitkit/" class="external-link">Fuente</a></p>
				<p><a href="https://github.com/epiverse-trace/epitkit/blob/main/CITATION.cff" class="external-link">Cita</a> | <a href="mailto:gomezblaura@javeriana.edu.co">Contacto</a> | <a href="https://carpentries.org/about/" class="external-link">Acerca de</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Plantilla compartida bajo <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> por <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Construido con <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a> y <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Volver al inicio"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Volver</span> al inicio
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://epiverse-trace.github.io/epitkit/estadistica.html",
  "inLanguage": "es",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Statistics and Probability Unit",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/epitkit/estadistica.html",
  "identifier": "https://epiverse-trace.github.io/epitkit/estadistica.html",
  "dateCreated": "2024-09-09",
  "dateModified": "2025-06-06",
  "datePublished": "2025-06-06"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

