<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course: Building a simple deterministic model</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epitkit/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/epitkit/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/epitkit/favicon-16x16.png"><link rel="manifest" href="favicons/epitkit/site.webmanifest"><link rel="mask-icon" href="favicons/epitkit/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epitkit"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epitkit-logo" alt="epitkit" src="assets/images/epitkit-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/Deterministic_model.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epitkit" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epitkit" src="assets/images/epitkit-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Epi Training Kit materials for Introduction to Infectious Disease Modelling for Public Health Course
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 17%" class="percentage">
    17%
  </div>
  <div class="progress epitkit">
    <div class="progress-bar epitkit" role="progressbar" style="width: 17%" aria-valuenow="17" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/Deterministic_model.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="Statistics.html">1. Statistics and Probability Unit</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2. Building a simple deterministic model
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#topic-6-zika-model-in-r"><strong>Topic 6: Zika model in R</strong></a></li>
<li><a href="#practical-start-in-r">6.1 Practical start in R</a></li>
<li><a href="#model-equations">6.2 Model equations</a></li>
<li><a href="#formula-for-calculating-r_0-basic-reproductive-number">6.3 Formula for calculating <span class="math inline">\(R_0\)</span>
(Basic reproductive number)</a></li>
<li><a href="#solving-the-system">6.4 Solving the System</a></li>
<li><a href="#now-lets-run-the-model">6.5 <strong>Now let’s run the model!</strong></a></li>
<li><a href="#viewing-the-results">6.6 <strong>Viewing the results</strong></a></li>
<li><a href="#visualise-and-analyse-the-first-epidemic">6.7 <strong>Visualise and analyse the first epidemic</strong></a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Error_bank.html">3. Bank of frequently asked questions and errors</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="Statistics.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Error_bank.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="Statistics.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Statistics and
        </a>
        <a class="chapter-link float-end" href="Error_bank.html" rel="next">
          Next: Bank of frequently...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Building a simple deterministic model</h1>
        <p>Last updated on 2025-06-19 |

        <a href="https://github.com/joskerus/EpiTKit-EN/edit/main/episodes/Deterministic_model.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How to build a simplified model of Zika?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>At the end of this workshop you will be able to:</p>
<ul><li><p>Recognize how a simple deterministic model is built using
ordinary differential equations.</p></li>
<li><p>Identify relevant parameters for modeling vector-borne disease
(VBD) epidemics.</p></li>
<li><p>Learn how to create a diagram for a compartmental model</p></li>
<li><p>Translate mathematical equations for a deterministic model into R
code.</p></li>
<li><p>Use model simulations to explore transmission scenarios and the
potential impact of interventions.</p></li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<p>This unit has the following prerequisites:</p>
<ul><li>Introduction to epidemic theory</li>
</ul></div>
</div>
</div>
<div id="table-of-contents" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="table-of-contents" class="callout-inner">
<h3 class="callout-title"><strong>Table of Contents</strong></h3>
<div class="callout-content">
<table style="width:97%;" class="table"><colgroup><col width="97%"></colgroup><tbody><tr class="odd"><td>
<p>Topic 1: Vector-borne diseases - Biology of the vector-borne
disease - Vector biology, Zika virus, diagnostics, and intervention</p>
<p>Topic 2: Review - What is a simple deterministic model?</p>
<p>Topic 3: Simple SIR Model for Zika</p>
<p>Topic 4: Developing diagrams and equations of the Zika model</p>
<p>Topic 5: Elaborating the parameter table of the simple Zika model</p>
<p>Topic 6: The Zika model in R</p>
<p>Topic 7: Parameterization of control interventions for Zika</p>
</td>
</tr></tbody></table></div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p>In this unit we will address the construction of a simple
deterministic model, specifically for the Zika virus, a disease that
triggered a major epidemic in Latin America and the Caribbean, and which
was declared a public health emergency of international concern. Using
previous knowledge of epidemic theory, we will build a deterministic
SIR-type model that incorporates demographic aspects.</p>
<p>To build this model, we will learn about the dynamics of interaction
between humans and vectors, as well as the fundamental parameters that
govern these biological processes. By constructing a diagram, we will
examine these relationships and formulate equations that describe the
behaviour of the system. These equations will be the basis for
simulating the model in the R programming language. In turn, we will
propose and model intervention strategies.</p>
<p>Through the analysis of the model, we will evaluate the potential
impact of this epidemic on society, contextualising some of these
interventions in Latin America. In addition, we will reinforce and apply
key themes such as: SIR model, Herd immunity, Parameters and control
interventions (spraying, bed nets and vaccination) for a Vector Borne
Disease (VBD).</p>
</section><section><h2 class="section-heading" id="topic-6-zika-model-in-r"><strong>Topic 6: Zika model in R</strong><a class="anchor" aria-label="anchor" href="#topic-6-zika-model-in-r"></a></h2>
<hr class="half-width"><p>In this section we will put to use the knowledge acquired about Zika,
the mechanisms involved in transmission and the model equations. The aim
is to build it in R.</p>
<p>The only package required for the modelling is deSolve, which allows
us to solve the differential equations. Additionally for data handling
and plotting the results we recommend using tidyverse and cowplot.</p>
</section><section><h2 class="section-heading" id="practical-start-in-r">6.1 Practical start in R<a class="anchor" aria-label="anchor" href="#practical-start-in-r"></a></h2>
<hr class="half-width"><p>To start our practice in <strong>R</strong> please open a
<strong>project of R</strong>project and create a new document. In this
document we must load the functions we have just explained. If you have
difficulties with this process, please review the <strong>unit
Introduction to R</strong>.</p>
<p>install.packages(deSolve) # deSolve package for solving differential
equations</p>
<p>Once you have installed the deSolve package please load the packages
with the following lines of code, copy them into your R script and run
them.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the deSolve package for solving differential equations</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">deSolve</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Load the tidyverse package for data manipulation and visualization</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Load the cowplot package for enhanced plot layout and customization</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cowplot</span><span class="op">)</span></span></code></pre>
</div>
<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<p>Recall that to create a model we need compartments, initial
conditions, parameters and equations.</p>
<p>For this model in R we will start by defining the parameters,
i.e. all those values that have been collected through research and are
part of the behaviour of the disease. In the previous section we talked
about them and completed them in a table. Now it is time to enter them
into R.</p>
<p><strong>Instruction</strong> Please take the table you worked on
earlier and enter the value of each of these parameters.</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">NOTE:</h3>
<div class="callout-content">
<p>It is important to remember that in R, you can use previously created
objects to perform calculations. For example, the parameter muv is the
inverse of the parameter Lv, i.e. muv = 1/Lv. Therefore, in R you can
assign this value directly with muv &lt;- 1/Lv. It is not necessary to
perform the division and assign the result manually.</p>
</div>
</div>
</div>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Instruction: Please take the table you worked on earlier and enter
the value of each of these parameters.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameter List </span></span>
<span></span>
<span><span class="va">Lv</span> <span class="op">&lt;-</span><span class="co"># Life expectancy of mosquitoes (in days)</span></span>
<span><span class="va">Lh</span> <span class="op">&lt;-</span> <span class="co"># Life expectancy of humans (in days)</span></span>
<span><span class="va">IPh</span> <span class="op">&lt;-</span> <span class="co"># Infectious period in humans (in days)</span></span>
<span><span class="va">IPv</span> <span class="op">&lt;-</span> <span class="co"># Infectious period in mosquitoes (in days)</span></span>
<span><span class="va">EIP</span> <span class="op">&lt;-</span> <span class="co"># Extrinsic incubation period in adult mosquitoes (in days)</span></span>
<span><span class="va">muv</span> <span class="op">&lt;-</span> <span class="co"># Per capita mortality rate of mosquito population (1/Lv)</span></span>
<span><span class="va">muh</span> <span class="op">&lt;-</span> <span class="co"># Per capita mortality rate of the human population (1/Lh)</span></span>
<span><span class="va">alphav</span> <span class="op">&lt;-</span> <span class="co"># Per capita birth rate of the mosquito population. For now, we will assume that it is the same as the mortality rate.</span></span>
<span><span class="va">alphah</span> <span class="op">&lt;-</span> <span class="co"># Per capita birth rate of the human population.  For now, we will assume that it is the same as the mortality rate</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span><span class="co"># Recovery rate in humans (1/IPh)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span><span class="co"># Extrinsic incubation rate (1/EIP)</span></span>
<span><span class="va">Nh</span> <span class="op">&lt;-</span> <span class="co"># Number of humans. For this exercise, we suggest 100,000 humans. You can change this if you want according to the city you chose to model.</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="co"># Density of female mosquitoes per human</span></span>
<span><span class="va">Nv</span> <span class="op">&lt;-</span> <span class="co"># Number of mosquitoes (m * Nh)</span></span>
<span><span class="va">R0</span> <span class="op">&lt;-</span><span class="co"># Basic Reproduction Number</span></span>
<span><span class="va">pH</span> <span class="op">&lt;-</span> <span class="co"># Probability of transmission from an infectious mosquito to a susceptible human after a bite.</span></span>
<span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="co"># Probability of transmission from an infectious human to a susceptible mosquito after a bite.</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="op">(</span><span class="va">R0</span> <span class="op">*</span> <span class="va">muv</span><span class="op">*</span><span class="op">(</span><span class="va">muv</span><span class="op">+</span><span class="va">delta</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">muh</span><span class="op">+</span><span class="va">gamma</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span>                   <span class="op">(</span><span class="va">m</span> <span class="op">*</span> <span class="va">pH</span> <span class="op">*</span> <span class="va">pv</span> <span class="op">*</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span> <span class="co"># Biting rate</span></span>
<span><span class="va">betah</span> <span class="op">&lt;-</span> <span class="co"># Coefficient of transmission from an infectious mosquito to a susceptible human after a bite (pH*B)</span></span>
<span><span class="va">betav</span> <span class="op">&lt;-</span> <span class="co"># Coefficient of transmission from an infectious human to a susceptible mosquito after a bite (pv*b)</span></span>
<span><span class="va">TIME</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="co"># Number of years to be simulated. For this exercise, we will start with the first year of the epidemic.</span></span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="model-equations">6.2 Model equations<a class="anchor" aria-label="anchor" href="#model-equations"></a></h2>
<hr class="half-width"><p>Now that we have entered the parameters into the script, it is time
to use the equations that were written earlier, which allow us to know
the number of individuals in each of the six compartments as a function
of time. Three compartments for the humans and three compartments for
the mosquitoes, which are identified by a <strong>h</strong> (for
humans) and a <strong>v</strong>(for mosquitoes). For humans we have the
compartments; susceptible, infected, and recovered (hence the word
<strong>SIR</strong>) and for mosquitoes the compartments are:
susceptible, exposed and infectious (<strong>SEI</strong>).</p>
<div id="compartments" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="compartments" class="callout-inner">
<h3 class="callout-title">Compartments</h3>
<div class="callout-content">
<ul><li><p><span class="math inline">\(S_h\)</span> Human
susceptible</p></li>
<li><p><span class="math inline">\(I_h\)</span> Infectious
humans</p></li>
<li><p><span class="math inline">\(R_h\)</span> Infectious humans :
Humans recovered from infection (immunised against new
infection)</p></li>
<li><p><span class="math inline">\(S_v\)</span> Susceptible
vectors</p></li>
<li><p><span class="math inline">\(E_v\)</span> Vectors at risk :
Exposed vectors</p></li>
<li><p><span class="math inline">\(I_v\)</span> Infectious
vectors</p></li>
</ul></div>
</div>
</div>
<p>For this model we will use the following differential equations:</p>
<div class="section level3">
<h3 id="human">6.2.1 Human<a class="anchor" aria-label="anchor" href="#human"></a></h3>
<p><span class="math display">\[\ \frac{dSh}{dt}  = \alpha_h N_h -
\beta_h \frac {I_v}{N_h}S_h - \mu_h  S_h \]</span></p>
<p><span class="math display">\[\ \frac{dIh}{dt}  = \beta_h \frac
{I_v}{N_h}S_h - (\gamma + \mu_h) I_h \]</span><br></p>
<p><span class="math display">\[\ \frac{dRh}{dt}  = \gamma I_h  - \mu_h
R_h\]</span></p>
</div>
<div class="section level3">
<h3 id="vectors">6.2.2 Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a></h3>
<p><span class="math display">\[\ \frac{dSv}{dt}  = \alpha_v N_v  -
\beta_v \frac{ I_h} {N_h}S_v  - \mu_v Sv\]</span></p>
<p><span class="math display">\[\ \frac{dE_v}{dt}  = \beta_v \frac{I_h}
{N_h}S_v- (\delta + \mu_v) Ev\]</span><br></p>
<p><span class="math display">\[\ \frac{dI_v}{dt}  = \delta Ev - \mu_v
I_v\]</span></p>
</div>
</section><section><h2 class="section-heading" id="formula-for-calculating-r_0-basic-reproductive-number">6.3 Formula for calculating <span class="math inline">\(R_0\)</span>
(Basic reproductive number)<a class="anchor" aria-label="anchor" href="#formula-for-calculating-r_0-basic-reproductive-number"></a></h2>
<hr class="half-width"><p>Formula needed to estimate <span class="math inline">\(R_0\)</span>:</p>
<p><span class="math display">\[ R_0 = \frac{mb^2 p_h p_v \delta}{\mu_v
(\mu_v+\delta)(\mu_h+\gamma)} \]</span></p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Instruction</strong>: Translate the equations into R</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Humans</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>         dSh   <span class="ot">&lt;-</span>  alphah <span class="sc">*</span> Nh <span class="sc">-</span> betah <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> muh <span class="sc">*</span> Sh</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>         dIh   <span class="ot">&lt;-</span>______ <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> (____ <span class="sc">+</span> _____) <span class="sc">*</span> Ih</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>         dRh   <span class="ot">&lt;-</span>  ______ <span class="sc">*</span> Ih  <span class="sc">-</span> ______ <span class="sc">*</span> Rh</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a> <span class="co"># Mosquitoes</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>         dSv  <span class="ot">&lt;-</span>  alphav <span class="sc">*</span> Nv <span class="sc">-</span> _____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> _____ <span class="sc">*</span> Sv</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>         dEv  <span class="ot">&lt;-</span>  _____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> (____ <span class="sc">+</span> _____)<span class="sc">*</span> Ev</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>         dIv  <span class="ot">&lt;-</span>  _____ <span class="sc">*</span> Ev <span class="sc">-</span> _____ <span class="sc">*</span> Iv</span></code></pre>
</div>
</div>
</div>
</div>
<p>Once we know how to translate the equations into code, we will
proceed to run the model. For this, the ode function of the deSolve
package will be used.</p>
<p>You start by creating the function (which will then be used in the
argument <strong>fun</strong>). This requires translating the equations
of the Zika model to <strong>R</strong>. Below you will find the
function already built <code>modelo_zika</code> for you to replace the
equations you have already filled in above.</p>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p><strong>Instruction</strong>: Replace the incomplete equations in the
following code with the complete equations of the Zika model you worked
on in the previous instruction.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Simple Deterministic Model (FUN)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>zika_model <span class="ot">&lt;-</span> <span class="cf">function</span>(time, state_variable, parameters) {</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state_variable, parameters)), <span class="co"># local environment to evaluate derivatives</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>       {</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>         <span class="co"># Humans</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>         dSh <span class="ot">&lt;-</span> ____ <span class="sc">*</span> Nh <span class="sc">-</span> ____ <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> ____ <span class="sc">*</span> Sh   </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>         dIh <span class="ot">&lt;-</span> ____ <span class="sc">*</span> (Iv<span class="sc">/</span>Nh) <span class="sc">*</span> Sh <span class="sc">-</span> (____ <span class="sc">+</span> ____) <span class="sc">*</span> Ih</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>         dRh <span class="ot">&lt;-</span> ____ <span class="sc">*</span> Ih <span class="sc">-</span> ____ <span class="sc">*</span> Rh</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>         </span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>         <span class="co"># Mosquitoes</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>         dSv <span class="ot">&lt;-</span> alphav <span class="sc">*</span> Nv <span class="sc">-</span> ____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> ____ <span class="sc">*</span> Sv </span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>         dEv <span class="ot">&lt;-</span> ____ <span class="sc">*</span> (Ih<span class="sc">/</span>Nh) <span class="sc">*</span> Sv <span class="sc">-</span> (____ <span class="sc">+</span> ____)<span class="sc">*</span> Ev</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>         dIv <span class="ot">&lt;-</span> ____ <span class="sc">*</span> Ev <span class="sc">-</span> ____ <span class="sc">*</span> Iv</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>         </span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>         <span class="fu">list</span>(<span class="fu">c</span>(dSh, dIh, dRh, dSv, dEv, dIv))</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>       }</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  )</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>}</span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</section><section><h2 class="section-heading" id="solving-the-system">6.4 Solving the System<a class="anchor" aria-label="anchor" href="#solving-the-system"></a></h2>
<hr class="half-width"><p>To solve the system it is necessary to create the three missing
arguments (<strong>times</strong>, <strong>parms</strong> y
<strong>y</strong>) to use the function <code>ode</code>.</p>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p><strong>Instruction:</strong> For <code>times</code> y
<code>parms</code> copy the code below and execute it.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sequence of times (times)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">365</span> <span class="op">*</span> <span class="va">TIME</span> , by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Parameters (parms)</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  muv      <span class="op">=</span> <span class="va">muv</span>,</span>
<span>  muh      <span class="op">=</span> <span class="va">muh</span>,</span>
<span>  alphav   <span class="op">=</span> <span class="va">alphav</span>,</span>
<span>  alphah   <span class="op">=</span> <span class="va">alphah</span>,</span>
<span>  gamma    <span class="op">=</span> <span class="va">gamma</span>,</span>
<span>  delta    <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  betav    <span class="op">=</span> <span class="va">betav</span>,</span>
<span>  betah    <span class="op">=</span> <span class="va">betah</span>,</span>
<span>  Nh       <span class="op">=</span> <span class="va">Nh</span>,</span>
<span>  Nv       <span class="op">=</span> <span class="va">Nv</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>In the code that ran, time was created (<strong>times)</strong> and
parameters (<strong>params)</strong>. We still need to create the
argument <strong>y</strong> argument, which we will develop in the next
section.</p>
<div class="section level3">
<h3 id="initial-conditions-of-the-system-y">6.4.1. <strong>Initial conditions of the system (y)</strong>
<a class="anchor" aria-label="anchor" href="#initial-conditions-of-the-system-y"></a></h3>
<p>In order to define the initial conditions, recall that the scenario
to be modelled in this exercise is for a date <strong>before the report
of the first case</strong>. Therefore these values should reflect that
context.</p>
<div id="discussion5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p><strong>Reflection:</strong> What would be the initial conditions of
each of the compartments?</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p><strong>Instruction:</strong> Fill in the blanks as learned in the
tutorial.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Initial conditions of the system (y)</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Sh =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>            <span class="at">Ih =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>            <span class="at">Rh =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>            <span class="at">Sv =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>            <span class="at">Ev =</span> _______ ,        <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>            <span class="at">Iv =</span> _______ )        <span class="co"># COMPLETE AND COMMENT</span></span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</div>
<div class="section level3">
<h3 id="function-ode">6.4.2 Function ode<a class="anchor" aria-label="anchor" href="#function-ode"></a></h3>
<p>Once all the necessary arguments have been created, it is time to
enter them into ode. Let’s remember the four arguments of ode and a
which correspond to:</p>
<ul><li><p><strong>y</strong>:<strong>home</strong>. Vector created with the
initial conditions of the six compartments.</p></li>
<li><p><strong>times</strong>:<strong>time</strong>. Vector with time
sequence</p></li>
<li><p><strong>fun:zika_model</strong>. Function containing the
necessary equations to simulate the model.</p></li>
<li><p><strong>parms:parameters.</strong> Vector in which the parameters
needed to simulate the model were collected.</p></li>
</ul><div id="challenge-6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6</h3>
<div class="callout-content">
<p><strong>Instruction</strong> Fill in the blanks according to what you
have worked on so far.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Solve the equations</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> _______ , <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>              <span class="at">times =</span> _______ ,   <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>              <span class="at">fun =</span> _______ ,   <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>              <span class="at">parms =</span> _______  <span class="co"># COMPLETE AND COMMENT</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="co"># Convert to data frame</span></span></code></pre>
</div>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</div>
<div class="section level3">
<h3 id="introducing-the-first-case">6.4.3 <strong>Introducing the first case</strong>
<a class="anchor" aria-label="anchor" href="#introducing-the-first-case"></a></h3>
<p>Now that we have all the compartments defined, it is time to enter an
infectious individual into the model to start the epidemic.</p>
<div id="discussion8" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p><strong>Reflection:</strong> Which do you think is more likely, an
infectious human or an infectious mosquito entering a population (in
another country)?</p>
</div>
</div>
</div>
<p>For our hypothetical case, let’s assume that a person became infected
in Brazil while on tourism and subsequently returned to the city
______________ (the city you defined at the beginning of the exercise)
and was the first infectious subject in this population. In this
context, the compartment of infectious humans will then have one
individual, <strong>Ih</strong> = 1 and the susceptible human
compartment will have one less individual, <strong>Sh</strong> =
<strong>Nh</strong> - 1.</p>
<div id="discussion9" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p><strong>Track:</strong> Change in R the initial (start) conditions so
that Ih = 1 and Sh = Nh - 1.</p>
</div>
</div>
</div>

<center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
</div>
</section><section><h2 class="section-heading" id="now-lets-run-the-model">6.5 <strong>Now let’s run the model!</strong>
<a class="anchor" aria-label="anchor" href="#now-lets-run-the-model"></a></h2>
<hr class="half-width"><p><strong>At this point, you have filled in all the missing information
in the script in order to be able to run the model.</strong></p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p><strong>Instruction:</strong> Run each set of the script lines seen
above, i.e. run the sections: Parameter list, the section Simple
deterministic model (where you built the model), the sections Time
sequence (time (times)), The parameters (parameters (parms)), the
section Initial conditions of the system (start (y)) and the final
section Solve the equations.</p>
<p><strong>Instruction:</strong> Check that no errors are displayed. In
case of error, please check the spelling of the code and that there are
no other characters left in the code that do not correspond, for example
“_____”, the hyphens in the spaces to be filled in.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="viewing-the-results">6.6 <strong>Viewing the results</strong>
<a class="anchor" aria-label="anchor" href="#viewing-the-results"></a></h2>
<hr class="half-width"><p><strong>In our course we will use ggplot for data visualisation. It
is important that you review Unit 4. Data visualisation in
ggplot</strong></p>
<p>It should be recalled that the time unit of the Zika model is already
defined from the parameters as <strong>days</strong>.</p>
<p>However, if you would like to visualise the results in weeks, months
or years, you can do so from the model results
(<code>salida$time</code>). To do so, you can use the following
code.</p>
<div id="challenge-7" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-7" class="callout-inner">
<h3 class="callout-title">Challenge 7</h3>
<div class="callout-content">
<p>For a more meaningful visualisation of the results, convert the units
of time from <em>days</em> a <em>years</em> and a <em>weeks</em>.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert the times from days to years and weeks, respectively</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">/</span><span class="fl">365</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">weeks</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">/</span><span class="fl">7</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="visualise-and-analyse-the-first-epidemic">6.7 <strong>Visualise and analyse the first epidemic</strong>
<a class="anchor" aria-label="anchor" href="#visualise-and-analyse-the-first-epidemic"></a></h2>
<hr class="half-width"><p>Let’s start with a visualisation of the first epidemic. Since it is a
period of one year, let’s visualise the graphs in weeks.</p>
<p>Instruction: Run the code below and analyse the resulting graphs.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Review the first epidemic</span></span>
<span><span class="va">p1e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Infectious Human Population"</span>, x <span class="op">=</span> <span class="st">"Weeks"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p2e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recovered Human Population'</span>, x<span class="op">=</span> <span class="st">"Weeks"</span>, y<span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1e</span>, <span class="va">p2e</span><span class="op">)</span> <span class="co"># comparison graph of the infectious human population and recovered human population graph</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-p1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="discussion11" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p><strong>Reflection:</strong> What can you see in the graph? Look
closely at the Y-axis. What proportion of humans are infectious at the
same time?</p>
</div>
</div>
</div>
<p>To make this clearer we can create graphs of the proportions:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Review the first epidemic with proportions</span></span>
<span><span class="va">p1e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Infectious Human Population"</span>, x <span class="op">=</span> <span class="st">"Weeks"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># graph of infectious human population</span></span>
<span></span>
<span><span class="va">p2e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">weeks</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recovered Human Population'</span>, x<span class="op">=</span> <span class="st">"Weeks"</span>, y<span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># graph of recovered human population}</span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1e</span>, <span class="va">p2e</span><span class="op">)</span> <span class="co"># comparison graph of the infectious human population and recovered human population graph</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-p3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>General behaviour (Human population)</strong></p>
<p>Having observed the first epidemic, it is now time to project the
epidemic to a longer time frame.</p>
<p><strong>Instruction:</strong> Go back to the parameters and change
the TIME parameter to 100 years. Run the following code block and
observe how many outbreaks occur in the human population and the size of
each outbreak.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Examine the behavior of the model for 100 years</span></span>
<span><span class="va">p1h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Rh</span> <span class="op">+</span> <span class="va">Ih</span> <span class="op">+</span> <span class="va">Sh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'grey68'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Total Human Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'royalblue'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Susceptible Human Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Infectious Human Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p4h</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Recovered Human Population'</span> , x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1h</span>, <span class="va">p2h</span>, <span class="va">p3h</span>, <span class="va">p4h</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-p4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>General Behaviour (Mosquito Population)</strong></p>
<p><strong>Instruction:</strong> Run the following code block and
observe how many outbreaks occur in the mosquito population and the size
of each outbreak. Compare the graphs with the human population
graphs.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine the behavior of the model</span></span>
<span><span class="va">p1v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">Sv</span> <span class="op">+</span> <span class="va">Ev</span> <span class="op">+</span> <span class="va">Iv</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'grey68'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Total mosquito population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'royalblue'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Susceptible Mosquito Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ev</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'orchid'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Exposed Mosquito Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p4v</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Iv</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Infectious Mosquito Population'</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1v</span>, <span class="va">p2v</span>, <span class="va">p3v</span>, <span class="va">p4v</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><strong>Proportion</strong></p>
<p><strong>Instruction:</strong> Run the following code block and
compare it to the graphs generated for the human population.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Proportions</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Sh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'royalblue'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'Susceptible human population'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Susceptible Human Population"</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Ih</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'firebrick'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Infectious Human Population"</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">Rh</span><span class="op">/</span><span class="op">(</span><span class="va">Sh</span><span class="op">+</span><span class="va">Ih</span><span class="op">+</span><span class="va">Rh</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">years</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">'olivedrab'</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Recovered Human Population"</span>, x <span class="op">=</span> <span class="st">"Years"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span></code></pre>
</div>
<figure><img src="fig/Deterministic_model-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><center>
<p><a href="https://joskerus.github.io/EpiTKit-EN/Error_bank.html" class="external-link"><img src="fig/dudas.png" width="100" class="figure"></a></p>
</center>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<p>Check if you have acquired these competences by the end of this
lesson:</p>
<ul><li><p>Recognize how a simple deterministic model is built using
ordinary differential equations.</p></li>
<li><p>Identify relevant parameters for modeling vector-borne disease
(VBD) epidemics.</p></li>
<li><p>Learn how to create a diagram for a compartmental model</p></li>
<li><p>Translate mathematical equations for a deterministic model into R
code.</p></li>
<li><p>Use model simulations to explore transmission scenarios and the
potential impact of interventions.</p></li>
</ul></div>
</div>
</div>
<div class="section level3">
<h3 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a></h3>
<ul><li>Zulma Cucunuba &amp; Pierre Nouvellet: Initial version</li>
<li>Kelly Charinga &amp; Zhian N. Kamvar: Editing</li>
<li>José M. Velasco-Spain: Translation from English to Spanish and
Editing</li>
<li>Andree Valle-Campos: Minor Editions</li>
</ul></div>
<div class="section level3">
<h3 id="legal-affairs">Legal affairs<a class="anchor" aria-label="anchor" href="#legal-affairs"></a></h3>
<p><strong>Copyright</strong>: Zulma Cucunuba &amp; Pierre Nouvellet,
2017</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h3>
<p>de Carvalho, S. S., Rodovalho, C. M., Gaviraghi, A., Mota, M. B. S.,
Jablonka, W., Rocha-Santos, C., Nunes, R. D., Sá-Guimarães, T. da E.,
Oliveira, D. S., Melo, A. C. A., Moreira, M. F., Fampa, P., Oliveira, M.
F., da Silva-Neto, M. A. C., Mesquita, R. D., &amp; Atella, G. C.
(2021). Aedes aegypti post-emergence transcriptome: Unveiling the
molecular basis for the hematophagic and gonotrophic capacitation. PLoS
Neglected Tropical Diseases, 15(1), 1–32. <a href="https://doi.org/10.1371/journal.pntd.0008915" class="external-link uri">https://doi.org/10.1371/journal.pntd.0008915</a></p>
<p>Chang, C., Ortiz, K., Ansari, A., &amp; Gershwin, M. E. (2016). The
Zika outbreak of the 21st century. Journal of Autoimmunity, 68, 1–13. <a href="https://doi.org/10.1016/j.jaut.2016.02.006" class="external-link uri">https://doi.org/10.1016/j.jaut.2016.02.006</a></p>
<p>Cori, A., Ferguson, N. M., Fraser, C., &amp; Cauchemez, S. (2013). A
new framework and software to estimate time-varying reproduction
numbers. during epidemics. American Journal of Epidemiology, 178(9),
1505–1512. <a href="https://doi.org/10.1093/aje/kwt133" class="external-link uri">https://doi.org/10.1093/aje/kwt133</a></p>
<p>Duffy, M. R., Chen, T.-H., Hancock, W. T., Powers, A. M., Kool, J.
L., Lanciotti, R. S., Pretrick, M., Marfel, M., Holzbauer, S., Dubray,
C., Guillaumot, L., Griggs, A., Bel, M., Lambert, A. J., Laven, J.,
Kosoy, O., Panella, A., Biggerstaff, B. J., Fischer, M., &amp; Hayes, E.
B. (2009). Zika Virus Outbreak on Yap Island, Federated States of
Micronesia. New New England Journal of Medicine, 360(24), 2536–2543. <a href="https://doi.org/10.1056/nejmoa0805715" class="external-link uri">https://doi.org/10.1056/nejmoa0805715</a></p>
<p>Ferguson, N. M., Cucunubá, Z. M., Dorigatti, I., Nedjati-Gilani, G.
L., Donnelly, C. A., Basáñez, M. G., Nouvellet, P., &amp; Lessler, J.
(2016). Countering the Zika epidemic in Latin America. Science,
353(6297). <a href="https://doi.org/10.1126/science.aag0219" class="external-link uri">https://doi.org/10.1126/science.aag0219</a></p>
<p>Heesterbeek, J. A. P. (2002). A brief history of R0 and a recipe for
its calculation. Acta Biotheoretica, 50(3). <a href="https://doi.org/10.1023/A:1016599411804" class="external-link uri">https://doi.org/10.1023/A:1016599411804</a></p>
<p>Lee, E. K., Liu, Y., &amp; Pietz, F. H. (2016). A Compartmental Model
for Zika Virus with Dynamic Human and Vector Populations. AMIA … Annual
Symposium Proceedings. AMIA Symposium, 2016, 743–752.</p>
<p>Pettersson, J. H. O., Eldholm, V., Seligman, S. J., Lundkvist, Å.,
Falconar, A. K., Gaunt, M. W., Musso, D., Nougairède, A., Charrel, R.,
Gould, E. A., &amp; de Lamballerie, X. (2016). How did zika virus emerge
in the Pacific Islands and Latin America? MBio, 7(5). <a href="https://doi.org/10.1128/mBio.01239-16" class="external-link uri">https://doi.org/10.1128/mBio.01239-16</a></p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="Statistics.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="Error_bank.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="Statistics.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Statistics and
        </a>
        <a class="chapter-link float-end" href="Error_bank.html" rel="next">
          Next: Bank of frequently...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/joskerus/EpiTKit-EN/edit/main/episodes/Deterministic_model.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/joskerus/EpiTKit-EN/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/joskerus/EpiTKit-EN/" class="external-link">Source</a></p>
				<p><a href="https://github.com/joskerus/EpiTKit-EN/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:gomezblaura@javeriana.edu.co">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://joskerus.github.io/EpiTKit-EN/Deterministic_model.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Building a simple deterministic model",
  "creativeWorkStatus": "active",
  "url": "https://joskerus.github.io/EpiTKit-EN/Deterministic_model.html",
  "identifier": "https://joskerus.github.io/EpiTKit-EN/Deterministic_model.html",
  "dateCreated": "2024-06-04",
  "dateModified": "2025-06-19",
  "datePublished": "2025-06-19"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

